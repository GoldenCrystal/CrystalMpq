<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0075)http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp -->
<HTML xmlns="http://www.w3.org/1999/xhtml"><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <TITLE>
      ArcEmu
    </TITLE>
        <LINK rel="search" href="http://www.arcemu.info/trac/search">
        <LINK rel="help" href="http://www.arcemu.info/trac/wiki/TracGuide">
        <LINK rel="alternate" href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp?format=txt" type="text/plain" title="Plain Text"><LINK rel="alternate" href="http://www.arcemu.info/trac/export/2565/trunk/src/arcemu-world/SpellEffects.cpp" type="text/x-c++src; charset=iso-8859-15" title="Original Format">
        <LINK rel="up" href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world" title="Parent directory">
        <LINK rel="start" href="http://www.arcemu.info/trac/wiki">
        <LINK rel="stylesheet" href="http://www.arcemu.info/trac/chrome/common/css/trac.css" type="text/css"><LINK rel="stylesheet" href="http://www.arcemu.info/trac/chrome/common/css/code.css" type="text/css"><LINK rel="stylesheet" href="http://www.arcemu.info/trac/pygments/trac.css" type="text/css"><LINK rel="stylesheet" href="http://www.arcemu.info/trac/chrome/common/css/browser.css" type="text/css">
        <LINK rel="shortcut icon" href="http://www.arcemu.org/favicon.ico" type="image/x-icon">
        <LINK rel="icon" href="http://www.arcemu.org/favicon.ico" type="image/x-icon">
      <LINK type="application/opensearchdescription+xml" rel="search" href="http://www.arcemu.info/trac/search/opensearch" title="Search ArcEmu">
    <SCRIPT type="text/javascript" src="http://www.arcemu.info/trac/chrome/common/js/jquery.js"></SCRIPT><SCRIPT type="text/javascript" src="http://www.arcemu.info/trac/chrome/common/js/trac.js"></SCRIPT><SCRIPT type="text/javascript" src="http://www.arcemu.info/trac/chrome/common/js/search.js"></SCRIPT>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <SCRIPT src="http://www.wowhead.com/widgets/power.js"></SCRIPT><LINK type="text/css" href="http://static.wowhead.com/widgets/power/power.css?3" rel="stylesheet">
  </HEAD><HEAD>
    <TITLE>/trunk/src/arcemu-world/SpellEffects.cpp</TITLE>
    <SCRIPT type="text/javascript">
      jQuery(document).ready(function($) {
        $("#jumploc input").hide();
        $("#jumploc select").change(function () {
          this.parentNode.parentNode.submit();
        })
      });
    </SCRIPT>
  </HEAD><BODY>
    <DIV id="banner">
      <DIV id="header">
        <A id="logo" href="http://www.arcemu.info/trac/wiki/TracIni#header_logo-section"><IMG src="http://arcemu.org/forums/style_images/profession/header.gif" alt="ArcEmu"></A>
      </DIV>
      <FORM id="search" action="http://www.arcemu.info/trac/search" method="get">
        <DIV>
          <LABEL for="proj-search">Search:</LABEL>
          <INPUT type="text" id="proj-search" name="q" size="18" value="">
          <INPUT type="submit" value="Search">
        </DIV>
      </FORM>
      <DIV id="metanav" class="nav">
    <UL>
      <LI class="first"><A href="http://www.arcemu.info/trac/login">Login</A></LI><LI><A href="http://www.arcemu.info/trac/prefs">Preferences</A></LI><LI><A href="http://www.arcemu.info/trac/wiki/TracGuide">Help/Guide</A></LI><LI><A href="http://www.arcemu.info/trac/about">About Trac</A></LI><LI class="last"><A href="http://www.arcemu.info/trac/register">Register</A></LI>
    </UL>
  </DIV>
    </DIV>
    <DIV id="mainnav" class="nav">
    <UL>
      <LI class="first"><A href="http://www.arcemu.info/trac/wiki">Wiki</A></LI><LI><A href="http://www.arcemu.info/trac/timeline">Timeline</A></LI><LI><A href="http://www.arcemu.info/trac/roadmap">Roadmap</A></LI><LI class="active"><A href="http://www.arcemu.info/trac/browser">Browse Source</A></LI><LI><A href="http://www.arcemu.info/trac/report">View Tickets</A></LI><LI class="last"><A href="http://www.arcemu.info/trac/search">Search</A></LI>
    </UL>
  </DIV>
    <DIV id="main">
      <DIV id="ctxtnav" class="nav">
        <H2>Context Navigation</H2>
          <UL>
            <LI class="first "><A href="http://www.arcemu.info/trac/changeset/2558/trunk/src/arcemu-world/SpellEffects.cpp">Last Change</A></LI><LI><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp?annotate=blame&rev=2558" title="Annotate each line with the last changed revision (this can be time consuming...)">Annotate</A></LI><LI class="last"><A href="http://www.arcemu.info/trac/log/trunk/src/arcemu-world/SpellEffects.cpp">Revision Log</A></LI>
          </UL>
        <HR>
      </DIV>
    <DIV id="content" class="browser">
      <H1>
    <A class="pathentry first" title="Go to root directory" href="http://www.arcemu.info/trac/browser">root</A><SPAN class="pathentry sep">/</SPAN><A class="pathentry" title="View trunk" href="http://www.arcemu.info/trac/browser/trunk">trunk</A><SPAN class="pathentry sep">/</SPAN><A class="pathentry" title="View src" href="http://www.arcemu.info/trac/browser/trunk/src">src</A><SPAN class="pathentry sep">/</SPAN><A class="pathentry" title="View arcemu-world" href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world">arcemu-world</A><SPAN class="pathentry sep">/</SPAN><A class="pathentry" title="View SpellEffects.cpp" href="./SpellEffects.cpp_files/SpellEffects.cpp.htm">SpellEffects.cpp</A>
    <BR style="clear: both">
  </H1>
      <DIV id="jumprev">
        <FORM action="" method="get">
          <DIV>
            <LABEL for="rev">
              View revision:</LABEL>
            <INPUT type="text" id="rev" name="rev" size="6">
          </DIV>
        </FORM>
      </DIV>
      <DIV id="jumploc">
        <FORM action="" method="get">
          <DIV class="buttons">
            <LABEL for="preselected">Visit:</LABEL>
            <SELECT id="preselected" name="preselected">
              <OPTION selected="selected">
              <OPTGROUP label="branches">
                <OPTION value="/trac/browser/trunk">trunk</OPTION><OPTION value="/trac/browser/branches/2.4.3">branches/2.4.3</OPTION><OPTION value="/trac/browser/branches/archives">branches/archives</OPTION><OPTION value="/trac/browser/branches/dev_shared_ptr">branches/dev_shared_ptr</OPTION><OPTION value="/trac/browser/branches/extras">branches/extras</OPTION><OPTION value="/trac/browser/branches/GMH">branches/GMH</OPTION><OPTION value="/trac/browser/branches/web">branches/web</OPTION><OPTION value="/trac/browser/branches/whatever&percnt;20wotlk&percnt;20core">branches/whatever wotlk core</OPTION>
              </OPTGROUP><OPTGROUP label="tags">
                <OPTION value="/trac/browser/tags/3.0.8?rev=2047">tags/3.0.8</OPTION>
              </OPTGROUP>
            </SELECT>
            <INPUT type="submit" value="Go!" title="Jump to the chosen preselected path" style="display: none; ">
          </DIV>
        </FORM>
      </DIV>
      <TABLE id="info" summary="Revision info">
        <TBODY><TR>
          <TH scope="col">
            Revision <A href="http://www.arcemu.info/trac/changeset/2558">2558</A>, <SPAN title="227802 bytes">222.5 kB</SPAN>
            (checked in by KFL, <A class="timeline" href="http://www.arcemu.info/trac/timeline?from=2009-04-19T17%3A19%3A56Z-0500&precision=second" title="2009-04-19T17:19:56Z-0500 in Timeline">4 days</A> ago)
          </TH>
        </TR>
        <TR>
          <TD class="message searchable">
              <P>
Fixed: Applied <A href="http://arcemu.org/forums/index.php?showtopic=15142">http://arcemu.org/forums/index.php?showtopic=15142</A> +small change to Gag Order. <BR>
Updated: Judgement of Light effect. <BR>
Updated: Refresing Judgements is switched off(it's not blizzlike since 3.0.x). <BR>
</P>
          </TD>
        </TR>
        <TR>
          <TD colspan="2">
            <UL class="props">
              <LI>
                  Property <STRONG>svn:eol-style</STRONG> set to
                    <EM><CODE>native</CODE></EM>
              </LI><LI>
                  Property <STRONG>ff</STRONG> set to
                    <BR>*.asax = svn:eol-style=native
<BR>*.ascx = svn:eol-style=native
<BR>*.aspx = svn:eol-style=native
<BR>*.asmx = svn:eol-style=native
<BR>*.ashx = svn:eol-style=native
<BR>*.asp = svn:eol-style=native
<BR>*.browser = svn:eol-style=native
<BR>*.build = svn:eol-style=native
<BR>*.c = svn:eol-style=native
<BR>*.config = svn:eol-style=native
<BR>*.cpp = svn:eol-style=native
<BR>*.cs = svn:eol-style=native
<BR>*.csproj = svn:eol-style=native
<BR>*.css = svn:eol-style=native
<BR>*.cfc = svn:eol-style=native
<BR>*.cfm = svn:eol-style=native
<BR>*.cst = svn:eol-style=native
<BR>*.dll = svn:executable
<BR>*.exe = svn:executable
<BR>*.h = svn:eol-style=native
<BR>*.htc = svn:eol-style=native
<BR>*.html = svn:eol-style=native
<BR>*.htm = svn:eol-style=native
<BR>*.jpg = svn:mime-type=image/jpeg
<BR>*.jpeg = svn:mime-type=image/jpeg
<BR>*.js = svn:eol-style=native
<BR>*.mds = svn:eol-style=native
<BR>*.mdp = svn:eol-style=native
<BR>*.php = svn:eol-style=native
<BR>*.pl = svn:eol-style=native
<BR>*.png = svn:mime-type=image/png
<BR>*.rest = svn:eol-style=native
<BR>*.resx = svn:eol-style=native
<BR>*.sh = svn:eol-style=native;svn:executable
<BR>*.skin = svn:eol-style=native
<BR>*.sln = svn:eol-style=native
<BR>*.sql = svn:eol-style=native
<BR>*.svg = svn:eol-style=native
<BR>*.txt = svn:eol-style=native
<BR>*.theme = svn:eol-style=native
<BR>*.vb = svn:eol-style=native
<BR>*.xml = svn:eol-style=native
<BR>*.xsd = svn:eol-style=native
<BR>*.xsl = svn:eol-style=native
<BR>Makefile = svn:eol-style=native
<BR>README = svn:eol-style=native
<BR>CHANGELOG = svn:eol-style=native
<BR>LICENSE = svn:eol-style=native
<BR>
              </LI>
            </UL>
          </TD>
        </TR>
      </TBODY></TABLE>
      <DIV id="preview" class="searchable">
    <TABLE class="code"><THEAD><TR><TH class="lineno" title="Line numbers">Line</TH><TH class="content">&nbsp;</TH></TR></THEAD><TBODY><TR><TH id="L1"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1">1</A></TH><TD><SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L2"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2">2</A></TH><TD><SPAN class="c">* ArcEmu MMORPG Server</SPAN></TD></TR><TR><TH id="L3"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3">3</A></TH><TD><SPAN class="c">* Copyright (C) 2005-2007 Ascent Team &lt;http://www.ascentemu.com/&gt;</SPAN></TD></TR><TR><TH id="L4"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4">4</A></TH><TD><SPAN class="c">* Copyright (C) 2008-2009 &lt;http://www.ArcEmu.org/&gt;</SPAN></TD></TR><TR><TH id="L5"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5">5</A></TH><TD><SPAN class="c">*</SPAN></TD></TR><TR><TH id="L6"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6">6</A></TH><TD><SPAN class="c">* This program is free software: you can redistribute it and/or modify</SPAN></TD></TR><TR><TH id="L7"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7">7</A></TH><TD><SPAN class="c">* it under the terms of the GNU Affero General Public License as published by</SPAN></TD></TR><TR><TH id="L8"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L8">8</A></TH><TD><SPAN class="c">* the Free Software Foundation, either version 3 of the License, or</SPAN></TD></TR><TR><TH id="L9"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L9">9</A></TH><TD><SPAN class="c">* any later version.</SPAN></TD></TR><TR><TH id="L10"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L10">10</A></TH><TD><SPAN class="c">*</SPAN></TD></TR><TR><TH id="L11"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L11">11</A></TH><TD><SPAN class="c">* This program is distributed in the hope that it will be useful,</SPAN></TD></TR><TR><TH id="L12"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L12">12</A></TH><TD><SPAN class="c">* but WITHOUT ANY WARRANTY; without even the implied warranty of</SPAN></TD></TR><TR><TH id="L13"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L13">13</A></TH><TD><SPAN class="c">* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp; See the</SPAN></TD></TR><TR><TH id="L14"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L14">14</A></TH><TD><SPAN class="c">* GNU Affero General Public License for more details.</SPAN></TD></TR><TR><TH id="L15"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L15">15</A></TH><TD><SPAN class="c">*</SPAN></TD></TR><TR><TH id="L16"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L16">16</A></TH><TD><SPAN class="c">* You should have received a copy of the GNU Affero General Public License</SPAN></TD></TR><TR><TH id="L17"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L17">17</A></TH><TD><SPAN class="c">* along with this program.&nbsp; If not, see &lt;http://www.gnu.org/licenses/&gt;.</SPAN></TD></TR><TR><TH id="L18"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L18">18</A></TH><TD><SPAN class="c">*</SPAN></TD></TR><TR><TH id="L19"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L19">19</A></TH><TD><SPAN class="c">*/</SPAN></TD></TR><TR><TH id="L20"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L20">20</A></TH><TD><SPAN class="cp"></SPAN></TD></TR><TR><TH id="L21"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L21">21</A></TH><TD><SPAN class="cp">#include "StdAfx.h"</SPAN></TD></TR><TR><TH id="L22"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L22">22</A></TH><TD><SPAN class="cp"></SPAN></TD></TR><TR><TH id="L23"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L23">23</A></TH><TD>pSpellEffect SpellEffectsHandler<SPAN class="p">[</SPAN>TOTAL_SPELL_EFFECTS<SPAN class="p">]</SPAN><SPAN class="o">=</SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L24"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L24">24</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_NULL - 0</SPAN></TD></TR><TR><TH id="L25"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L25">25</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectInstantKill<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_INSTAKILL - 1</SPAN></TD></TR><TR><TH id="L26"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L26">26</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSchoolDMG<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SCHOOL_DAMAGE - 2</SPAN></TD></TR><TR><TH id="L27"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L27">27</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDummy<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_DUMMY - 3</SPAN></TD></TR><TR><TH id="L28"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L28">28</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_PORTAL_TELEPORT - 4</SPAN></TD></TR><TR><TH id="L29"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L29">29</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectTeleportUnits<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_TELEPORT_UNITS - 5</SPAN></TD></TR><TR><TH id="L30"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L30">30</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectApplyAura<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_APPLY_AURA - 6</SPAN></TD></TR><TR><TH id="L31"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L31">31</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectEnvironmentalDamage<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_ENVIRONMENTAL_DAMAGE - 7</SPAN></TD></TR><TR><TH id="L32"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L32">32</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectPowerDrain<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_POWER_DRAIN - 8</SPAN></TD></TR><TR><TH id="L33"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L33">33</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectHealthLeech<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_HEALTH_LEECH - 9</SPAN></TD></TR><TR><TH id="L34"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L34">34</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectHeal<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_HEAL - 10</SPAN></TD></TR><TR><TH id="L35"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L35">35</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_BIND - 11</SPAN></TD></TR><TR><TH id="L36"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L36">36</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_PORTAL - 12</SPAN></TD></TR><TR><TH id="L37"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L37">37</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_RITUAL_BASE - 13</SPAN></TD></TR><TR><TH id="L38"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L38">38</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_RITUAL_SPECIALIZE - 14</SPAN></TD></TR><TR><TH id="L39"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L39">39</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_RITUAL_ACTIVATE_PORTAL - 15</SPAN></TD></TR><TR><TH id="L40"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L40">40</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectQuestComplete<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_QUEST_COMPLETE - 16</SPAN></TD></TR><TR><TH id="L41"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L41">41</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectWeapondamageNoschool<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_WEAPON_DAMAGE_NOSCHOOL - 17</SPAN></TD></TR><TR><TH id="L42"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L42">42</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectResurrect<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_RESURRECT - 18</SPAN></TD></TR><TR><TH id="L43"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L43">43</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectAddExtraAttacks<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_ADD_EXTRA_ATTACKS - 19</SPAN></TD></TR><TR><TH id="L44"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L44">44</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDodge<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_DODGE - 20</SPAN></TD></TR><TR><TH id="L45"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L45">45</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_EVADE - 21</SPAN></TD></TR><TR><TH id="L46"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L46">46</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectParry<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_PARRY - 22</SPAN></TD></TR><TR><TH id="L47"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L47">47</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectBlock<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_BLOCK - 23</SPAN></TD></TR><TR><TH id="L48"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L48">48</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectCreateItem<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_CREATE_ITEM - 24</SPAN></TD></TR><TR><TH id="L49"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L49">49</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectWeapon<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_WEAPON - 25</SPAN></TD></TR><TR><TH id="L50"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L50">50</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDefense<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_DEFENSE - 26</SPAN></TD></TR><TR><TH id="L51"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L51">51</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectPersistentAA<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_PERSISTENT_AREA_AURA - 27</SPAN></TD></TR><TR><TH id="L52"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L52">52</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummon<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON - 28</SPAN></TD></TR><TR><TH id="L53"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L53">53</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectLeap<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_LEAP - 29</SPAN></TD></TR><TR><TH id="L54"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L54">54</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectEnergize<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_ENERGIZE - 30</SPAN></TD></TR><TR><TH id="L55"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L55">55</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectWeaponDmgPerc<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_WEAPON_PERCENT_DAMAGE - 31</SPAN></TD></TR><TR><TH id="L56"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L56">56</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectTriggerMissile<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_TRIGGER_MISSILE - 32</SPAN></TD></TR><TR><TH id="L57"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L57">57</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectOpenLock<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_OPEN_LOCK - 33</SPAN></TD></TR><TR><TH id="L58"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L58">58</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectTranformItem<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_TRANSFORM_ITEM - 34</SPAN></TD></TR><TR><TH id="L59"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L59">59</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectApplyAA<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_APPLY_AREA_AURA - 35</SPAN></TD></TR><TR><TH id="L60"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L60">60</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectLearnSpell<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_LEARN_SPELL - 36</SPAN></TD></TR><TR><TH id="L61"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L61">61</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSpellDefense<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SPELL_DEFENSE - 37</SPAN></TD></TR><TR><TH id="L62"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L62">62</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDispel<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DISPEL - 38</SPAN></TD></TR><TR><TH id="L63"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L63">63</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_LANGUAGE - 39</SPAN></TD></TR><TR><TH id="L64"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L64">64</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDualWield<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_DUAL_WIELD - 40</SPAN></TD></TR><TR><TH id="L65"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L65">65</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonWild<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_WILD - 41</SPAN></TD></TR><TR><TH id="L66"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L66">66</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonGuardian<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_GUARDIAN - 42</SPAN></TD></TR><TR><TH id="L67"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L67">67</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_TELEPORT_UNITS_FACE_CASTER - 43</SPAN></TD></TR><TR><TH id="L68"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L68">68</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSkillStep<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SKILL_STEP - 44</SPAN></TD></TR><TR><TH id="L69"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L69">69</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectAddHonor<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_ADD_HONOR - 45</SPAN></TD></TR><TR><TH id="L70"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L70">70</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSpawn<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SPAWN - 46</SPAN></TD></TR><TR><TH id="L71"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L71">71</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_TRADE_SKILL - 47</SPAN></TD></TR><TR><TH id="L72"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L72">72</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_STEALTH - 48</SPAN></TD></TR><TR><TH id="L73"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L73">73</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DETECT - 49</SPAN></TD></TR><TR><TH id="L74"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L74">74</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonObject<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_OBJECT - 50</SPAN></TD></TR><TR><TH id="L75"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L75">75</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_FORCE_CRITICAL_HIT - 51 NA</SPAN></TD></TR><TR><TH id="L76"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L76">76</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_GUARANTEE_HIT - 52 NA</SPAN></TD></TR><TR><TH id="L77"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L77">77</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectEnchantItem<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_ENCHANT_ITEM - 53</SPAN></TD></TR><TR><TH id="L78"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L78">78</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectEnchantItemTemporary<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_ENCHANT_ITEM_TEMPORARY - 54</SPAN></TD></TR><TR><TH id="L79"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L79">79</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectTameCreature<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_TAMECREATURE - 55</SPAN></TD></TR><TR><TH id="L80"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L80">80</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonPet<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SUMMON_PET&nbsp; &nbsp; &nbsp; &nbsp;- 56</SPAN></TD></TR><TR><TH id="L81"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L81">81</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectLearnPetSpell<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_LEARN_PET_SPELL - 57</SPAN></TD></TR><TR><TH id="L82"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L82">82</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectWeapondamage<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_WEAPON_DAMAGE - 58</SPAN></TD></TR><TR><TH id="L83"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L83">83</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectOpenLockItem<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_OPEN_LOCK_ITEM - 59</SPAN></TD></TR><TR><TH id="L84"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L84">84</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectProficiency<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_PROFICIENCY - 60</SPAN></TD></TR><TR><TH id="L85"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L85">85</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSendEvent<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SEND_EVENT - 61</SPAN></TD></TR><TR><TH id="L86"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L86">86</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectPowerBurn<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_POWER_BURN - 62</SPAN></TD></TR><TR><TH id="L87"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L87">87</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectThreat<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_THREAT - 63</SPAN></TD></TR><TR><TH id="L88"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L88">88</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectTriggerSpell<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_TRIGGER_SPELL - 64</SPAN></TD></TR><TR><TH id="L89"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L89">89</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectApplyAA<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_APPLY_AREA_AURA2 - 65</SPAN></TD></TR><TR><TH id="L90"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L90">90</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectPowerFunnel<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_POWER_FUNNEL - 66</SPAN></TD></TR><TR><TH id="L91"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L91">91</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectHealMaxHealth<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_HEAL_MAX_HEALTH - 67</SPAN></TD></TR><TR><TH id="L92"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L92">92</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectInterruptCast<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_INTERRUPT_CAST - 68</SPAN></TD></TR><TR><TH id="L93"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L93">93</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDistract<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DISTRACT - 69</SPAN></TD></TR><TR><TH id="L94"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L94">94</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_PULL - 70</SPAN></TD></TR><TR><TH id="L95"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L95">95</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectPickpocket<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_PICKPOCKET - 71</SPAN></TD></TR><TR><TH id="L96"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L96">96</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectAddFarsight<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_ADD_FARSIGHT - 72</SPAN></TD></TR><TR><TH id="L97"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L97">97</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonPossessed<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SUMMON_POSSESSED - 73</SPAN></TD></TR><TR><TH id="L98"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L98">98</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectUseGlyph<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_USE_GLYPH - 74</SPAN></TD></TR><TR><TH id="L99"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L99">99</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectHealMechanical<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_HEAL_MECHANICAL - 75</SPAN></TD></TR><TR><TH id="L100"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L100">100</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonObjectWild<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_OBJECT_WILD - 76</SPAN></TD></TR><TR><TH id="L101"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L101">101</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectScriptEffect<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SCRIPT_EFFECT - 77</SPAN></TD></TR><TR><TH id="L102"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L102">102</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_ATTACK - 78</SPAN></TD></TR><TR><TH id="L103"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L103">103</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSanctuary<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SANCTUARY - 79</SPAN></TD></TR><TR><TH id="L104"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L104">104</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectAddComboPoints<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_ADD_COMBO_POINTS - 80</SPAN></TD></TR><TR><TH id="L105"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L105">105</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectCreateHouse<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_CREATE_HOUSE - 81</SPAN></TD></TR><TR><TH id="L106"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L106">106</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_BIND_SIGHT - 82</SPAN></TD></TR><TR><TH id="L107"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L107">107</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDuel<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DUEL - 83</SPAN></TD></TR><TR><TH id="L108"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L108">108</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectStuck<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_STUCK - 84</SPAN></TD></TR><TR><TH id="L109"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L109">109</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonPlayer<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_PLAYER - 85</SPAN></TD></TR><TR><TH id="L110"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L110">110</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectActivateObject<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_ACTIVATE_OBJECT - 86</SPAN></TD></TR><TR><TH id="L111"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L111">111</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonTotem<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SUMMON_TOTEM_SLOT1 - 87</SPAN></TD></TR><TR><TH id="L112"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L112">112</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonTotem<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SUMMON_TOTEM_SLOT2 - 88</SPAN></TD></TR><TR><TH id="L113"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L113">113</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonTotem<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SUMMON_TOTEM_SLOT3 - 89</SPAN></TD></TR><TR><TH id="L114"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L114">114</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonTotem<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SUMMON_TOTEM_SLOT4 - 90</SPAN></TD></TR><TR><TH id="L115"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L115">115</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_THREAT_ALL - 91 UNUSED</SPAN></TD></TR><TR><TH id="L116"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L116">116</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectEnchantHeldItem<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_ENCHANT_HELD_ITEM - 92</SPAN></TD></TR><TR><TH id="L117"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L117">117</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_PHANTASM - 93 OLD</SPAN></TD></TR><TR><TH id="L118"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L118">118</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSelfResurrect<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SELF_RESURRECT - 94</SPAN></TD></TR><TR><TH id="L119"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L119">119</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSkinning<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SKINNING - 95</SPAN></TD></TR><TR><TH id="L120"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L120">120</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectCharge<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_CHARGE - 96</SPAN></TD></TR><TR><TH id="L121"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L121">121</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonCritter<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SUMMON_CRITTER - 97</SPAN></TD></TR><TR><TH id="L122"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L122">122</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectKnockBack<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_KNOCK_BACK - 98</SPAN></TD></TR><TR><TH id="L123"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L123">123</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDisenchant<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DISENCHANT - 99</SPAN></TD></TR><TR><TH id="L124"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L124">124</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectInebriate<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_INEBRIATE - 100</SPAN></TD></TR><TR><TH id="L125"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L125">125</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectFeedPet<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_FEED_PET - 101</SPAN></TD></TR><TR><TH id="L126"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L126">126</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDismissPet<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DISMISS_PET - 102</SPAN></TD></TR><TR><TH id="L127"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L127">127</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectReputation<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_REPUTATION - 103</SPAN></TD></TR><TR><TH id="L128"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L128">128</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonObjectSlot<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_OBJECT_SLOT1 - 104</SPAN></TD></TR><TR><TH id="L129"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L129">129</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonObjectSlot<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_OBJECT_SLOT2 - 105</SPAN></TD></TR><TR><TH id="L130"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L130">130</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonObjectSlot<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_OBJECT_SLOT3 - 106</SPAN></TD></TR><TR><TH id="L131"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L131">131</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonObjectSlot<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SUMMON_OBJECT_SLOT4 - 107</SPAN></TD></TR><TR><TH id="L132"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L132">132</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDispelMechanic<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DISPEL_MECHANIC - 108</SPAN></TD></TR><TR><TH id="L133"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L133">133</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonDeadPet<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SUMMON_DEAD_PET - 109</SPAN></TD></TR><TR><TH id="L134"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L134">134</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDestroyAllTotems<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DESTROY_ALL_TOTEMS - 110</SPAN></TD></TR><TR><TH id="L135"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L135">135</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DURABILITY_DAMAGE - 111</SPAN></TD></TR><TR><TH id="L136"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L136">136</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSummonDemon<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SUMMON_DEMON - 112</SPAN></TD></TR><TR><TH id="L137"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L137">137</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectResurrectNew<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_RESURRECT_NEW - 113</SPAN></TD></TR><TR><TH id="L138"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L138">138</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectAttackMe<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_ATTACK_ME - 114</SPAN></TD></TR><TR><TH id="L139"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L139">139</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DURABILITY_DAMAGE_PCT - 115</SPAN></TD></TR><TR><TH id="L140"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L140">140</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSkinPlayerCorpse<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SKIN_PLAYER_CORPSE - 116</SPAN></TD></TR><TR><TH id="L141"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L141">141</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SPIRIT_HEAL - 117//Not used</SPAN></TD></TR><TR><TH id="L142"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L142">142</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSkill<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_SKILL - 118</SPAN></TD></TR><TR><TH id="L143"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L143">143</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectApplyPetAura<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_APPLY_PET_AURA - 119</SPAN></TD></TR><TR><TH id="L144"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L144">144</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_TELEPORT_GRAVEYARD - 120//Not used</SPAN></TD></TR><TR><TH id="L145"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L145">145</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectDummyMelee<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_DUMMYMELEE&nbsp; &nbsp; &nbsp; &nbsp;- 121</SPAN></TD></TR><TR><TH id="L146"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L146">146</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 122 //not used</SPAN></TD></TR><TR><TH id="L147"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L147">147</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectFilming<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_FILMING - 123 // http://www.thottbot.com/?sp=27998: flightpath</SPAN></TD></TR><TR><TH id="L148"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L148">148</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectPlayerPull<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_PLAYER_PULL - 124 - http://thottbot.com/e2312</SPAN></TD></TR><TR><TH id="L149"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L149">149</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectReduceThreatPercent<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_REDUCE_THREAT_PERCENT - 125 // Reduce Threat by % //http://www.thottbot.com/?sp=32835</SPAN></TD></TR><TR><TH id="L150"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L150">150</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectSpellSteal<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_SPELL_STEAL - 126 // Steal Beneficial Buff (Magic) //http://www.thottbot.com/?sp=30449</SPAN></TD></TR><TR><TH id="L151"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L151">151</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectProspecting<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// unknown - 127 // Search 5 ore of a base metal for precious gems.&nbsp; This will destroy the ore in the process.</SPAN></TD></TR><TR><TH id="L152"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L152">152</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectApplyAura128<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 128 // Adjust a stats by %: Mod Stat // ITS FLAT</SPAN></TD></TR><TR><TH id="L153"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L153">153</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 129 // Mod Dmg % (Spells)</SPAN></TD></TR><TR><TH id="L154"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L154">154</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectRedirectThreat<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 130 // http://www.thottbot.com/s34477</SPAN></TD></TR><TR><TH id="L155"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L155">155</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 131 // test spell</SPAN></TD></TR><TR><TH id="L156"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L156">156</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 132 // no spells</SPAN></TD></TR><TR><TH id="L157"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L157">157</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectForgetSpecialization<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SPELL_EFFECT_FORGET_SPECIALIZATION - 133 // http://www.thottbot.com/s36441 // I think this is a gm/npc spell</SPAN></TD></TR><TR><TH id="L158"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L158">158</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 134 // related to summoning objects and removing them, http://www.thottbot.com/s39161</SPAN></TD></TR><TR><TH id="L159"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L159">159</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 135 // no spells</SPAN></TD></TR><TR><TH id="L160"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L160">160</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 136 // http://www.thottbot.com/s41542 and http://www.thottbot.com/s39703</SPAN></TD></TR><TR><TH id="L161"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L161">161</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectRestoreManaPct<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 137 // http://www.thottbot.com/s41542</SPAN></TD></TR><TR><TH id="L162"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L162">162</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 138 // related to superjump or even "*jump" spells http://www.thottbot.com/?e=Unknown%20138</SPAN></TD></TR><TR><TH id="L163"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L163">163</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 139 // no spells</SPAN></TD></TR><TR><TH id="L164"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L164">164</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectTriggerSpell<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// triggers a spell from target back to caster - used at Malacrass f.e.</SPAN></TD></TR><TR><TH id="L165"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L165">165</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 141 // triggers spell, magic one,&nbsp; (Mother spell) http://www.thottbot.com/s41065</SPAN></TD></TR><TR><TH id="L166"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L166">166</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectTriggerSpellWithValue<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//SPELL_EFFECT_TRIGGER_SPELL_WITH_VALUE - 142 // triggers some kind of "Put spell on target" thing... (dono for sure) http://www.thottbot.com/s40872 and http://www.thottbot.com/s33076</SPAN></TD></TR><TR><TH id="L167"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L167">167</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unknown - 143 // Master -&gt; deamon effecting spell, http://www.thottbot.com/s25228 and http://www.thottbot.com/s35696</SPAN></TD></TR><TR><TH id="L168"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L168">168</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 144</SPAN></TD></TR><TR><TH id="L169"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L169">169</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 145</SPAN></TD></TR><TR><TH id="L170"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L170">170</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 146</SPAN></TD></TR><TR><TH id="L171"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L171">171</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// Quest Fail - 147</SPAN></TD></TR><TR><TH id="L172"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L172">172</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 148</SPAN></TD></TR><TR><TH id="L173"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L173">173</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 149</SPAN></TD></TR><TR><TH id="L174"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L174">174</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 150</SPAN></TD></TR><TR><TH id="L175"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L175">175</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// Summon Target - 151</SPAN></TD></TR><TR><TH id="L176"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L176">176</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// Summon Refer-a-Friend - 152</SPAN></TD></TR><TR><TH id="L177"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L177">177</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// Create tamed pet - 153</SPAN></TD></TR><TR><TH id="L178"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L178">178</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 154</SPAN></TD></TR><TR><TH id="L179"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L179">179</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 155</SPAN></TD></TR><TR><TH id="L180"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L180">180</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 156</SPAN></TD></TR><TR><TH id="L181"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L181">181</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 157</SPAN></TD></TR><TR><TH id="L182"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L182">182</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectMilling<SPAN class="p">,</SPAN><SPAN class="c">// Milling - 158</SPAN></TD></TR><TR><TH id="L183"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L183">183</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;</SPAN>Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">,</SPAN><SPAN class="c">// unknown - 159</SPAN></TD></TR><TR><TH id="L184"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L184">184</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">};</SPAN></TD></TR><TR><TH id="L185"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L185">185</A></TH><TD></TR><TR><TH id="L186"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L186">186</A></TH><TD><SPAN class="k">const</SPAN>&nbsp;<SPAN class="kt">char</SPAN><SPAN class="o">*</SPAN>&nbsp;SpellEffectNames<SPAN class="p">[</SPAN>TOTAL_SPELL_EFFECTS<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L187"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L187">187</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"NULL"</SPAN><SPAN class="p">,</SPAN></TD></TR><TR><TH id="L188"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L188">188</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"INSTANT_KILL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 1</SPAN></TD></TR><TR><TH id="L189"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L189">189</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SCHOOL_DAMAGE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 2</SPAN></TD></TR><TR><TH id="L190"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L190">190</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DUMMY"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 3</SPAN></TD></TR><TR><TH id="L191"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L191">191</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"PORTAL_TELEPORT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 4</SPAN></TD></TR><TR><TH id="L192"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L192">192</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TELEPORT_UNITS"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 5</SPAN></TD></TR><TR><TH id="L193"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L193">193</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"APPLY_AURA"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 6</SPAN></TD></TR><TR><TH id="L194"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L194">194</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ENVIRONMENTAL_DAMAGE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 7</SPAN></TD></TR><TR><TH id="L195"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L195">195</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"POWER_DRAIN"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 8</SPAN></TD></TR><TR><TH id="L196"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L196">196</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"HEALTH_LEECH"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 9</SPAN></TD></TR><TR><TH id="L197"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L197">197</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"HEAL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 10</SPAN></TD></TR><TR><TH id="L198"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L198">198</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"BIND"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 11</SPAN></TD></TR><TR><TH id="L199"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L199">199</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"PORTAL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 12</SPAN></TD></TR><TR><TH id="L200"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L200">200</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"RITUAL_BASE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 13</SPAN></TD></TR><TR><TH id="L201"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L201">201</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"RITUAL_SPECIALIZE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 14</SPAN></TD></TR><TR><TH id="L202"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L202">202</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"RITUAL_ACTIVATE_PORTAL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 15</SPAN></TD></TR><TR><TH id="L203"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L203">203</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"QUEST_COMPLETE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 16</SPAN></TD></TR><TR><TH id="L204"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L204">204</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"WEAPON_DAMAGE_NOSCHOOL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 17</SPAN></TD></TR><TR><TH id="L205"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L205">205</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"RESURRECT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 18</SPAN></TD></TR><TR><TH id="L206"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L206">206</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ADD_EXTRA_ATTACKS"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 19</SPAN></TD></TR><TR><TH id="L207"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L207">207</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DODGE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 20</SPAN></TD></TR><TR><TH id="L208"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L208">208</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"EVADE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 21</SPAN></TD></TR><TR><TH id="L209"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L209">209</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"PARRY"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 22</SPAN></TD></TR><TR><TH id="L210"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L210">210</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"BLOCK"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 23</SPAN></TD></TR><TR><TH id="L211"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L211">211</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"CREATE_ITEM"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 24</SPAN></TD></TR><TR><TH id="L212"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L212">212</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"WEAPON"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 25</SPAN></TD></TR><TR><TH id="L213"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L213">213</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DEFENSE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 26</SPAN></TD></TR><TR><TH id="L214"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L214">214</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"PERSISTENT_AREA_AURA"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 27</SPAN></TD></TR><TR><TH id="L215"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L215">215</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 28</SPAN></TD></TR><TR><TH id="L216"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L216">216</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"LEAP"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 29</SPAN></TD></TR><TR><TH id="L217"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L217">217</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ENERGIZE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 30</SPAN></TD></TR><TR><TH id="L218"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L218">218</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"WEAPON_PERCENT_DAMAGE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 31</SPAN></TD></TR><TR><TH id="L219"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L219">219</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TRIGGER_MISSILE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 32</SPAN></TD></TR><TR><TH id="L220"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L220">220</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"OPEN_LOCK"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 33</SPAN></TD></TR><TR><TH id="L221"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L221">221</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TRANSFORM_ITEM"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 34</SPAN></TD></TR><TR><TH id="L222"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L222">222</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"APPLY_AREA_AURA"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 35</SPAN></TD></TR><TR><TH id="L223"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L223">223</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"LEARN_SPELL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 36</SPAN></TD></TR><TR><TH id="L224"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L224">224</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SPELL_DEFENSE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 37</SPAN></TD></TR><TR><TH id="L225"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L225">225</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DISPEL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 38</SPAN></TD></TR><TR><TH id="L226"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L226">226</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"LANGUAGE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 39</SPAN></TD></TR><TR><TH id="L227"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L227">227</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DUAL_WIELD"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 40</SPAN></TD></TR><TR><TH id="L228"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L228">228</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_WILD"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 41</SPAN></TD></TR><TR><TH id="L229"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L229">229</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_GUARDIAN"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 42</SPAN></TD></TR><TR><TH id="L230"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L230">230</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TELEPORT_UNITS_FACE_CASTER"</SPAN><SPAN class="p">,</SPAN><SPAN class="c">//&nbsp; &nbsp; 43</SPAN></TD></TR><TR><TH id="L231"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L231">231</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SKILL_STEP"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 44</SPAN></TD></TR><TR><TH id="L232"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L232">232</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNDEFINED_45"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 45</SPAN></TD></TR><TR><TH id="L233"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L233">233</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SPAWN"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 46</SPAN></TD></TR><TR><TH id="L234"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L234">234</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TRADE_SKILL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 47</SPAN></TD></TR><TR><TH id="L235"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L235">235</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"STEALTH"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 48</SPAN></TD></TR><TR><TH id="L236"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L236">236</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DETECT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 49</SPAN></TD></TR><TR><TH id="L237"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L237">237</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_OBJECT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 50</SPAN></TD></TR><TR><TH id="L238"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L238">238</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"FORCE_CRITICAL_HIT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 51</SPAN></TD></TR><TR><TH id="L239"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L239">239</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"GUARANTEE_HIT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 52</SPAN></TD></TR><TR><TH id="L240"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L240">240</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ENCHANT_ITEM"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 53</SPAN></TD></TR><TR><TH id="L241"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L241">241</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ENCHANT_ITEM_TEMPORARY"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 54</SPAN></TD></TR><TR><TH id="L242"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L242">242</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TAMECREATURE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 55</SPAN></TD></TR><TR><TH id="L243"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L243">243</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_PET"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 56</SPAN></TD></TR><TR><TH id="L244"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L244">244</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"LEARN_PET_SPELL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 57</SPAN></TD></TR><TR><TH id="L245"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L245">245</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"WEAPON_DAMAGE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 58</SPAN></TD></TR><TR><TH id="L246"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L246">246</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"OPEN_LOCK_ITEM"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 59</SPAN></TD></TR><TR><TH id="L247"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L247">247</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"PROFICIENCY"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 60</SPAN></TD></TR><TR><TH id="L248"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L248">248</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SEND_EVENT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 61</SPAN></TD></TR><TR><TH id="L249"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L249">249</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"POWER_BURN"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 62</SPAN></TD></TR><TR><TH id="L250"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L250">250</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"THREAT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 63</SPAN></TD></TR><TR><TH id="L251"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L251">251</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TRIGGER_SPELL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 64</SPAN></TD></TR><TR><TH id="L252"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L252">252</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"HEALTH_FUNNEL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 65</SPAN></TD></TR><TR><TH id="L253"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L253">253</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"POWER_FUNNEL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 66</SPAN></TD></TR><TR><TH id="L254"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L254">254</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"HEAL_MAX_HEALTH"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 67</SPAN></TD></TR><TR><TH id="L255"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L255">255</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"INTERRUPT_CAST"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 68</SPAN></TD></TR><TR><TH id="L256"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L256">256</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DISTRACT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 69</SPAN></TD></TR><TR><TH id="L257"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L257">257</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"PULL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 70</SPAN></TD></TR><TR><TH id="L258"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L258">258</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"PICKPOCKET"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 71</SPAN></TD></TR><TR><TH id="L259"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L259">259</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ADD_FARSIGHT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 72</SPAN></TD></TR><TR><TH id="L260"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L260">260</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_POSSESSED"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 73</SPAN></TD></TR><TR><TH id="L261"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L261">261</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_TOTEM"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 74</SPAN></TD></TR><TR><TH id="L262"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L262">262</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"HEAL_MECHANICAL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 75</SPAN></TD></TR><TR><TH id="L263"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L263">263</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_OBJECT_WILD"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 76</SPAN></TD></TR><TR><TH id="L264"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L264">264</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SCRIPT_EFFECT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 77</SPAN></TD></TR><TR><TH id="L265"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L265">265</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ATTACK"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 78</SPAN></TD></TR><TR><TH id="L266"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L266">266</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SANCTUARY"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 79</SPAN></TD></TR><TR><TH id="L267"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L267">267</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ADD_COMBO_POINTS"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 80</SPAN></TD></TR><TR><TH id="L268"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L268">268</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"CREATE_HOUSE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 81</SPAN></TD></TR><TR><TH id="L269"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L269">269</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"BIND_SIGHT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 82</SPAN></TD></TR><TR><TH id="L270"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L270">270</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DUEL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 83</SPAN></TD></TR><TR><TH id="L271"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L271">271</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"STUCK"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 84</SPAN></TD></TR><TR><TH id="L272"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L272">272</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_PLAYER"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 85</SPAN></TD></TR><TR><TH id="L273"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L273">273</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ACTIVATE_OBJECT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 86</SPAN></TD></TR><TR><TH id="L274"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L274">274</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_TOTEM_SLOT1"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 87</SPAN></TD></TR><TR><TH id="L275"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L275">275</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_TOTEM_SLOT2"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 88</SPAN></TD></TR><TR><TH id="L276"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L276">276</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_TOTEM_SLOT3"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 89</SPAN></TD></TR><TR><TH id="L277"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L277">277</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_TOTEM_SLOT4"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 90</SPAN></TD></TR><TR><TH id="L278"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L278">278</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"THREAT_ALL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 91</SPAN></TD></TR><TR><TH id="L279"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L279">279</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ENCHANT_HELD_ITEM"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 92</SPAN></TD></TR><TR><TH id="L280"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L280">280</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_PHANTASM"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 93</SPAN></TD></TR><TR><TH id="L281"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L281">281</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SELF_RESURRECT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 94</SPAN></TD></TR><TR><TH id="L282"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L282">282</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SKINNING"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 95</SPAN></TD></TR><TR><TH id="L283"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L283">283</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"CHARGE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 96</SPAN></TD></TR><TR><TH id="L284"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L284">284</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_CRITTER"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 97</SPAN></TD></TR><TR><TH id="L285"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L285">285</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"KNOCK_BACK"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 98</SPAN></TD></TR><TR><TH id="L286"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L286">286</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DISENCHANT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 99</SPAN></TD></TR><TR><TH id="L287"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L287">287</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"INEBRIATE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 100</SPAN></TD></TR><TR><TH id="L288"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L288">288</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"FEED_PET"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 101</SPAN></TD></TR><TR><TH id="L289"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L289">289</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DISMISS_PET"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 102</SPAN></TD></TR><TR><TH id="L290"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L290">290</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"REPUTATION"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 103</SPAN></TD></TR><TR><TH id="L291"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L291">291</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_OBJECT_SLOT1"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 104</SPAN></TD></TR><TR><TH id="L292"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L292">292</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_OBJECT_SLOT2"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 105</SPAN></TD></TR><TR><TH id="L293"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L293">293</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_OBJECT_SLOT3"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 106</SPAN></TD></TR><TR><TH id="L294"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L294">294</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_OBJECT_SLOT4"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 107</SPAN></TD></TR><TR><TH id="L295"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L295">295</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DISPEL_MECHANIC"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 108</SPAN></TD></TR><TR><TH id="L296"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L296">296</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_DEAD_PET"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 109</SPAN></TD></TR><TR><TH id="L297"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L297">297</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DESTROY_ALL_TOTEMS"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 110</SPAN></TD></TR><TR><TH id="L298"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L298">298</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DURABILITY_DAMAGE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 111</SPAN></TD></TR><TR><TH id="L299"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L299">299</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_DEMON"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 112</SPAN></TD></TR><TR><TH id="L300"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L300">300</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"RESURRECT_FLAT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 113</SPAN></TD></TR><TR><TH id="L301"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L301">301</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"ATTACK_ME"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 114</SPAN></TD></TR><TR><TH id="L302"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L302">302</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DURABILITY_DAMAGE_PCT"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 115</SPAN></TD></TR><TR><TH id="L303"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L303">303</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SKIN_PLAYER_CORPSE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 116</SPAN></TD></TR><TR><TH id="L304"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L304">304</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SPIRIT_HEAL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 117</SPAN></TD></TR><TR><TH id="L305"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L305">305</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SKILL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 118</SPAN></TD></TR><TR><TH id="L306"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L306">306</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"APPLY_PET_AURA"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 119</SPAN></TD></TR><TR><TH id="L307"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L307">307</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TELEPORT_GRAVEYARD"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 120</SPAN></TD></TR><TR><TH id="L308"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L308">308</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"DUMMYMELEE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 121</SPAN></TD></TR><TR><TH id="L309"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L309">309</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN1"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 122</SPAN></TD></TR><TR><TH id="L310"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L310">310</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"FILMING"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 123</SPAN></TD></TR><TR><TH id="L311"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L311">311</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"PLAYER_PULL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 124</SPAN></TD></TR><TR><TH id="L312"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L312">312</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN4"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 125</SPAN></TD></TR><TR><TH id="L313"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L313">313</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN5"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 126</SPAN></TD></TR><TR><TH id="L314"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L314">314</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"PROSPECTING"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 127</SPAN></TD></TR><TR><TH id="L315"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L315">315</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN7"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 128</SPAN></TD></TR><TR><TH id="L316"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L316">316</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN8"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 129</SPAN></TD></TR><TR><TH id="L317"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L317">317</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN9"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 129</SPAN></TD></TR><TR><TH id="L318"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L318">318</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN10"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 130</SPAN></TD></TR><TR><TH id="L319"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L319">319</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN11"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 131</SPAN></TD></TR><TR><TH id="L320"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L320">320</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN12"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 132</SPAN></TD></TR><TR><TH id="L321"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L321">321</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"FORGET_SPECIALIZATION"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 133</SPAN></TD></TR><TR><TH id="L322"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L322">322</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN14"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 134</SPAN></TD></TR><TR><TH id="L323"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L323">323</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN15"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 135</SPAN></TD></TR><TR><TH id="L324"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L324">324</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN16"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 136</SPAN></TD></TR><TR><TH id="L325"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L325">325</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN17"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 137</SPAN></TD></TR><TR><TH id="L326"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L326">326</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN18"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 138</SPAN></TD></TR><TR><TH id="L327"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L327">327</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN19"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 139</SPAN></TD></TR><TR><TH id="L328"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L328">328</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN20"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 140</SPAN></TD></TR><TR><TH id="L329"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L329">329</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN21"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 141</SPAN></TD></TR><TR><TH id="L330"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L330">330</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TRIGGER_SPELL_WITH_VALUE"</SPAN><SPAN class="p">,</SPAN>&nbsp; <SPAN class="c">//&nbsp; &nbsp; 142</SPAN></TD></TR><TR><TH id="L331"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L331">331</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN22"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 143</SPAN></TD></TR><TR><TH id="L332"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L332">332</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN23"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 144</SPAN></TD></TR><TR><TH id="L333"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L333">333</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN24"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 145</SPAN></TD></TR><TR><TH id="L334"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L334">334</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN25"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 146</SPAN></TD></TR><TR><TH id="L335"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L335">335</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"QUEST_FAIL"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 147</SPAN></TD></TR><TR><TH id="L336"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L336">336</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN26"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 148</SPAN></TD></TR><TR><TH id="L337"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L337">337</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN27"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 149</SPAN></TD></TR><TR><TH id="L338"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L338">338</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN28"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 150</SPAN></TD></TR><TR><TH id="L339"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L339">339</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"SUMMON_TARGET"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 151</SPAN></TD></TR><TR><TH id="L340"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L340">340</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN30"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 152</SPAN></TD></TR><TR><TH id="L341"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L341">341</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"TAME_CREATURE"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 153</SPAN></TD></TR><TR><TH id="L342"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L342">342</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN32"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 154</SPAN></TD></TR><TR><TH id="L343"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L343">343</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN33"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 155</SPAN></TD></TR><TR><TH id="L344"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L344">344</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN34"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 156</SPAN></TD></TR><TR><TH id="L345"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L345">345</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"UNKNOWN35"</SPAN><SPAN class="p">,</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">//&nbsp; &nbsp; 157</SPAN></TD></TR><TR><TH id="L346"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L346">346</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="s">"MILLING"</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; 158</SPAN></TD></TR><TR><TH id="L347"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L347">347</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">};</SPAN></TD></TR><TR><TH id="L348"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L348">348</A></TH><TD></TR><TR><TH id="L349"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L349">349</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectNULL<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L350"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L350">350</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L351"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L351">351</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sLog<SPAN class="p">.</SPAN>outDebug<SPAN class="p">(</SPAN><SPAN class="s">"Unhandled spell effect %u in spell %u.</SPAN><SPAN class="se">\n</SPAN><SPAN class="s">"</SPAN><SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L352"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L352">352</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L353"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L353">353</A></TH><TD></TR><TR><TH id="L354"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L354">354</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectInstantKill<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L355"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L355">355</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L356"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L356">356</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L357"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L357">357</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L358"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L358">358</A></TH><TD></TR><TR><TH id="L359"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L359">359</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Sacrifice: if spell caster has "void walker" pet, pet dies and spell caster gets a</SPAN></TD></TR><TR><TH id="L360"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L360">360</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*Sacrifices the Voidwalker, giving its owner a shield that will absorb</SPAN></TD></TR><TR><TH id="L361"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L361">361</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; 305 damage for 30 sec. While the shield holds, spellcasting will not be \</SPAN></TD></TR><TR><TH id="L362"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L362">362</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; interrupted by damage.*/</SPAN></TD></TR><TR><TH id="L363"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L363">363</A></TH><TD></TR><TR><TH id="L364"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L364">364</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L365"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L365">365</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Demonic Sacrifice</SPAN></TD></TR><TR><TH id="L366"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L366">366</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L367"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L367">367</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; When activated, sacrifices your summoned demon to grant you an effect that lasts</SPAN></TD></TR><TR><TH id="L368"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L368">368</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; 30 minutes. The effect is canceled if any Demon is summoned.</SPAN></TD></TR><TR><TH id="L369"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L369">369</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Imp: Increases your Fire damage by 15%.</SPAN></TD></TR><TR><TH id="L370"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L370">370</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Voidwalker: Restores 3% of total Health every 4 sec.</SPAN></TD></TR><TR><TH id="L371"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L371">371</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Succubus: Increases your Shadow damage by 15%.</SPAN></TD></TR><TR><TH id="L372"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L372">372</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Felhunter: Restores 2% of total Mana every 4 sec.</SPAN></TD></TR><TR><TH id="L373"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L373">373</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L374"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L374">374</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; When activated, sacrifices your summoned demon to grant you an effect that lasts $18789d.&nbsp; The effect is canceled if any Demon is summoned.</SPAN></TD></TR><TR><TH id="L375"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L375">375</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L376"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L376">376</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Imp: Increases your Fire damage by $18789s1%.</SPAN></TD></TR><TR><TH id="L377"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L377">377</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L378"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L378">378</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Voidwalker: Restores $18790s1% of total Health every $18790t1 sec.</SPAN></TD></TR><TR><TH id="L379"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L379">379</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L380"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L380">380</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Succubus: Increases your Shadow damage by $18791s1%.</SPAN></TD></TR><TR><TH id="L381"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L381">381</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L382"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L382">382</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Felhunter: Restores $18792s1% of total Mana every $18792t1 sec.</SPAN></TD></TR><TR><TH id="L383"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L383">383</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L384"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L384">384</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L385"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L385">385</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 spellId <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L386"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L386">386</A></TH><TD></TR><TR><TH id="L387"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L387">387</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;spellId <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L388"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L388">388</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L389"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L389">389</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48743</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L390"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L390">390</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">29364</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp;<SPAN class="c">// encapsulate voidwalker</SPAN></TD></TR><TR><TH id="L391"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L391">391</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L392"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L392">392</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// retarget? some one test this spell.</SPAN></TD></TR><TR><TH id="L393"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L393">393</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L394"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L394">394</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L395"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L395">395</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">18788</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Demonic Sacrifice (508745)</SPAN></TD></TR><TR><TH id="L396"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L396">396</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 DemonicSacEffectSpellId <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L397"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L397">397</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L398"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L398">398</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L399"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L399">399</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">416</SPAN><SPAN class="o">:</SPAN>&nbsp;DemonicSacEffectSpellId <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">18789</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//Imp</SPAN></TD></TR><TR><TH id="L400"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L400">400</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">417</SPAN><SPAN class="o">:</SPAN>&nbsp;DemonicSacEffectSpellId <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">18792</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//Felhunter</SPAN></TD></TR><TR><TH id="L401"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L401">401</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">1860</SPAN><SPAN class="o">:</SPAN>&nbsp;DemonicSacEffectSpellId <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">18790</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//VoidWalker</SPAN></TD></TR><TR><TH id="L402"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L402">402</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">1863</SPAN><SPAN class="o">:</SPAN>&nbsp;DemonicSacEffectSpellId <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">18791</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//Succubus</SPAN></TD></TR><TR><TH id="L403"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L403">403</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">17252</SPAN><SPAN class="o">:</SPAN>&nbsp;DemonicSacEffectSpellId <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">35701</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//felguard</SPAN></TD></TR><TR><TH id="L404"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L404">404</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L405"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L405">405</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;DemonicSacEffectSpellId <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L406"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L406">406</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L407"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L407">407</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>se <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;DemonicSacEffectSpellId <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L408"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L408">408</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;se <SPAN class="o">&amp;&amp;</SPAN>&nbsp;u_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L409"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L409">409</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>&nbsp;u_caster<SPAN class="p">,</SPAN>&nbsp;se<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L410"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L410">410</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L411"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L411">411</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L412"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L412">412</A></TH><TD></TR><TR><TH id="L413"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L413">413</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L414"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L414">414</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L415"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L415">415</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_SACRIFICE:</SPAN></TD></TR><TR><TH id="L416"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L416">416</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L417"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L417">417</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L418"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L418">418</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L419"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L419">419</A></TH><TD></TR><TR><TH id="L420"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L420">420</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//static_cast&lt;Pet*&gt;(u_caster)-&gt;Dismiss( true );</SPAN></TD></TR><TR><TH id="L421"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L421">421</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L422"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L422">422</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>&nbsp;se <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L423"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L423">423</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>se <SPAN class="o">||</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Pet<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;u_caster <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetPetOwner<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L424"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L424">424</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L425"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L425">425</A></TH><TD></TR><TR><TH id="L426"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L426">426</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets targets<SPAN class="p">(</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L427"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L427">427</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>&nbsp;sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L428"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L428">428</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L429"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L429">429</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L430"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L430">430</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Pet<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;u_caster <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetPetOwner<SPAN class="p">(),</SPAN>&nbsp;se<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L431"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L431">431</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>targets <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L432"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L432">432</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L433"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L433">433</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L434"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L434">434</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_DEMONIC_SACRIFICE:</SPAN></TD></TR><TR><TH id="L435"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L435">435</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L436"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L436">436</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L437"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L437">437</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L438"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L438">438</A></TH><TD></TR><TR><TH id="L439"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L439">439</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//static_cast&lt;Pet*&gt;(unitTarget)-&gt;Dismiss( true );</SPAN></TD></TR><TR><TH id="L440"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L440">440</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L441"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L441">441</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>&nbsp;se <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L442"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L442">442</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>se<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L443"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L443">443</A></TH><TD></TR><TR><TH id="L444"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L444">444</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets targets<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L445"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L445">445</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>&nbsp;sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L446"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L446">446</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L447"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L447">447</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L448"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L448">448</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;se<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L449"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L449">449</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>targets <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L450"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L450">450</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L451"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L451">451</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L452"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L452">452</A></TH><TD></TR><TR><TH id="L453"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L453">453</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L454"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L454">454</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L455"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L455">455</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// moar cheaters</SPAN></TD></TR><TR><TH id="L456"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L456">456</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="p">(</SPAN>u_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L457"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L457">457</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L458"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L458">458</A></TH><TD></TR><TR><TH id="L459"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L459">459</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetPermissionCount<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L460"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L460">460</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L461"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L461">461</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L462"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L462">462</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L463"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L463">463</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//instant kill effects don't have a log</SPAN></TD></TR><TR><TH id="L464"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L464">464</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//m_caster-&gt;SpellNonMeleeDamageLog(unitTarget, GetProto()-&gt;Id, unitTarget-&gt;GetUInt32Value(UNIT_FIELD_HEALTH), true);</SPAN></TD></TR><TR><TH id="L465"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L465">465</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// cebernic: the value of instant kill must be higher than normal health,cuz anti health regenerated.</SPAN></TD></TR><TR><TH id="L466"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L466">466</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>DealDamage<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_HEALTH <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L467"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L467">467</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L468"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L468">468</A></TH><TD></TR><TR><TH id="L469"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L469">469</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSchoolDMG<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// dmg school</SPAN></TD></TR><TR><TH id="L470"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L470">470</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L471"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L471">471</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L472"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L472">472</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L473"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L473">473</A></TH><TD></TR><TR><TH id="L474"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L474">474</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>SchoolImmunityList<SPAN class="p">[</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>School<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L475"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L475">475</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L476"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L476">476</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_IMMUNE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L477"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L477">477</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L478"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L478">478</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L479"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L479">479</A></TH><TD></TR><TR><TH id="L480"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L480">480</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 dmg <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L481"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L481">481</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;static_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L482"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L482">482</A></TH><TD></TR><TR><TH id="L483"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L483">483</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectChainTarget<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN><SPAN class="c">//chain</SPAN></TD></TR><TR><TH id="L484"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L484">484</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L485"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L485">485</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 reduce <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>int32<SPAN class="p">)(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>dmg_multiplier<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">100.0f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L486"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L486">486</A></TH><TD></TR><TR><TH id="L487"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L487">487</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>reduce <SPAN class="o">&amp;&amp;</SPAN>&nbsp;chaindamage<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L488"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L488">488</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L489"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L489">489</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType <SPAN class="o">&amp;&amp;</SPAN>&nbsp;u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L490"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L490">490</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L491"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L491">491</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SM_FIValue<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>SM_PJumpReduce<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>reduce<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L492"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L492">492</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L493"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L493">493</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; chaindamage <SPAN class="o">=</SPAN>&nbsp;chaindamage <SPAN class="o">*</SPAN>&nbsp;reduce <SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L494"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L494">494</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L495"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L495">495</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L496"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L496">496</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L497"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L497">497</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; chaindamage <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L498"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L498">498</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L499"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L499">499</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;chaindamage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L500"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L500">500</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L501"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L501">501</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L502"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L502">502</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L503"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L503">503</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L504"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L504">504</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L505"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L505">505</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L506"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L506">506</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_ICE_LANCE:</SPAN>&nbsp;<SPAN class="c">// Ice Lance</SPAN></TD></TR><TR><TH id="L507"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L507">507</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L508"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L508">508</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>HasFlag<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_AURASTATE<SPAN class="p">,</SPAN>&nbsp;AURASTATE_FLAG_FROZEN<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L509"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L509">509</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">*=</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L510"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L510">510</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; if (dmg&gt;300)&nbsp; &nbsp;//dirty bugfix.</SPAN></TD></TR><TR><TH id="L511"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L511">511</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg = (int32)(damage &gt;&gt; 1);</SPAN></TD></TR><TR><TH id="L512"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L512">512</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L513"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L513">513</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L514"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L514">514</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_INCINERATE:</SPAN>&nbsp; &nbsp; &nbsp;<SPAN class="c">// Incinerate -&gt; Deals x-x extra damage if the target is affected by immolate</SPAN></TD></TR><TR><TH id="L515"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L515">515</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L516"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L516">516</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>HasFlag<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_AURASTATE<SPAN class="p">,</SPAN>&nbsp;AURASTATE_FLAG_IMMOLATE <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L517"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L517">517</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L518"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L518">518</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// random extra damage</SPAN></TD></TR><TR><TH id="L519"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L519">519</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 extra_dmg <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">111</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>RankNumber <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">11</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;RandomUInt<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>RankNumber <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">11</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L520"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L520">520</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">+=</SPAN>&nbsp;extra_dmg<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L521"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L521">521</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L522"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L522">522</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L523"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L523">523</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_ARCANE_SHOT:</SPAN>&nbsp;<SPAN class="c">//hunter - arcane shot</SPAN></TD></TR><TR><TH id="L524"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L524">524</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L525"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L525">525</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L526"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L526">526</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">+=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetRAP<SPAN class="p">())</SPAN><SPAN class="o">*</SPAN><SPAN class="mf">0.15f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L527"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L527">527</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">*=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mf">0.9f</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;RandomFloat<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mf">0.2f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// randomised damage</SPAN></TD></TR><TR><TH id="L528"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L528">528</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L529"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L529">529</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_GORE:</SPAN>&nbsp;<SPAN class="c">// boar/ravager: Gore (50% chance of double damage)</SPAN></TD></TR><TR><TH id="L530"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L530">530</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L531"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L531">531</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">*=</SPAN>&nbsp;Rand<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">50</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="mi">2</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L532"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L532">532</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L533"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L533">533</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L534"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L534">534</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_THUNDER_CLAP:</SPAN>&nbsp;<SPAN class="c">// Thunderclap</SPAN></TD></TR><TR><TH id="L535"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L535">535</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L536"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L536">536</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L537"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L537">537</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">((</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN><SPAN class="o">+</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetAP<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">0.20f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L538"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L538">538</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L539"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L539">539</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_INTERCEPT:</SPAN>&nbsp;<SPAN class="c">// Warrior - Intercept</SPAN></TD></TR><TR><TH id="L540"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L540">540</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L541"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L541">541</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L542"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L542">542</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetAP<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">0.12f</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L543"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L543">543</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L544"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L544">544</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_SHOCKWAVE:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Shockwave</SPAN></TD></TR><TR><TH id="L545"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L545">545</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L546"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L546">546</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L547"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L547">547</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetAP<SPAN class="p">()</SPAN><SPAN class="o">*</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L548"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L548">548</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L549"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L549">549</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_CONCUSSION_BLOW:</SPAN></TD></TR><TR><TH id="L550"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L550">550</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L551"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L551">551</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetAP<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">0.75f</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L552"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L552">552</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L553"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L553">553</A></TH><TD></TR><TR><TH id="L554"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L554">554</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_HEROIC_THROW:</SPAN>&nbsp; &nbsp;<SPAN class="c">// Heroic Throw</SPAN></TD></TR><TR><TH id="L555"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L555">555</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L556"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L556">556</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L557"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L557">557</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetAP<SPAN class="p">()</SPAN><SPAN class="o">/</SPAN><SPAN class="mi">2</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="mi">12</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L558"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L558">558</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// hardcoded value are faster I guess</SPAN></TD></TR><TR><TH id="L559"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L559">559</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// GetProto()-&gt;EffectBasePoints[0]+1 == 12 future reference</SPAN></TD></TR><TR><TH id="L560"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L560">560</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L561"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L561">561</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_BLOODTHIRST:</SPAN>&nbsp; &nbsp; <SPAN class="c">// Bloodthirst</SPAN></TD></TR><TR><TH id="L562"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L562">562</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L563"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L563">563</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetAP<SPAN class="p">()</SPAN><SPAN class="o">*</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L564"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L564">564</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L565"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L565">565</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_SEAL_OF_RIGHTEOUSNESS:</SPAN></TD></TR><TR><TH id="L566"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L566">566</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L567"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L567">567</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;MWS <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L568"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L568">568</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Item <SPAN class="o">*</SPAN>mainHand <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetInventoryItem<SPAN class="p">(</SPAN>EQUIPMENT_SLOT_MAINHAND<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L569"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L569">569</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>mainHand <SPAN class="o">&amp;&amp;</SPAN>&nbsp;mainHand<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L570"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L570">570</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MWS <SPAN class="o">=</SPAN>&nbsp;mainHand<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Delay <SPAN class="o">/</SPAN>&nbsp;<SPAN class="mf">1000.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L571"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L571">571</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 AP <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetAP<SPAN class="p">();</SPAN>&nbsp;<SPAN class="c">// Attack Power</SPAN></TD></TR><TR><TH id="L572"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L572">572</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 SPH <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>PLAYER_FIELD_MOD_DAMAGE_DONE_POS <SPAN class="o">+</SPAN>&nbsp;SCHOOL_HOLY<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Holy Spell Damage</SPAN></TD></TR><TR><TH id="L573"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L573">573</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;MWS <SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mf">0.022f</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>&nbsp;AP <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="mf">0.044f</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>&nbsp;SPH <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L574"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L574">574</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L575"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L575">575</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_SHIELD_SLAM:</SPAN>&nbsp; &nbsp; <SPAN class="c">// Shield Slam - damage is increased by block value</SPAN></TD></TR><TR><TH id="L576"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L576">576</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L577"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L577">577</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L578"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L578">578</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L579"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L579">579</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Item <SPAN class="o">*</SPAN>it <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetInventoryItem<SPAN class="p">(</SPAN>&nbsp;EQUIPMENT_SLOT_OFFHAND <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L580"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L580">580</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;it <SPAN class="o">&amp;&amp;</SPAN>&nbsp;it<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>InventoryType <SPAN class="o">==</SPAN>&nbsp;INVTYPE_SHIELD <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L581"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L581">581</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L582"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L582">582</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;block_multiplier <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mf">100.0f</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_modblockabsorbvalue <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mf">100.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L583"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L583">583</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;block_multiplier <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN>&nbsp;<SPAN class="p">)</SPAN>block_multiplier <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L584"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L584">584</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 blockable_damage <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>&nbsp;it<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Block <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_modblockvaluefromspells <SPAN class="o">+</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;PLAYER_RATING_MODIFIER_BLOCK <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_STAT0 <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mf">20.0f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;block_multiplier<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L585"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L585">585</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">+=</SPAN>&nbsp;blockable_damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L586"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L586">586</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L587"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L587">587</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L588"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L588">588</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L589"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L589">589</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_FIRE_STRIKE:</SPAN></TD></TR><TR><TH id="L590"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L590">590</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_LIGHTNING_STRIKE:</SPAN></TD></TR><TR><TH id="L591"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L591">591</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_MOLTEN_ARMOR:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// fire armor, is static damage</SPAN></TD></TR><TR><TH id="L592"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L592">592</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; static_damage<SPAN class="o">=</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L593"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L593">593</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L594"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L594">594</A></TH><TD></TR><TR><TH id="L595"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L595">595</A></TH><TD></TR><TR><TH id="L596"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L596">596</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L597"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L597">597</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L598"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L598">598</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L599"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L599">599</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L600"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L600">600</A></TH><TD></TR><TR><TH id="L601"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L601">601</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>static_damage <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L602"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L602">602</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L603"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L603">603</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>getClass<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L604"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L604">604</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L605"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L605">605</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">WARRIOR:</SPAN></TD></TR><TR><TH id="L606"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L606">606</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">ROGUE:</SPAN></TD></TR><TR><TH id="L607"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L607">607</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">HUNTER:</SPAN></TD></TR><TR><TH id="L608"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L608">608</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">DEATHKNIGHT:</SPAN></TD></TR><TR><TH id="L609"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L609">609</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; static_damage<SPAN class="o">=</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//No spells from these classes benefit from spell damage. Prevents Arc hunters, frost DKs, etc.</SPAN></TD></TR><TR><TH id="L610"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L610">610</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L611"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L611">611</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L612"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L612">612</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L613"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L613">613</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L614"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L614">614</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L615"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L615">615</A></TH><TD></TR><TR><TH id="L616"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L616">616</A></TH><TD></TR><TR><TH id="L617"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L617">617</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// check for no more damage left (chains)</SPAN></TD></TR><TR><TH id="L618"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L618">618</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>dmg<SPAN class="p">)</SPAN>&nbsp;dmg <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L619"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L619">619</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>dmg<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L620"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L620">620</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*********************************************************************</SPAN></TD></TR><TR><TH id="L621"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L621">621</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; CONFLAGRATE SHOULD REMOVE THE IMMOLATE DEBUFF</SPAN></TD></TR><TR><TH id="L622"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L622">622</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; **********************************************************************/</SPAN></TD></TR><TR><TH id="L623"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L623">623</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_CONFLAGRATE <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L624"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L624">624</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>RemoveFlag<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_AURASTATE<SPAN class="p">,</SPAN>&nbsp;AURASTATE_FLAG_IMMOLATE <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L625"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L625">625</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; unitTarget-&gt;RemoveAuraByNameHash(SPELL_HASH_IMMOLATE );</SPAN></TD></TR><TR><TH id="L626"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L626">626</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// RemoveFlag works better because it updates instead of just removing from the map?</SPAN></TD></TR><TR><TH id="L627"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L627">627</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// needs testing.</SPAN></TD></TR><TR><TH id="L628"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L628">628</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L629"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L629">629</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/**************************************************************************</SPAN></TD></TR><TR><TH id="L630"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L630">630</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; * This handles the correct damage of "Judgement of Command" (all ranks)</SPAN></TD></TR><TR><TH id="L631"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L631">631</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; **************************************************************************/</SPAN></TD></TR><TR><TH id="L632"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L632">632</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_JUDGEMENT_OF_COMMAND <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsStunned<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L633"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L633">633</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmg <SPAN class="o">=</SPAN>&nbsp;dmg <SPAN class="o">&gt;&gt;</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L634"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L634">634</A></TH><TD></TR><TR><TH id="L635"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L635">635</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>speed <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_triggeredSpell <SPAN class="o">==</SPAN>&nbsp;<SPAN class="kc">false</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L636"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L636">636</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L637"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L637">637</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Use this one and check player movement and update distance</SPAN></TD></TR><TR><TH id="L638"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L638">638</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//It now only checks the first distance and hits the player after time expires.</SPAN></TD></TR><TR><TH id="L639"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L639">639</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//sEventMgr.AddEvent(this, &amp;Spell::_DamageRangeUpdate, (uint32)100, EVENT_SPELL_DAMAGE_HIT, 100, 0);</SPAN></TD></TR><TR><TH id="L640"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L640">640</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;dist <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>CalcDistance<SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L641"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L641">641</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;time <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">((</SPAN>dist<SPAN class="o">*</SPAN><SPAN class="mf">1000.0f</SPAN><SPAN class="p">)</SPAN><SPAN class="o">/</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>speed<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L642"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L642">642</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>time <SPAN class="o">&lt;=</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L643"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L643">643</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SpellNonMeleeDamageLog<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>&nbsp;dmg<SPAN class="p">,</SPAN>&nbsp;pSpellId<SPAN class="o">==</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L644"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L644">644</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L645"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L645">645</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L646"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L646">646</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; damageToHit <SPAN class="o">=</SPAN>&nbsp;dmg<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L647"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L647">647</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*sEventMgr.AddEvent(m_caster, &amp;Object::SpellNonMeleeDamageLog,</SPAN></TD></TR><TR><TH id="L648"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L648">648</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget,GetProto()-&gt;Id,dmg, EVENT_SPELL_DAMAGE_HIT, uint32(time), 1);*/</SPAN></TD></TR><TR><TH id="L649"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L649">649</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>m_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Object<SPAN class="o">::</SPAN>EventSpellDamage<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN></TD></TR><TR><TH id="L650"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L650">650</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>&nbsp;dmg<SPAN class="p">,</SPAN>&nbsp;EVENT_SPELL_DAMAGE_HIT<SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>time<SPAN class="p">),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>EVENT_FLAG_DO_NOT_EXECUTE_IN_WORLD_CONTEXT<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L651"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L651">651</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L652"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L652">652</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L653"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L653">653</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L654"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L654">654</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L655"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L655">655</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_DMG_TYPE_MAGIC <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L656"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L656">656</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L657"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L657">657</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SpellNonMeleeDamageLog<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>&nbsp;dmg<SPAN class="p">,</SPAN>&nbsp;pSpellId <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;static_damage <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L658"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L658">658</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L659"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L659">659</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L660"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L660">660</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L661"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L661">661</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;u_caster <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L662"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L662">662</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L663"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L663">663</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 _type<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L664"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L664">664</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_DMG_TYPE_RANGED <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L665"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L665">665</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp;RANGED<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L666"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L666">666</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L667"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L667">667</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L668"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L668">668</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttributesExC <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mh">0x1000000</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L669"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L669">669</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp; OFFHAND<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L670"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L670">670</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L671"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L671">671</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp;MELEE<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L672"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L672">672</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L673"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L673">673</A></TH><TD></TR><TR><TH id="L674"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L674">674</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Strike<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;_type<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;dmg<SPAN class="p">,</SPAN>&nbsp;pSpellId <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L675"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L675">675</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L676"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L676">676</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L677"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L677">677</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L678"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L678">678</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L679"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L679">679</A></TH><TD></TR><TR><TH id="L680"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L680">680</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDummy<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Dummy(Scripted events)</SPAN></TD></TR><TR><TH id="L681"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L681">681</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L682"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L682">682</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 spellId <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L683"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L683">683</A></TH><TD></TR><TR><TH id="L684"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L684">684</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Try a dummy SpellHandler</SPAN></TD></TR><TR><TH id="L685"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L685">685</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>sScriptMgr<SPAN class="p">.</SPAN>CallScriptedDummySpell<SPAN class="p">(</SPAN>spellId<SPAN class="p">,</SPAN>&nbsp;i<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L686"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L686">686</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L687"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L687">687</A></TH><TD></TR><TR><TH id="L688"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L688">688</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>spellId<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L689"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L689">689</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L690"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L690">690</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*****************************************</SPAN></TD></TR><TR><TH id="L691"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L691">691</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;Class Spells</SPAN></TD></TR><TR><TH id="L692"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L692">692</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *****************************************/</SPAN></TD></TR><TR><TH id="L693"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L693">693</A></TH><TD></TR><TR><TH id="L694"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L694">694</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L695"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L695">695</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * MAGE SPELLS</SPAN></TD></TR><TR><TH id="L696"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L696">696</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************</SPAN></TD></TR><TR><TH id="L697"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L697">697</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * IDs:</SPAN></TD></TR><TR><TH id="L698"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L698">698</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;11189 Frost Warding&nbsp; &nbsp;- RANK 1,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: DONE</SPAN></TD></TR><TR><TH id="L699"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L699">699</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; 28332 Frost Warding&nbsp; &nbsp;-&nbsp; &nbsp; &nbsp; RANK 2,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: DONE</SPAN></TD></TR><TR><TH id="L700"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L700">700</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; 11094 Molten Shields&nbsp; -&nbsp; &nbsp; &nbsp; RANK 1,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: DONE</SPAN></TD></TR><TR><TH id="L701"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L701">701</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; 13043 Molten Shields&nbsp; -&nbsp; &nbsp; &nbsp; RANK 2,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: DONE</SPAN></TD></TR><TR><TH id="L702"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L702">702</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L703"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L703">703</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L704"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L704">704</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L705"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L705">705</A></TH><TD></TR><TR><TH id="L706"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L706">706</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L707"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L707">707</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Frost Warding</SPAN></TD></TR><TR><TH id="L708"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L708">708</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Increases the armor and resistances given by your Frost Armor and Ice Armor spells by X%.&nbsp; In addition, gives your Frost Ward a X% chance to reflect Frost spells and effects while active.</SPAN></TD></TR><TR><TH id="L709"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L709">709</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L710"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L710">710</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #1&nbsp; &nbsp; &nbsp; &nbsp;Apply Aura: Add % Modifier (8)</SPAN></TD></TR><TR><TH id="L711"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L711">711</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L712"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L712">712</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #2&nbsp; &nbsp; &nbsp; &nbsp;Apply Aura: Dummy</SPAN></TD></TR><TR><TH id="L713"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L713">713</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11189, 28332</SPAN></TD></TR><TR><TH id="L714"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L714">714</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L715"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L715">715</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">44572</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Deep Freeze</SPAN></TD></TR><TR><TH id="L716"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L716">716</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L717"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L717">717</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L718"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L718">718</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L719"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L719">719</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// if(unitTarget-&gt;FindAuraByNameHash( SPELL_HASH_FROST_NOVA ) )</SPAN></TD></TR><TR><TH id="L720"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L720">720</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L721"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L721">721</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L722"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L722">722</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">44440</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Fiery Payback</SPAN></TD></TR><TR><TH id="L723"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L723">723</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">44441</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L724"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L724">724</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L725"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L725">725</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L726"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L726">726</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L727"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L727">727</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>HasFlag<SPAN class="p">(</SPAN>UNIT_FIELD_AURASTATE<SPAN class="p">,</SPAN>&nbsp;AURASTATE_FLAG_HEALTH35 <SPAN class="p">))</SPAN></TD></TR><TR><TH id="L728"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L728">728</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L729"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L729">729</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L730"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L730">730</A></TH><TD></TR><TR><TH id="L731"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L731">731</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11189</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L732"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L732">732</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">28332</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L733"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L733">733</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L734"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L734">734</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L735"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L735">735</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L736"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L736">736</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>std<SPAN class="o">::</SPAN>list<SPAN class="o">&lt;</SPAN><SPAN class="k">struct</SPAN>&nbsp;ReflectSpellSchool<SPAN class="o">*&gt;::</SPAN>iterator i <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>m_reflectSpellSchool<SPAN class="p">.</SPAN>begin<SPAN class="p">(),</SPAN>&nbsp;i2<SPAN class="p">;</SPAN>i <SPAN class="o">!=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>m_reflectSpellSchool<SPAN class="p">.</SPAN>end<SPAN class="p">();)</SPAN></TD></TR><TR><TH id="L737"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L737">737</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>spellId<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L738"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L738">738</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L739"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L739">739</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i2 <SPAN class="o">=</SPAN>&nbsp;i<SPAN class="o">++</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L740"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L740">740</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>m_reflectSpellSchool<SPAN class="p">.</SPAN>erase<SPAN class="p">(</SPAN>i2<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L741"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L741">741</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L742"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L742">742</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L743"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L743">743</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">++</SPAN>i<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L744"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L744">744</A></TH><TD></TR><TR><TH id="L745"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L745">745</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReflectSpellSchool <SPAN class="o">*</SPAN>rss <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">new</SPAN>&nbsp;ReflectSpellSchool<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L746"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L746">746</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rss<SPAN class="o">-&gt;</SPAN>chance <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>procChance<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L747"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L747">747</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rss<SPAN class="o">-&gt;</SPAN>spellId <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L748"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L748">748</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rss<SPAN class="o">-&gt;</SPAN>require_aura_hash <SPAN class="o">=</SPAN>&nbsp;SPELL_HASH_FROST_WARD<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L749"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L749">749</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rss<SPAN class="o">-&gt;</SPAN>school <SPAN class="o">=</SPAN>&nbsp;SCHOOL_FROST<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L750"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L750">750</A></TH><TD></TR><TR><TH id="L751"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L751">751</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>m_reflectSpellSchool<SPAN class="p">.</SPAN>push_back<SPAN class="p">(</SPAN>rss<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L752"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L752">752</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L753"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L753">753</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L754"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L754">754</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Molten Shields&nbsp; Rank 2</SPAN></TD></TR><TR><TH id="L755"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L755">755</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Causes your Fire Ward to have a 20% chance to reflect Fire spells while active. In addition, your Molten Armor has a 100% chance to affect ranged and spell attacks.</SPAN></TD></TR><TR><TH id="L756"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L756">756</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #1&nbsp; &nbsp; &nbsp; &nbsp;Apply Aura: Dummy</SPAN></TD></TR><TR><TH id="L757"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L757">757</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11904,13043</SPAN></TD></TR><TR><TH id="L758"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L758">758</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L759"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L759">759</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11904</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L760"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L760">760</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">13043</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L761"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L761">761</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L762"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L762">762</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L763"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L763">763</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L764"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L764">764</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>std<SPAN class="o">::</SPAN>list<SPAN class="o">&lt;</SPAN><SPAN class="k">struct</SPAN>&nbsp;ReflectSpellSchool<SPAN class="o">*&gt;::</SPAN>iterator i <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>m_reflectSpellSchool<SPAN class="p">.</SPAN>begin<SPAN class="p">(),</SPAN>&nbsp;i2<SPAN class="p">;</SPAN>i <SPAN class="o">!=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>m_reflectSpellSchool<SPAN class="p">.</SPAN>end<SPAN class="p">();)</SPAN></TD></TR><TR><TH id="L765"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L765">765</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>spellId<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L766"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L766">766</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L767"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L767">767</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i2 <SPAN class="o">=</SPAN>&nbsp;i<SPAN class="o">++</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L768"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L768">768</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>m_reflectSpellSchool<SPAN class="p">.</SPAN>erase<SPAN class="p">(</SPAN>i2<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L769"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L769">769</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L770"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L770">770</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L771"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L771">771</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">++</SPAN>i<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L772"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L772">772</A></TH><TD></TR><TR><TH id="L773"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L773">773</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReflectSpellSchool <SPAN class="o">*</SPAN>rss <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">new</SPAN>&nbsp;ReflectSpellSchool<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L774"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L774">774</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rss<SPAN class="o">-&gt;</SPAN>chance <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">];</SPAN></TD></TR><TR><TH id="L775"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L775">775</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rss<SPAN class="o">-&gt;</SPAN>spellId <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L776"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L776">776</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rss<SPAN class="o">-&gt;</SPAN>require_aura_hash <SPAN class="o">=</SPAN>&nbsp;SPELL_HASH_FIRE_WARD<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L777"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L777">777</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rss<SPAN class="o">-&gt;</SPAN>school <SPAN class="o">=</SPAN>&nbsp;SCHOOL_FIRE<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L778"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L778">778</A></TH><TD></TR><TR><TH id="L779"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L779">779</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>m_reflectSpellSchool<SPAN class="p">.</SPAN>push_back<SPAN class="p">(</SPAN>rss<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L780"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L780">780</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L781"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L781">781</A></TH><TD></TR><TR><TH id="L782"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L782">782</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L783"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L783">783</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * WARRIOR SPELLS</SPAN></TD></TR><TR><TH id="L784"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L784">784</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************</SPAN></TD></TR><TR><TH id="L785"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L785">785</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * IDs:</SPAN></TD></TR><TR><TH id="L786"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L786">786</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Charge&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&nbsp; &nbsp; &nbsp; &nbsp;RANK 1,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: 100% DONE</SPAN></TD></TR><TR><TH id="L787"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L787">787</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 6178&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Charge&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&nbsp; &nbsp; &nbsp; &nbsp;RANK 2,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: 100% DONE</SPAN></TD></TR><TR><TH id="L788"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L788">788</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 11578 Charge&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&nbsp; &nbsp; &nbsp; &nbsp;RANK 3,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: 100% DONE</SPAN></TD></TR><TR><TH id="L789"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L789">789</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L790"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L790">790</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L791"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L791">791</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L792"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L792">792</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Charge rank 1:</SPAN></TD></TR><TR><TH id="L793"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L793">793</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Charge an enemy, generate 9 rage, and stun it for 1 sec.&nbsp; Cannot be used in combat.</SPAN></TD></TR><TR><TH id="L794"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L794">794</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Charge rank 2:</SPAN></TD></TR><TR><TH id="L795"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L795">795</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Charge an enemy, generate 12 rage, and stun it for 1 sec.&nbsp; Cannot be used in combat.</SPAN></TD></TR><TR><TH id="L796"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L796">796</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Charge rank 3:</SPAN></TD></TR><TR><TH id="L797"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L797">797</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Charge an enemy, generate 15 rage, and stun it for 1 sec.&nbsp; Cannot be used in combat.</SPAN></TD></TR><TR><TH id="L798"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L798">798</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - by Aziel</SPAN></TD></TR><TR><TH id="L799"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L799">799</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L800"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L800">800</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">60970</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Heroic Fury</SPAN></TD></TR><TR><TH id="L801"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L801">801</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L802"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L802">802</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L803"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L803">803</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L804"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L804">804</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">20252</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L805"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L805">805</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>ClearCooldownForSpell<SPAN class="p">(</SPAN><SPAN class="mi">20252</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L806"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L806">806</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 x<SPAN class="o">=</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_START<SPAN class="p">;</SPAN>&nbsp;x <SPAN class="o">&lt;</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_END<SPAN class="p">;</SPAN>&nbsp;<SPAN class="o">++</SPAN>x<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L807"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L807">807</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L808"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L808">808</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L809"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L809">809</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L810"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L810">810</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 y <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;y <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="o">++</SPAN>y<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L811"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L811">811</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L812"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L812">812</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectApplyAuraName<SPAN class="p">[</SPAN>y<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L813"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L813">813</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L814"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L814">814</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_ROOT:</SPAN></TD></TR><TR><TH id="L815"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L815">815</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_DECREASE_SPEED:</SPAN></TD></TR><TR><TH id="L816"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L816">816</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>Remove<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L817"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L817">817</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">goto</SPAN>&nbsp;out<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L818"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L818">818</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L819"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L819">819</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L820"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L820">820</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">continue</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L821"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L821">821</A></TH><TD><SPAN class="nl">out:</SPAN></TD></TR><TR><TH id="L822"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L822">822</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L823"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L823">823</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L824"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L824">824</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L825"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L825">825</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L826"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L826">826</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L827"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L827">827</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L828"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L828">828</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">6178</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L829"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L829">829</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11578</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L830"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L830">830</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L831"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L831">831</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L832"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L832">832</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L833"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L833">833</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetPowerType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;POWER_TYPE_RAGE <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L834"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L834">834</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L835"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L835">835</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>ModUnsigned32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_POWER2<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L836"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L836">836</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_POWER2<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">1000</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L837"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L837">837</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>ModUnsigned32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_POWER2<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1000</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_POWER2 <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L838"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L838">838</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L839"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L839">839</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L840"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L840">840</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L841"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L841">841</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L842"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L842">842</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ROGUE SPELLS</SPAN></TD></TR><TR><TH id="L843"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L843">843</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************</SPAN></TD></TR><TR><TH id="L844"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L844">844</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * IDs:</SPAN></TD></TR><TR><TH id="L845"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L845">845</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 14185 Preparation&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: DONE</SPAN></TD></TR><TR><TH id="L846"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L846">846</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L847"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L847">847</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 35729 Cloak of Shadows&nbsp; &nbsp; &nbsp; &nbsp; STATUS: DONE</SPAN></TD></TR><TR><TH id="L848"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L848">848</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L849"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L849">849</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L850"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L850">850</A></TH><TD></TR><TR><TH id="L851"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L851">851</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">5938</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//shiv</SPAN></TD></TR><TR><TH id="L852"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L852">852</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L853"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L853">853</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster <SPAN class="o">==</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;unitTarget <SPAN class="o">==</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L854"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L854">854</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L855"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L855">855</A></TH><TD></TR><TR><TH id="L856"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L856">856</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN><SPAN class="mi">5940</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L857"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L857">857</A></TH><TD></TR><TR><TH id="L858"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L858">858</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L859"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L859">859</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L860"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L860">860</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Item <SPAN class="o">*</SPAN>it <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetInventoryItem<SPAN class="p">(</SPAN>&nbsp;EQUIPMENT_SLOT_OFFHAND <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L861"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L861">861</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;it <SPAN class="o">==</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L862"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L862">862</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L863"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L863">863</A></TH><TD></TR><TR><TH id="L864"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L864">864</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EnchantmentInstance <SPAN class="o">*</SPAN>&nbsp;ench <SPAN class="o">=</SPAN>&nbsp;it<SPAN class="o">-&gt;</SPAN>GetEnchantment<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// temp enchantment slot</SPAN></TD></TR><TR><TH id="L865"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L865">865</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>ench<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L866"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L866">866</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L867"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L867">867</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EnchantEntry<SPAN class="o">*</SPAN>&nbsp;Entry <SPAN class="o">=</SPAN>&nbsp;ench<SPAN class="o">-&gt;</SPAN>Enchantment<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L868"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L868">868</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>&nbsp;uint32 c <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;c <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN>&nbsp;c<SPAN class="o">++</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L869"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L869">869</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L870"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L870">870</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;Entry<SPAN class="o">-&gt;</SPAN>type<SPAN class="p">[</SPAN>c<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;Entry<SPAN class="o">-&gt;</SPAN>spell<SPAN class="p">[</SPAN>c<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L871"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L871">871</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L872"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L872">872</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;Entry<SPAN class="o">-&gt;</SPAN>spell<SPAN class="p">[</SPAN>c<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L873"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L873">873</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;sp <SPAN class="o">==</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L874"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L874">874</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L875"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L875">875</A></TH><TD></TR><TR><TH id="L876"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L876">876</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;sp<SPAN class="o">-&gt;</SPAN>c_is_flags <SPAN class="o">&amp;</SPAN>&nbsp;SPELL_FLAG_IS_POISON <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L877"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L877">877</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L878"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L878">878</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>Entry<SPAN class="o">-&gt;</SPAN>spell<SPAN class="p">[</SPAN>c<SPAN class="p">],</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L879"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L879">879</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L880"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L880">880</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L881"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L881">881</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L882"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L882">882</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L883"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L883">883</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L884"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L884">884</A></TH><TD></TR><TR><TH id="L885"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L885">885</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L886"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L886">886</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L887"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L887">887</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Preparation</SPAN></TD></TR><TR><TH id="L888"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L888">888</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; When activated, this ability immediately finishes the cooldown on your Evasion, Sprint, Vanish, Cold Blood, Shadowstep and Premeditation abilities.</SPAN></TD></TR><TR><TH id="L889"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L889">889</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L890"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L890">890</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect&nbsp; Dummy</SPAN></TD></TR><TR><TH id="L891"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L891">891</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L892"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L892">892</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">14185</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L893"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L893">893</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L894"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L894">894</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L895"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L895">895</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L896"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L896">896</A></TH><TD></TR><TR><TH id="L897"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L897">897</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 ClearSpellId<SPAN class="p">[</SPAN><SPAN class="mi">11</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN></TD></TR><TR><TH id="L898"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L898">898</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L899"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L899">899</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">5277</SPAN><SPAN class="p">,</SPAN>&nbsp; <SPAN class="c">/* Evasion - Rank 1 */</SPAN></TD></TR><TR><TH id="L900"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L900">900</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">26669</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="c">/* Evasion - Rank 2 */</SPAN></TD></TR><TR><TH id="L901"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L901">901</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">2983</SPAN><SPAN class="p">,</SPAN>&nbsp; <SPAN class="c">/* Sprint&nbsp; - Rank 1 */</SPAN></TD></TR><TR><TH id="L902"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L902">902</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">8696</SPAN><SPAN class="p">,</SPAN>&nbsp; <SPAN class="c">/* Sprint&nbsp; - Rank 2 */</SPAN></TD></TR><TR><TH id="L903"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L903">903</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">11305</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="c">/* Sprint&nbsp; - Rank 3 */</SPAN></TD></TR><TR><TH id="L904"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L904">904</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">1856</SPAN><SPAN class="p">,</SPAN>&nbsp; <SPAN class="c">/* Vanish&nbsp; - Rank 1 */</SPAN></TD></TR><TR><TH id="L905"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L905">905</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">1857</SPAN><SPAN class="p">,</SPAN>&nbsp; <SPAN class="c">/* Vanish&nbsp; - Rank 2 */</SPAN></TD></TR><TR><TH id="L906"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L906">906</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">26889</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="c">/* Vanish&nbsp; - Rank 3 */</SPAN></TD></TR><TR><TH id="L907"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L907">907</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">14177</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="c">/* Cold Blood&nbsp; &nbsp; &nbsp; &nbsp;*/</SPAN></TD></TR><TR><TH id="L908"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L908">908</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">14183</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="c">/* Premeditation&nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L909"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L909">909</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="mi">36554</SPAN>&nbsp; <SPAN class="c">/* Shadowstep&nbsp; &nbsp; &nbsp; &nbsp;*/</SPAN></TD></TR><TR><TH id="L910"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L910">910</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">};</SPAN></TD></TR><TR><TH id="L911"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L911">911</A></TH><TD></TR><TR><TH id="L912"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L912">912</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>i <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;i <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">11</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="o">++</SPAN>i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L913"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L913">913</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L914"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L914">914</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN>&nbsp;ClearSpellId<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L915"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L915">915</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>ClearCooldownForSpell<SPAN class="p">(</SPAN>&nbsp;ClearSpellId<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L916"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L916">916</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L917"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L917">917</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L918"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L918">918</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L919"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L919">919</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Cloak of Shadows</SPAN></TD></TR><TR><TH id="L920"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L920">920</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Instantly removes all existing harmful spell effects and increases your chance to resist all spells by 90% for 5 sec.&nbsp; Does not remove effects that prevent you from using Cloak of Shadows.</SPAN></TD></TR><TR><TH id="L921"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L921">921</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L922"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L922">922</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #1&nbsp; &nbsp; &nbsp; &nbsp;Apply Aura: Mod Attacker Spell Hit Chance (126)</SPAN></TD></TR><TR><TH id="L923"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L923">923</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Value: -90</SPAN></TD></TR><TR><TH id="L924"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L924">924</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #2&nbsp; &nbsp; &nbsp; &nbsp;Trigger Spell</SPAN></TD></TR><TR><TH id="L925"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L925">925</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell #35729 &lt;--- THIS SPELL</SPAN></TD></TR><TR><TH id="L926"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L926">926</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L927"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L927">927</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">35729</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L928"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L928">928</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L929"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L929">929</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L930"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L930">930</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L931"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L931">931</A></TH><TD></TR><TR><TH id="L932"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L932">932</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Aura <SPAN class="o">*</SPAN>&nbsp;pAura<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L933"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L933">933</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 i <SPAN class="o">=</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_START<SPAN class="p">;</SPAN>&nbsp;i <SPAN class="o">&lt;</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_END<SPAN class="p">;</SPAN>&nbsp;<SPAN class="o">++</SPAN>i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L934"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L934">934</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L935"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L935">935</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L936"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L936">936</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;pAura <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>pAura<SPAN class="o">-&gt;</SPAN>IsPassive<SPAN class="p">()</SPAN></TD></TR><TR><TH id="L937"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L937">937</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>pAura<SPAN class="o">-&gt;</SPAN>IsPositive<SPAN class="p">()</SPAN></TD></TR><TR><TH id="L938"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L938">938</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN><SPAN class="p">(</SPAN>pAura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Attributes <SPAN class="o">&amp;</SPAN>&nbsp;ATTRIBUTES_IGNORE_INVULNERABILITY<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L939"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L939">939</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">&amp;&amp;</SPAN>&nbsp;pAura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>School <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">0</SPAN></TD></TR><TR><TH id="L940"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L940">940</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L941"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L941">941</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura<SPAN class="o">-&gt;</SPAN>Remove<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L942"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L942">942</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L943"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L943">943</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L944"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L944">944</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L945"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L945">945</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * DRUID SPELLS</SPAN></TD></TR><TR><TH id="L946"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L946">946</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************</SPAN></TD></TR><TR><TH id="L947"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L947">947</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * IDs:</SPAN></TD></TR><TR><TH id="L948"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L948">948</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 34297 Improved Leader of the Pack RANK 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS: DONE</SPAN></TD></TR><TR><TH id="L949"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L949">949</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 34300 Improved Leader of the Pack RANK 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS: DONE</SPAN></TD></TR><TR><TH id="L950"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L950">950</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L951"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L951">951</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L952"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L952">952</A></TH><TD></TR><TR><TH id="L953"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L953">953</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L954"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L954">954</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Improved Leader of the Pack</SPAN></TD></TR><TR><TH id="L955"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L955">955</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Your Leader of the Pack ability also causes affected targets to have a X% chance to heal themselves for X% of their total health when they critically hit with a melee or ranged attack.&nbsp; The healing effect cannot occur more than once every 6 sec.</SPAN></TD></TR><TR><TH id="L956"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L956">956</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L957"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L957">957</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #1&nbsp; &nbsp; &nbsp; &nbsp;Apply Aura: Add Flat Modifier (12)</SPAN></TD></TR><TR><TH id="L958"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L958">958</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Value: X</SPAN></TD></TR><TR><TH id="L959"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L959">959</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #2&nbsp; &nbsp; &nbsp; &nbsp;Dummy</SPAN></TD></TR><TR><TH id="L960"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L960">960</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Value: 100</SPAN></TD></TR><TR><TH id="L961"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L961">961</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L962"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L962">962</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">34297</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L963"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L963">963</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">34300</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L964"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L964">964</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L965"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L965">965</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L966"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L966">966</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L967"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L967">967</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ProcTriggerSpell ILotP<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L968"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L968">968</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>origId <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">34299</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L969"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L969">969</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>spellId <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">34299</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L970"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L970">970</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>procChance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L971"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L971">971</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>procFlags <SPAN class="o">=</SPAN>&nbsp;PROC_ON_CRIT_ATTACK <SPAN class="o">|</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>uint32<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>PROC_TARGET_SELF<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L972"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L972">972</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>deleted <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L973"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L973">973</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>caster <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L974"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L974">974</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>LastTrigger <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L975"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L975">975</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>groupRelation<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L976"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L976">976</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>groupRelation<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L977"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L977">977</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ILotP<SPAN class="p">.</SPAN>groupRelation<SPAN class="p">[</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L978"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L978">978</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>m_procSpells<SPAN class="p">.</SPAN>push_back<SPAN class="p">(</SPAN>ILotP<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L979"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L979">979</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L980"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L980">980</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L981"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L981">981</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * HUNTER SPELLS</SPAN></TD></TR><TR><TH id="L982"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L982">982</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************</SPAN></TD></TR><TR><TH id="L983"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L983">983</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * IDs:</SPAN></TD></TR><TR><TH id="L984"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L984">984</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 35029 Focused Fire RANK 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: ToDo</SPAN></TD></TR><TR><TH id="L985"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L985">985</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 35030 Focused Fire RANK 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: ToDo</SPAN></TD></TR><TR><TH id="L986"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L986">986</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L987"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L987">987</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L988"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L988">988</A></TH><TD></TR><TR><TH id="L989"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L989">989</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L990"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L990">990</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Focused Fire</SPAN></TD></TR><TR><TH id="L991"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L991">991</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; All damage caused by you is increased by 1% while your pet is active and the critical strike chance of your Kill Command ability is increased by 10%.</SPAN></TD></TR><TR><TH id="L992"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L992">992</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L993"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L993">993</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #1&nbsp; &nbsp; &nbsp; &nbsp;Dummy</SPAN></TD></TR><TR><TH id="L994"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L994">994</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Value: 1</SPAN></TD></TR><TR><TH id="L995"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L995">995</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L996"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L996">996</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #2&nbsp; &nbsp; &nbsp; &nbsp;Apply Aura: Add Flat Modifier (7)</SPAN></TD></TR><TR><TH id="L997"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L997">997</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Value: 10</SPAN></TD></TR><TR><TH id="L998"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L998">998</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L999"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L999">999</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1000"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1000">1000</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; case 35029:</SPAN></TD></TR><TR><TH id="L1001"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1001">1001</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; case 35030:</SPAN></TD></TR><TR><TH id="L1002"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1002">1002</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L1003"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1003">1003</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }break;</SPAN></TD></TR><TR><TH id="L1004"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1004">1004</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1005"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1005">1005</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Aspect of the Viper</SPAN></TD></TR><TR><TH id="L1006"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1006">1006</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; case 34074:</SPAN></TD></TR><TR><TH id="L1007"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1007">1007</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L1008"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1008">1008</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// included in the dummy aura for simplicity</SPAN></TD></TR><TR><TH id="L1009"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1009">1009</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }break;</SPAN></TD></TR><TR><TH id="L1010"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1010">1010</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1011"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1011">1011</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L1012"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1012">1012</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * PALADIN SPELLS</SPAN></TD></TR><TR><TH id="L1013"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1013">1013</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************</SPAN></TD></TR><TR><TH id="L1014"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1014">1014</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * IDs:</SPAN></TD></TR><TR><TH id="L1015"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1015">1015</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 31789 Righteous Defense&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: DONE</SPAN></TD></TR><TR><TH id="L1016"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1016">1016</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L1017"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1017">1017</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 18350 illumination&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS: DONE</SPAN></TD></TR><TR><TH id="L1018"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1018">1018</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L1019"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1019">1019</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L1020"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1020">1020</A></TH><TD></TR><TR><TH id="L1021"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1021">1021</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L1022"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1022">1022</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Righteous Defense</SPAN></TD></TR><TR><TH id="L1023"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1023">1023</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Come to the defense of a friendly target, commanding up to 3 enemies attacking the target to attack the Paladin instead.</SPAN></TD></TR><TR><TH id="L1024"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1024">1024</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1025"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1025">1025</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #1&nbsp; &nbsp; &nbsp; &nbsp;Dummy</SPAN></TD></TR><TR><TH id="L1026"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1026">1026</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Radius: 5 yards</SPAN></TD></TR><TR><TH id="L1027"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1027">1027</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1028"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1028">1028</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #2&nbsp; &nbsp; &nbsp; &nbsp;Trigger Spell</SPAN></TD></TR><TR><TH id="L1029"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1029">1029</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell #31980</SPAN></TD></TR><TR><TH id="L1030"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1030">1030</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1031"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1031">1031</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">31789</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1032"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1032">1032</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1033"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1033">1033</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//we will try to lure 3 enemies from our target</SPAN></TD></TR><TR><TH id="L1034"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1034">1034</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1035"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1035">1035</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1036"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1036">1036</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Unit <SPAN class="o">*</SPAN>targets<SPAN class="p">[</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">];</SPAN></TD></TR><TR><TH id="L1037"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1037">1037</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;targets_got<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1038"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1038">1038</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>std<SPAN class="o">::</SPAN>set<SPAN class="o">&lt;</SPAN>Object<SPAN class="o">*&gt;::</SPAN>iterator itr <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetInRangeSetBegin<SPAN class="p">(),</SPAN>&nbsp;i2<SPAN class="p">;</SPAN>&nbsp;itr <SPAN class="o">!=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetInRangeSetEnd<SPAN class="p">();</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1039"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1039">1039</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1040"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1040">1040</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i2 <SPAN class="o">=</SPAN>&nbsp;itr<SPAN class="o">++</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1041"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1041">1041</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// don't add objects that are not units and that are dead</SPAN></TD></TR><TR><TH id="L1042"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1042">1042</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>i2<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN><SPAN class="o">!=</SPAN>&nbsp;TYPEID_UNIT <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Unit<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>i2<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L1043"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1043">1043</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">continue</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1044"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1044">1044</A></TH><TD></TR><TR><TH id="L1045"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1045">1045</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>cr<SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>i2<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L1046"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1046">1046</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>cr<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetNextTarget<SPAN class="p">()</SPAN><SPAN class="o">==</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1047"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1047">1047</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">[</SPAN>targets_got<SPAN class="o">++</SPAN><SPAN class="p">]</SPAN><SPAN class="o">=</SPAN>cr<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1048"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1048">1048</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>targets_got<SPAN class="o">==</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1049"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1049">1049</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1050"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1050">1050</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1051"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1051">1051</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN><SPAN class="kt">int</SPAN>&nbsp;i<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>i<SPAN class="o">&lt;</SPAN>targets_got<SPAN class="p">;</SPAN>i<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1052"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1052">1052</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1053"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1053">1053</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//set threat to this target so we are the msot hated</SPAN></TD></TR><TR><TH id="L1054"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1054">1054</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 threat_to_him <SPAN class="o">=</SPAN>&nbsp;targets<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>getThreatByPtr<SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1055"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1055">1055</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 threat_to_us <SPAN class="o">=</SPAN>&nbsp;targets<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>getThreatByPtr<SPAN class="p">(</SPAN>u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1056"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1056">1056</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;threat_dif <SPAN class="o">=</SPAN>&nbsp;threat_to_him <SPAN class="o">-</SPAN>&nbsp;threat_to_us<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1057"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1057">1057</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>threat_dif<SPAN class="o">&gt;</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN><SPAN class="c">//should nto happen</SPAN></TD></TR><TR><TH id="L1058"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1058">1058</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modThreatByPtr<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>threat_dif<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1059"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1059">1059</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttackReaction<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1060"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1060">1060</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetNextTarget<SPAN class="p">(</SPAN>u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1061"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1061">1061</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1062"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1062">1062</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1063"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1063">1063</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L1064"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1064">1064</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Illumination</SPAN></TD></TR><TR><TH id="L1065"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1065">1065</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; After getting a critical effect from your Flash of Light, Holy Light, or Holy Shock heal spell, gives you a X% chance to gain mana equal to 60% of the base cost of the spell.</SPAN></TD></TR><TR><TH id="L1066"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1066">1066</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1067"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1067">1067</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #1&nbsp; &nbsp; &nbsp; &nbsp;Apply Aura: Proc Trigger Spell</SPAN></TD></TR><TR><TH id="L1068"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1068">1068</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Proc chance: 20%</SPAN></TD></TR><TR><TH id="L1069"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1069">1069</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell #18350 &lt;-- THIS SPELL</SPAN></TD></TR><TR><TH id="L1070"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1070">1070</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #2&nbsp; &nbsp; &nbsp; &nbsp;Apply Aura: Override Class Scripts (2689)</SPAN></TD></TR><TR><TH id="L1071"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1071">1071</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Value: 60</SPAN></TD></TR><TR><TH id="L1072"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1072">1072</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1073"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1073">1073</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">18350</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1074"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1074">1074</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1075"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1075">1075</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;m_triggeredByAura<SPAN class="o">==</SPAN><SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;pSpellId <SPAN class="o">:</SPAN>&nbsp;m_triggeredByAura<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1076"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1076">1076</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1077"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1077">1077</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20210</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1078"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1078">1078</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20212</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1079"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1079">1079</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20213</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1080"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1080">1080</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20214</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1081"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1081">1081</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20215</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1082"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1082">1082</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1083"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1083">1083</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1084"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1084">1084</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>&nbsp;sp <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>last_heal_spell <SPAN class="o">?</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>last_heal_spell <SPAN class="o">:</SPAN>&nbsp;GetProto<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1085"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1085">1085</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 cost <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>sp<SPAN class="o">-&gt;</SPAN>manaCost<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">0.6f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1086"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1086">1086</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>Energize<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">20272</SPAN><SPAN class="p">,</SPAN>&nbsp;cost<SPAN class="p">,</SPAN>&nbsp;POWER_TYPE_MANA <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1087"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1087">1087</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1088"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1088">1088</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">38443</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1089"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1089">1089</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1090"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1090">1090</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Shaman - Skyshatter Regalia - Two Piece Bonus</SPAN></TD></TR><TR><TH id="L1091"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1091">1091</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// it checks for earth, air, water, fire totems and triggers Totemic Mastery spell 38437.</SPAN></TD></TR><TR><TH id="L1092"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1092">1092</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1093"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1093">1093</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">])</SPAN></TD></TR><TR><TH id="L1094"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1094">1094</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1095"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1095">1095</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Aura <SPAN class="o">*</SPAN>aur <SPAN class="o">=</SPAN>&nbsp;AuraPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1096"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1096">1096</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>aur<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1097"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1097">1097</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1098"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1098">1098</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aur<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">38437</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="mi">5000</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1099"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1099">1099</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>&nbsp;uint32 i<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">&lt;</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">++</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1100"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1100">1100</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aur<SPAN class="o">-&gt;</SPAN>AddMod<SPAN class="p">(</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectApplyAuraName<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;i <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1101"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1101">1101</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>AddAura<SPAN class="p">(</SPAN>aur<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1102"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1102">1102</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1103"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1103">1103</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1104"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1104">1104</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1105"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1105">1105</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1106"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1106">1106</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1107"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1107">1107</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1108"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1108">1108</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Judgements of the Wise</SPAN></TD></TR><TR><TH id="L1109"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1109">1109</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">54180</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1110"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1110">1110</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1111"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1111">1111</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1112"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1112">1112</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1113"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1113">1113</A></TH><TD></TR><TR><TH id="L1114"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1114">1114</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>Energize<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">31930</SPAN><SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN><SPAN class="mf">0.15f</SPAN><SPAN class="o">*</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_BASE_MANA<SPAN class="p">)),</SPAN>&nbsp;POWER_TYPE_MANA <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1115"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1115">1115</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">57669</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1116"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1116">1116</A></TH><TD></TR><TR><TH id="L1117"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1117">1117</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1118"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1118">1118</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L1119"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1119">1119</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * PRIEST SPELLS</SPAN></TD></TR><TR><TH id="L1120"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1120">1120</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************</SPAN></TD></TR><TR><TH id="L1121"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1121">1121</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * IDs:</SPAN></TD></TR><TR><TH id="L1122"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1122">1122</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 34433 Shadowfiend&nbsp; &nbsp; &nbsp;STATUS: ToDo</SPAN></TD></TR><TR><TH id="L1123"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1123">1123</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L1124"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1124">1124</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L1125"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1125">1125</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L1126"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1126">1126</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creates a shadowy fiend to attack the target.&nbsp; Caster receives mana when the Shadowfiend deals damage.&nbsp; Lasts 15 sec.</SPAN></TD></TR><TR><TH id="L1127"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1127">1127</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #1&nbsp; &nbsp; &nbsp; &nbsp;Summon (19668)</SPAN></TD></TR><TR><TH id="L1128"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1128">1128</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect #2&nbsp; &nbsp; &nbsp; &nbsp;Trigger Spell</SPAN></TD></TR><TR><TH id="L1129"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1129">1129</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell #41967 &lt;--- THIS SPELL</SPAN></TD></TR><TR><TH id="L1130"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1130">1130</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1131"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1131">1131</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*case 41967:</SPAN></TD></TR><TR><TH id="L1132"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1132">1132</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L1133"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1133">1133</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }break;</SPAN></TD></TR><TR><TH id="L1134"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1134">1134</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1135"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1135">1135</A></TH><TD></TR><TR><TH id="L1136"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1136">1136</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L1137"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1137">1137</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * SHAMAN SPELLS</SPAN></TD></TR><TR><TH id="L1138"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1138">1138</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************</SPAN></TD></TR><TR><TH id="L1139"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1139">1139</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * IDs:</SPAN></TD></TR><TR><TH id="L1140"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1140">1140</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * NO SPELLS</SPAN></TD></TR><TR><TH id="L1141"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1141">1141</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L1142"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1142">1142</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L1143"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1143">1143</A></TH><TD></TR><TR><TH id="L1144"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1144">1144</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L1145"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1145">1145</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * WARLOCK SPELLS</SPAN></TD></TR><TR><TH id="L1146"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1146">1146</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************</SPAN></TD></TR><TR><TH id="L1147"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1147">1147</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * IDs:</SPAN></TD></TR><TR><TH id="L1148"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1148">1148</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 19028 Soul Link&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STATUS: ToDo</SPAN></TD></TR><TR><TH id="L1149"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1149">1149</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L1150"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1150">1150</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 19028 soul link effect&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS: DONE</SPAN></TD></TR><TR><TH id="L1151"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1151">1151</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; --------------------------------------------</SPAN></TD></TR><TR><TH id="L1152"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1152">1152</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L1153"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1153">1153</A></TH><TD></TR><TR><TH id="L1154"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1154">1154</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L1155"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1155">1155</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Soul Link</SPAN></TD></TR><TR><TH id="L1156"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1156">1156</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; When active, 20% of all damage taken by the caster is taken by your Imp, Voidwalker, Succubus, Felhunter, Felguard, or enslaved demon instead.&nbsp; That damage cannot be prevented.&nbsp; In addition, both the demon and master will inflict 5% more damage.&nbsp; Lasts as long as the demon is active and controlled.</SPAN></TD></TR><TR><TH id="L1157"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1157">1157</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1158"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1158">1158</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Effect&nbsp; Dummy</SPAN></TD></TR><TR><TH id="L1159"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1159">1159</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1160"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1160">1160</A></TH><TD></TR><TR><TH id="L1161"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1161">1161</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; case 19028:</SPAN></TD></TR><TR><TH id="L1162"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1162">1162</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L1163"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1163">1163</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }break;</SPAN></TD></TR><TR><TH id="L1164"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1164">1164</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1165"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1165">1165</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L1166"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1166">1166</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Soul Link - EFFECT</SPAN></TD></TR><TR><TH id="L1167"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1167">1167</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 20% of damage taken by master is split with demon. All damage increased by 5%.</SPAN></TD></TR><TR><TH id="L1168"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1168">1168</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1169"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1169">1169</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">25228</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1170"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1170">1170</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1171"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1171">1171</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L1172"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1172">1172</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1173"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1173">1173</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 pet_dmg <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="o">-&gt;</SPAN>forced_basepoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="o">*</SPAN><SPAN class="mi">20</SPAN><SPAN class="o">/</SPAN><SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1174"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1174">1174</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;pet_dmg <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1175"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1175">1175</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1176"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1176">1176</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>ModUnsigned32Value<SPAN class="p">(</SPAN>UNIT_FIELD_HEALTH<SPAN class="p">,</SPAN>pet_dmg<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1177"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1177">1177</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>DealDamage<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>pet_dmg<SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">25228</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1178"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1178">1178</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1179"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1179">1179</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1180"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1180">1180</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/************************</SPAN></TD></TR><TR><TH id="L1181"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1181">1181</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Death Knight Spells</SPAN></TD></TR><TR><TH id="L1182"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1182">1182</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L1183"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1183">1183</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">46584</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1184"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1184">1184</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1185"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1185">1185</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster&nbsp; &nbsp; &nbsp;<SPAN class="o">!=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1186"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1186">1186</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1187"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1187">1187</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;x <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">()</SPAN><SPAN class="o">+</SPAN>rand<SPAN class="p">()</SPAN><SPAN class="o">%</SPAN><SPAN class="mi">25</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1188"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1188">1188</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;y <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN><SPAN class="o">+</SPAN>rand<SPAN class="p">()</SPAN><SPAN class="o">%</SPAN><SPAN class="mi">25</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1189"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1189">1189</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;z <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1190"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1190">1190</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>ghoulSpell <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntryForced<SPAN class="p">(</SPAN><SPAN class="mi">52150</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1191"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1191">1191</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>corpseTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// We are targeting a corpse.</SPAN></TD></TR><TR><TH id="L1192"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1192">1192</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1193"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1193">1193</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">=</SPAN>&nbsp;corpseTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1194"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1194">1194</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">=</SPAN>&nbsp;corpseTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1195"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1195">1195</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; z <SPAN class="o">=</SPAN>&nbsp;corpseTarget<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1196"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1196">1196</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1197"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1197">1197</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>CastSpellAoF<SPAN class="p">(</SPAN>x<SPAN class="p">,</SPAN>y<SPAN class="p">,</SPAN>z<SPAN class="p">,</SPAN>ghoulSpell<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1198"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1198">1198</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">26125</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1199"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1199">1199</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureProto <SPAN class="o">*</SPAN>&nbsp;cp <SPAN class="o">=</SPAN>&nbsp;CreatureProtoStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">26125</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1200"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1200">1200</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>ci <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>cp <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1201"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1201">1201</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1202"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1202">1202</A></TH><TD></TR><TR><TH id="L1203"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1203">1203</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LocationVector <SPAN class="o">*</SPAN>vec <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">new</SPAN>&nbsp;LocationVector<SPAN class="p">(</SPAN>x<SPAN class="p">,</SPAN>y<SPAN class="p">,</SPAN>z<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1204"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1204">1204</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>summon <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>CreatePet<SPAN class="p">(</SPAN><SPAN class="mi">26125</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1205"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1205">1205</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>SetPower<SPAN class="p">(</SPAN>&nbsp;POWER_TYPE_ENERGY<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN><SPAN class="mi">100</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1206"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1206">1206</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_POWER4<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN><SPAN class="mi">100</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1207"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1207">1207</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">52143</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L1208"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1208">1208</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1209"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1209">1209</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>CreateAsSummon<SPAN class="p">(</SPAN><SPAN class="mi">26125</SPAN><SPAN class="p">,</SPAN>&nbsp;ci<SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">6</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;vec<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// considered pet</SPAN></TD></TR><TR><TH id="L1210"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1210">1210</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">47481</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Gnaw</SPAN></TD></TR><TR><TH id="L1211"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1211">1211</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">47482</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Leap</SPAN></TD></TR><TR><TH id="L1212"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1212">1212</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">47484</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Huddle</SPAN></TD></TR><TR><TH id="L1213"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1213">1213</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">47468</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Claw</SPAN></TD></TR><TR><TH id="L1214"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1214">1214</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1215"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1215">1215</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L1216"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1216">1216</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1217"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1217">1217</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>CreateAsSummon<SPAN class="p">(</SPAN><SPAN class="mi">26125</SPAN><SPAN class="p">,</SPAN>&nbsp;ci<SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">6</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">120</SPAN><SPAN class="p">,</SPAN>&nbsp;vec<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// 2 min duration</SPAN></TD></TR><TR><TH id="L1218"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1218">1218</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1219"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1219">1219</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>summon<SPAN class="p">,</SPAN><SPAN class="mi">50142</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1220"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1220">1220</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>vec<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">delete</SPAN>&nbsp;vec<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1221"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1221">1221</A></TH><TD></TR><TR><TH id="L1222"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1222">1222</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1223"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1223">1223</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1224"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1224">1224</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">49576</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Death grip</SPAN></TD></TR><TR><TH id="L1225"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1225">1225</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1226"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1226">1226</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L1227"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1227">1227</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1228"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1228">1228</A></TH><TD></TR><TR><TH id="L1229"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1229">1229</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L1230"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1230">1230</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1231"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1231">1231</A></TH><TD></TR><TR><TH id="L1232"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1232">1232</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Player <SPAN class="o">*</SPAN>playerTarget <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1233"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1233">1233</A></TH><TD></TR><TR><TH id="L1234"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1234">1234</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>m_CurrentTransporter<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Blizzard screwed this up, so we won't.</SPAN></TD></TR><TR><TH id="L1235"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1235">1235</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1236"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1236">1236</A></TH><TD></TR><TR><TH id="L1237"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1237">1237</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEffectPlayerPull<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1238"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1238">1238</A></TH><TD></TR><TR><TH id="L1239"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1239">1239</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1240"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1240">1240</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1241"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1241">1241</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L1242"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1242">1242</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1243"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1243">1243</A></TH><TD></TR><TR><TH id="L1244"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1244">1244</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;posX<SPAN class="p">,</SPAN>&nbsp;posY<SPAN class="p">,</SPAN>&nbsp;posZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1245"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1245">1245</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;deltaX<SPAN class="p">,</SPAN>deltaY<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1246"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1246">1246</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1247"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1247">1247</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1248"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1248">1248</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; deltaX <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">()</SPAN><SPAN class="o">-</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1249"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1249">1249</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; deltaY <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN><SPAN class="o">-</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1250"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1250">1250</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>deltaX <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;deltaY <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1251"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1251">1251</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1252"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1252">1252</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;d <SPAN class="o">=</SPAN>&nbsp;sqrt<SPAN class="p">(</SPAN>deltaX<SPAN class="o">*</SPAN>deltaX<SPAN class="o">+</SPAN>deltaY<SPAN class="o">*</SPAN>deltaY<SPAN class="p">)</SPAN><SPAN class="o">-</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_BOUNDINGRADIUS<SPAN class="p">)</SPAN><SPAN class="o">-</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_BOUNDINGRADIUS<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1253"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1253">1253</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;alpha <SPAN class="o">=</SPAN>&nbsp;atanf<SPAN class="p">(</SPAN>deltaY<SPAN class="o">/</SPAN>deltaX<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1254"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1254">1254</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>deltaX<SPAN class="o">&lt;</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1255"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1255">1255</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alpha <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>M_PI<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1256"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1256">1256</A></TH><TD></TR><TR><TH id="L1257"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1257">1257</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posX <SPAN class="o">=</SPAN>&nbsp;d<SPAN class="o">*</SPAN>cosf<SPAN class="p">(</SPAN>alpha<SPAN class="p">)</SPAN><SPAN class="o">+</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1258"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1258">1258</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posY <SPAN class="o">=</SPAN>&nbsp;d<SPAN class="o">*</SPAN>sinf<SPAN class="p">(</SPAN>alpha<SPAN class="p">)</SPAN><SPAN class="o">+</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1259"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1259">1259</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posZ <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1260"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1260">1260</A></TH><TD></TR><TR><TH id="L1261"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1261">1261</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 time <SPAN class="o">=</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>CalcDistance<SPAN class="p">(</SPAN>m_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="p">((</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>m_runSpeed <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">3.5</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">0.001f</SPAN><SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="mf">0.5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1262"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1262">1262</A></TH><TD></TR><TR><TH id="L1263"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1263">1263</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_MONSTER_MOVE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">50</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1264"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1264">1264</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1265"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1265">1265</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1266"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1266">1266</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1267"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1267">1267</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1268"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1268">1268</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;getMSTime<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1269"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1269">1269</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint8<SPAN class="p">(</SPAN><SPAN class="mh">0x00</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1270"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1270">1270</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN><SPAN class="mh">0x00000100</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1271"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1271">1271</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;time<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1272"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1272">1272</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1273"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1273">1273</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;posX <SPAN class="o">&lt;&lt;</SPAN>&nbsp;posY <SPAN class="o">&lt;&lt;</SPAN>&nbsp;posZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1274"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1274">1274</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_UNIT<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1275"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1275">1275</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>StopMovement<SPAN class="p">(</SPAN><SPAN class="mi">2000</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1276"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1276">1276</A></TH><TD></TR><TR><TH id="L1277"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1277">1277</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SendMessageToSet<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1278"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1278">1278</A></TH><TD></TR><TR><TH id="L1279"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1279">1279</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetPosition<SPAN class="p">(</SPAN>posX<SPAN class="p">,</SPAN>posY<SPAN class="p">,</SPAN>posZ<SPAN class="p">,</SPAN>alpha<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1280"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1280">1280</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>addStateFlag<SPAN class="p">(</SPAN>UF_ATTACKING<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1281"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1281">1281</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>smsg_AttackStart<SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1282"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1282">1282</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>setAttackTimer<SPAN class="p">(</SPAN>time<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1283"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1283">1283</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>setAttackTimer<SPAN class="p">(</SPAN>time<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1284"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1284">1284</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>taunt<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1285"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1285">1285</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1286"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1286">1286</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1287"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1287">1287</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L1288"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1288">1288</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Non-Class spells</SPAN></TD></TR><TR><TH id="L1289"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1289">1289</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - Done</SPAN></TD></TR><TR><TH id="L1290"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1290">1290</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L1291"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1291">1291</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L1292"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1292">1292</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Poultryizer</SPAN></TD></TR><TR><TH id="L1293"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1293">1293</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Turns the target into a chicken for 15 sec.&nbsp; &nbsp;Well, that is assuming the transmogrification polarity has not been reversed...</SPAN></TD></TR><TR><TH id="L1294"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1294">1294</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1295"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1295">1295</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">30507</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1296"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1296">1296</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1297"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1297">1297</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L1298"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1298">1298</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1299"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1299">1299</A></TH><TD></TR><TR><TH id="L1300"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1300">1300</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN><SPAN class="mi">30501</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1301"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1301">1301</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1302"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1302">1302</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L1303"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1303">1303</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Six Demon Bag</SPAN></TD></TR><TR><TH id="L1304"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1304">1304</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Blasts enemies in front of you with the power of wind, fire, all that kind of thing!</SPAN></TD></TR><TR><TH id="L1305"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1305">1305</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1306"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1306">1306</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">14537</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1307"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1307">1307</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1308"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1308">1308</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L1309"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1309">1309</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1310"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1310">1310</A></TH><TD></TR><TR><TH id="L1311"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1311">1311</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 ClearSpellId<SPAN class="p">[</SPAN><SPAN class="mi">6</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">{</SPAN>&nbsp;<SPAN class="mi">8401</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">8408</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">930</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">118</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">1680</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">10159</SPAN>&nbsp;<SPAN class="p">};</SPAN></TD></TR><TR><TH id="L1312"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1312">1312</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;min <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1313"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1313">1313</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 effect <SPAN class="o">=</SPAN>&nbsp;min <SPAN class="o">+</SPAN>&nbsp;<SPAN class="kt">int</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">((</SPAN><SPAN class="mi">6</SPAN><SPAN class="o">-</SPAN>min<SPAN class="p">)</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;rand<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="p">(</SPAN>RAND_MAX <SPAN class="o">+</SPAN>&nbsp;<SPAN class="mf">1.0</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1314"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1314">1314</A></TH><TD></TR><TR><TH id="L1315"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1315">1315</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;ClearSpellId<SPAN class="p">[</SPAN>effect<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1316"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1316">1316</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1317"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1317">1317</A></TH><TD></TR><TR><TH id="L1318"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1318">1318</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">30427</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Extract Gas</SPAN></TD></TR><TR><TH id="L1319"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1319">1319</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1320"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1320">1320</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;check <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1321"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1321">1321</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 cloudtype <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1322"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1322">1322</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>creature <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1323"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1323">1323</A></TH><TD></TR><TR><TH id="L1324"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1324">1324</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1325"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1325">1325</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1326"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1326">1326</A></TH><TD></TR><TR><TH id="L1327"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1327">1327</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>Object<SPAN class="o">::</SPAN>InRangeSet<SPAN class="o">::</SPAN>iterator i <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetInRangeSetBegin<SPAN class="p">();</SPAN>&nbsp;i <SPAN class="o">!=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetInRangeSetEnd<SPAN class="p">();</SPAN>&nbsp;<SPAN class="o">++</SPAN>i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1328"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1328">1328</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1329"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1329">1329</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_UNIT<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1330"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1330">1330</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1331"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1331">1331</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; creature<SPAN class="o">=</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature <SPAN class="o">*&gt;</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L1332"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1332">1332</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cloudtype<SPAN class="o">=</SPAN>creature<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1333"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1333">1333</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>cloudtype <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">24222</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;cloudtype <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">17408</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;cloudtype <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">17407</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;cloudtype <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">17378</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1334"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1334">1334</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1335"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1335">1335</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetDistance2dSq<SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">400</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1336"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1336">1336</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1337"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1337">1337</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetSelection<SPAN class="p">(</SPAN>creature<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L1338"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1338">1338</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; check <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1339"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1339">1339</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1340"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1340">1340</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1341"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1341">1341</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1342"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1342">1342</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1343"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1343">1343</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1344"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1344">1344</A></TH><TD></TR><TR><TH id="L1345"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1345">1345</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>check<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1346"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1346">1346</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1347"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1347">1347</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 item<SPAN class="p">,</SPAN>&nbsp;count <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1348"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1348">1348</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; item <SPAN class="o">=</SPAN>&nbsp;count <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="o">+</SPAN><SPAN class="p">(</SPAN>rand<SPAN class="p">()</SPAN><SPAN class="o">%</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1349"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1349">1349</A></TH><TD></TR><TR><TH id="L1350"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1350">1350</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>cloudtype<SPAN class="o">==</SPAN><SPAN class="mi">24222</SPAN><SPAN class="p">)</SPAN>&nbsp;item<SPAN class="o">=</SPAN><SPAN class="mi">22572</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//-air</SPAN></TD></TR><TR><TH id="L1351"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1351">1351</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>cloudtype<SPAN class="o">==</SPAN><SPAN class="mi">17408</SPAN><SPAN class="p">)</SPAN>&nbsp;item<SPAN class="o">=</SPAN><SPAN class="mi">22576</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//-mana</SPAN></TD></TR><TR><TH id="L1352"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1352">1352</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>cloudtype<SPAN class="o">==</SPAN><SPAN class="mi">17407</SPAN><SPAN class="p">)</SPAN>&nbsp;item<SPAN class="o">=</SPAN><SPAN class="mi">22577</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//-shadow</SPAN></TD></TR><TR><TH id="L1353"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1353">1353</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>cloudtype<SPAN class="o">==</SPAN><SPAN class="mi">17378</SPAN><SPAN class="p">)</SPAN>&nbsp;item<SPAN class="o">=</SPAN><SPAN class="mi">22578</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//-water</SPAN></TD></TR><TR><TH id="L1354"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1354">1354</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1355"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1355">1355</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Item <SPAN class="o">*</SPAN>add <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>FindItemLessMax<SPAN class="p">(</SPAN>item<SPAN class="p">,</SPAN>&nbsp;count<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1356"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1356">1356</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>add<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1357"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1357">1357</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1358"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1358">1358</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ItemPrototype<SPAN class="o">*</SPAN>&nbsp;proto <SPAN class="o">=</SPAN>&nbsp;ItemPrototypeStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>item<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1359"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1359">1359</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SlotResult slotresult<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1360"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1360">1360</A></TH><TD></TR><TR><TH id="L1361"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1361">1361</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slotresult <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>FindFreeInventorySlot<SPAN class="p">(</SPAN>proto<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1362"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1362">1362</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>slotresult<SPAN class="p">.</SPAN>Result<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1363"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1363">1363</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1364"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1364">1364</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>BuildInventoryChangeError<SPAN class="p">(</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;INV_ERR_INVENTORY_FULL<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1365"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1365">1365</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1366"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1366">1366</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1367"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1367">1367</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Item <SPAN class="o">*</SPAN>&nbsp;it<SPAN class="o">=</SPAN>objmgr<SPAN class="p">.</SPAN>CreateItem<SPAN class="p">(</SPAN>item<SPAN class="p">,</SPAN>p_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1368"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1368">1368</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>it<SPAN class="o">==</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1369"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1369">1369</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1370"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1370">1370</A></TH><TD></TR><TR><TH id="L1371"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1371">1371</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; it<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>&nbsp;ITEM_FIELD_STACK_COUNT<SPAN class="p">,</SPAN>&nbsp;count<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1372"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1372">1372</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SafeAddItem<SPAN class="p">(</SPAN>it<SPAN class="p">,</SPAN>slotresult<SPAN class="p">.</SPAN>ContainerSlot<SPAN class="p">,</SPAN>&nbsp;slotresult<SPAN class="p">.</SPAN>Slot<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1373"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1373">1373</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; creature<SPAN class="o">-&gt;</SPAN>Despawn<SPAN class="p">(</SPAN><SPAN class="mi">3500</SPAN><SPAN class="p">,</SPAN>creature<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>RespawnTime<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1374"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1374">1374</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1375"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1375">1375</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L1376"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1376">1376</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1377"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1377">1377</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add<SPAN class="o">-&gt;</SPAN>SetCount<SPAN class="p">(</SPAN>add<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>ITEM_FIELD_STACK_COUNT<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;count<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1378"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1378">1378</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add<SPAN class="o">-&gt;</SPAN>m_isDirty <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1379"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1379">1379</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; creature<SPAN class="o">-&gt;</SPAN>Despawn<SPAN class="p">(</SPAN><SPAN class="mi">3500</SPAN><SPAN class="p">,</SPAN>creature<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>RespawnTime<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1380"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1380">1380</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1381"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1381">1381</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1382"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1382">1382</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1383"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1383">1383</A></TH><TD></TR><TR><TH id="L1384"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1384">1384</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//curse of agony(18230) = periodic damage increased in</SPAN></TD></TR><TR><TH id="L1385"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1385">1385</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//flag 2031678</SPAN></TD></TR><TR><TH id="L1386"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1386">1386</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*&nbsp; &nbsp; &nbsp; case 34120:</SPAN></TD></TR><TR><TH id="L1387"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1387">1387</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {//steady shot</SPAN></TD></TR><TR><TH id="L1388"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1388">1388</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(unitTarget)</SPAN></TD></TR><TR><TH id="L1389"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1389">1389</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(unitTarget-&gt;IsDazed())</SPAN></TD></TR><TR><TH id="L1390"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1390">1390</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L1391"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1391">1391</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster-&gt;SpellNonMeleeDamageLog(unitTarget,spellId,damage,false);</SPAN></TD></TR><TR><TH id="L1392"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1392">1392</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster-&gt;SpellNonMeleeDamageLog(unitTarget,spellId,damage,pSpellId==0);</SPAN></TD></TR><TR><TH id="L1393"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1393">1393</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L1394"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1394">1394</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1395"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1395">1395</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }break;*/</SPAN></TD></TR><TR><TH id="L1396"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1396">1396</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">1454</SPAN><SPAN class="o">:</SPAN><SPAN class="c">//life tap</SPAN></TD></TR><TR><TH id="L1397"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1397">1397</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">1455</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1398"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1398">1398</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">1456</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1399"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1399">1399</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11687</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1400"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1400">1400</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11688</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1401"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1401">1401</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11689</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1402"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1402">1402</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27222</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1403"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1403">1403</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">57946</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1404"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1404">1404</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN><SPAN class="c">//converts base+1+spirit*x points of health into mana</SPAN></TD></TR><TR><TH id="L1405"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1405">1405</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1406"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1406">1406</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1407"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1407">1407</A></TH><TD></TR><TR><TH id="L1408"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1408">1408</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 mod<SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp;<SPAN class="c">// spirit bonus coefficient multiplied by 2</SPAN></TD></TR><TR><TH id="L1409"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1409">1409</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1454</SPAN><SPAN class="p">)</SPAN>&nbsp;mod <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1410"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1410">1410</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1455</SPAN><SPAN class="p">)</SPAN>&nbsp;mod <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1411"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1411">1411</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1456</SPAN><SPAN class="p">)</SPAN>&nbsp;mod <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">4</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1412"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1412">1412</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">11687</SPAN><SPAN class="p">)</SPAN>&nbsp;mod <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">5</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1413"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1413">1413</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;mod <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">6</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1414"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1414">1414</A></TH><TD></TR><TR><TH id="L1415"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1415">1415</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 damage <SPAN class="o">=</SPAN>&nbsp;m_spellInfo<SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;mod <SPAN class="o">*</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_STAT4<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1416"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1416">1416</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>damage <SPAN class="o">&gt;=</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_HEALTH<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L1417"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1417">1417</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1418"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1418">1418</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>DealDamage<SPAN class="p">(</SPAN>playerTarget<SPAN class="p">,</SPAN>damage<SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>spellId<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1419"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1419">1419</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; damage <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="mi">100</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>m_lifetapbonus<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp;<SPAN class="c">// Apply improved life tap</SPAN></TD></TR><TR><TH id="L1420"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1420">1420</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER1<SPAN class="p">)</SPAN><SPAN class="o">+</SPAN>damage <SPAN class="o">&gt;</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L1421"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1421">1421</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER1<SPAN class="p">,</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L1422"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1422">1422</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L1423"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1423">1423</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER1<SPAN class="p">,</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER1<SPAN class="p">)</SPAN><SPAN class="o">+</SPAN>damage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1424"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1424">1424</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendHealManaSpellOnPlayer<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;playerTarget<SPAN class="p">,</SPAN>&nbsp;damage<SPAN class="p">,</SPAN>&nbsp;POWER_TYPE_MANA<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1425"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1425">1425</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1426"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1426">1426</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">28730</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Arcane Torrent (Mana)</SPAN></TD></TR><TR><TH id="L1427"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1427">1427</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1428"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1428">1428</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// for each mana tap, gives you (2.17*level+9.136) mana</SPAN></TD></TR><TR><TH id="L1429"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1429">1429</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1430"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1430">1430</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1431"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1431">1431</A></TH><TD></TR><TR><TH id="L1432"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1432">1432</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>getClass<SPAN class="p">()</SPAN><SPAN class="o">==</SPAN>WARRIOR <SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>getClass<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;ROGUE<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1433"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1433">1433</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1434"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1434">1434</A></TH><TD></TR><TR><TH id="L1435"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1435">1435</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 count <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1436"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1436">1436</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 x <SPAN class="o">=</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_START<SPAN class="p">;</SPAN>&nbsp;x <SPAN class="o">&lt;</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_END<SPAN class="p">;</SPAN>&nbsp;<SPAN class="o">++</SPAN>x<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1437"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1437">1437</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">28734</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1438"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1438">1438</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1439"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1439">1439</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>Remove<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1440"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1440">1440</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">++</SPAN>count<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1441"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1441">1441</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1442"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1442">1442</A></TH><TD></TR><TR><TH id="L1443"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1443">1443</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 gain <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)(</SPAN>count <SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="mf">2.17</SPAN><SPAN class="o">*</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">()</SPAN><SPAN class="o">+</SPAN><SPAN class="mf">9.136</SPAN><SPAN class="p">));</SPAN></TD></TR><TR><TH id="L1444"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1444">1444</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>Energize<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">28730</SPAN><SPAN class="p">,</SPAN>&nbsp;gain<SPAN class="p">,</SPAN>&nbsp;POWER_TYPE_MANA <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1445"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1445">1445</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1446"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1446">1446</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">974</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1447"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1447">1447</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">32593</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1448"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1448">1448</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">32594</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1449"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1449">1449</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">49283</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1450"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1450">1450</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">49284</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1451"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1451">1451</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1452"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1452">1452</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>pSpellId<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1453"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1453">1453</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1454"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1454">1454</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>spellInfo <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>pSpellId<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1455"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1455">1455</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spellInfo<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1456"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1456">1456</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1457"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1457">1457</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 heal32 <SPAN class="o">=</SPAN>&nbsp;CalculateEffect<SPAN class="p">(</SPAN>i<SPAN class="p">,</SPAN>u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1458"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1458">1458</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1459"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1459">1459</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>heal32<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1460"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1460">1460</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Heal<SPAN class="p">(</SPAN>heal32<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1461"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1461">1461</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1462"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1462">1462</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">53385</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Divine Storm</SPAN></TD></TR><TR><TH id="L1463"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1463">1463</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1464"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1464">1464</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1465"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1465">1465</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Heal<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;spellId<SPAN class="p">,</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">0.25f</SPAN><SPAN class="p">));</SPAN></TD></TR><TR><TH id="L1466"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1466">1466</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1467"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1467">1467</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">39610</SPAN><SPAN class="o">:</SPAN><SPAN class="c">//Mana Tide</SPAN></TD></TR><TR><TH id="L1468"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1468">1468</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1469"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1469">1469</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget <SPAN class="o">==</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsDead<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>getClass<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;WARRIOR <SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>getClass<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;ROGUE<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1470"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1470">1470</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1471"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1471">1471</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 gain <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="mf">0.06</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1472"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1472">1472</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>Energize<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">16191</SPAN><SPAN class="p">,</SPAN>&nbsp;gain<SPAN class="p">,</SPAN>&nbsp;POWER_TYPE_MANA <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1473"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1473">1473</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1474"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1474">1474</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20425</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Judgement of Command</SPAN></TD></TR><TR><TH id="L1475"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1475">1475</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20961</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Judgement of Command</SPAN></TD></TR><TR><TH id="L1476"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1476">1476</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20962</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Judgement of Command</SPAN></TD></TR><TR><TH id="L1477"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1477">1477</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20967</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Judgement of Command</SPAN></TD></TR><TR><TH id="L1478"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1478">1478</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20968</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Judgement of Command</SPAN></TD></TR><TR><TH id="L1479"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1479">1479</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27172</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Judgement of Command</SPAN></TD></TR><TR><TH id="L1480"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1480">1480</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1481"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1481">1481</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 SpellID <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1482"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1482">1482</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>&nbsp;spell <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1483"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1483">1483</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1484"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1484">1484</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1485"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1485">1485</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>m_caster<SPAN class="p">,</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>SpellID<SPAN class="p">),</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1486"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1486">1486</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets targets<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1487"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1487">1487</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">.</SPAN>m_unitTarget <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1488"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1488">1488</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>targets<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1489"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1489">1489</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1490"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1490">1490</A></TH><TD></TR><TR><TH id="L1491"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1491">1491</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20577</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Cannibalize</SPAN></TD></TR><TR><TH id="L1492"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1492">1492</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1493"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1493">1493</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1494"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1494">1494</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1495"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1495">1495</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;check <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1496"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1496">1496</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;rad <SPAN class="o">=</SPAN>&nbsp;GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1497"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1497">1497</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rad <SPAN class="o">*=</SPAN>&nbsp;rad<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1498"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1498">1498</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>Object<SPAN class="o">::</SPAN>InRangeSet<SPAN class="o">::</SPAN>iterator i <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetInRangeSetBegin<SPAN class="p">();</SPAN>&nbsp;i <SPAN class="o">!=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetInRangeSetEnd<SPAN class="p">();</SPAN>&nbsp;<SPAN class="o">++</SPAN>i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1499"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1499">1499</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1500"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1500">1500</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_UNIT<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1501"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1501">1501</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1502"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1502">1502</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature <SPAN class="o">*&gt;</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">))</SPAN><SPAN class="o">-&gt;</SPAN>getDeathState<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;CORPSE<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1503"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1503">1503</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1504"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1504">1504</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>cn <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature <SPAN class="o">*&gt;</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">))</SPAN><SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1505"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1505">1505</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>cn <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;cn<SPAN class="o">-&gt;</SPAN>Type <SPAN class="o">==</SPAN>&nbsp;HUMANOID <SPAN class="o">||</SPAN>&nbsp;cn<SPAN class="o">-&gt;</SPAN>Type <SPAN class="o">==</SPAN>&nbsp;UNDEAD <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1506"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1506">1506</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1507"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1507">1507</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetDistance2dSq<SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">&lt;</SPAN>&nbsp;rad<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1508"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1508">1508</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1509"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1509">1509</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; check <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1510"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1510">1510</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1511"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1511">1511</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1512"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1512">1512</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1513"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1513">1513</A></TH><TD></TR><TR><TH id="L1514"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1514">1514</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1515"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1515">1515</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1516"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1516">1516</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1517"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1517">1517</A></TH><TD></TR><TR><TH id="L1518"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1518">1518</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>check<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1519"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1519">1519</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1520"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1520">1520</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>cannibalize <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1521"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1521">1521</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>cannibalizeCount <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1522"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1522">1522</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Player<SPAN class="o">::</SPAN>EventCannibalize<SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN><SPAN class="mi">7</SPAN><SPAN class="p">),</SPAN></TD></TR><TR><TH id="L1523"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1523">1523</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EVENT_CANNIBALIZE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">2000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">5</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1524"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1524">1524</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_NPC_EMOTESTATE<SPAN class="p">,</SPAN>&nbsp;EMOTE_STATE_CANNIBALIZE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1525"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1525">1525</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1526"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1526">1526</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1527"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1527">1527</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23074</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Arcanite Dragonling</SPAN></TD></TR><TR><TH id="L1528"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1528">1528</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23075</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Mithril Mechanical Dragonling</SPAN></TD></TR><TR><TH id="L1529"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1529">1529</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23076</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Mechanical Dragonling</SPAN></TD></TR><TR><TH id="L1530"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1530">1530</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23133</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Gnomish Battle Chicken</SPAN></TD></TR><TR><TH id="L1531"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1531">1531</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1532"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1532">1532</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 spell_id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1533"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1533">1533</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1534"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1534">1534</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1535"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1535">1535</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23074</SPAN><SPAN class="o">:</SPAN>&nbsp;spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">19804</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1536"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1536">1536</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23075</SPAN><SPAN class="o">:</SPAN>&nbsp;spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">12749</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1537"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1537">1537</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23076</SPAN><SPAN class="o">:</SPAN>&nbsp;spell_id <SPAN class="o">=</SPAN>&nbsp; <SPAN class="mi">4073</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1538"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1538">1538</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23133</SPAN><SPAN class="o">:</SPAN>&nbsp;spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">13166</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1539"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1539">1539</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1540"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1540">1540</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1541"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1541">1541</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1542"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1542">1542</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>spell_id<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1543"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1543">1543</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1544"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1544">1544</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23725</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Gift of Life</SPAN></TD></TR><TR><TH id="L1545"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1545">1545</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1546"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1546">1546</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1547"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1547">1547</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1548"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1548">1548</A></TH><TD></TR><TR><TH id="L1549"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1549">1549</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1550"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1550">1550</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tgt<SPAN class="p">.</SPAN>m_unitTarget <SPAN class="o">=</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1551"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1551">1551</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>&nbsp;inf <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">23782</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1552"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1552">1552</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>&nbsp;spe <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1553"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1553">1553</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spe<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1554"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1554">1554</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1555"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1555">1555</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spe<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>inf<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1556"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1556">1556</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spe<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>tgt<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1557"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1557">1557</A></TH><TD></TR><TR><TH id="L1558"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1558">1558</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1559"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1559">1559</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">12975</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Last Stand</SPAN></TD></TR><TR><TH id="L1560"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1560">1560</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1561"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1561">1561</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1562"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1562">1562</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1563"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1563">1563</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1564"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1564">1564</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tgt<SPAN class="p">.</SPAN>m_unitTarget <SPAN class="o">=</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1565"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1565">1565</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>&nbsp;inf <SPAN class="o">=</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">12976</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1566"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1566">1566</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>&nbsp;spe <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1567"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1567">1567</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spe<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1568"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1568">1568</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1569"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1569">1569</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spe<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>inf<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1570"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1570">1570</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spe<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>tgt<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1571"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1571">1571</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1572"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1572">1572</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*************************</SPAN></TD></TR><TR><TH id="L1573"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1573">1573</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Non-Class spells</SPAN></TD></TR><TR><TH id="L1574"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1574">1574</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - ToDo</SPAN></TD></TR><TR><TH id="L1575"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1575">1575</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *************************/</SPAN></TD></TR><TR><TH id="L1576"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1576">1576</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">6668</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Red Firework</SPAN></TD></TR><TR><TH id="L1577"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1577">1577</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1578"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1578">1578</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Shoots a firework into the air that bursts into a thousand red stars</SPAN></TD></TR><TR><TH id="L1579"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1579">1579</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1580"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1580">1580</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8344</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Universal Remote</SPAN></TD></TR><TR><TH id="L1581"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1581">1581</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1582"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1582">1582</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Allows control of a mechanical target for a short time.&nbsp; It may not always work and may just root the machine or make it very very angry.&nbsp; Gnomish engineering at its finest.</SPAN></TD></TR><TR><TH id="L1583"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1583">1583</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1584"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1584">1584</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">9976</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Polly Eats the E.C.A.C.</SPAN></TD></TR><TR><TH id="L1585"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1585">1585</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1586"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1586">1586</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME: Don't know what this does</SPAN></TD></TR><TR><TH id="L1587"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1587">1587</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1588"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1588">1588</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">10137</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Fizzule's Whistle</SPAN></TD></TR><TR><TH id="L1589"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1589">1589</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1590"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1590">1590</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Blow on the whistle to let Fizzule know you're an ally</SPAN></TD></TR><TR><TH id="L1591"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1591">1591</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//This item comes after a finish of quest at venture co.</SPAN></TD></TR><TR><TH id="L1592"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1592">1592</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//You must whistle this every time you reach there to make Fizzule</SPAN></TD></TR><TR><TH id="L1593"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1593">1593</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//ally to you.</SPAN></TD></TR><TR><TH id="L1594"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1594">1594</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1595"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1595">1595</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11540</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Blue Firework</SPAN></TD></TR><TR><TH id="L1596"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1596">1596</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1597"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1597">1597</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Shoots a firework into the air that bursts into a thousand blue stars</SPAN></TD></TR><TR><TH id="L1598"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1598">1598</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1599"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1599">1599</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11541</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Green Firework</SPAN></TD></TR><TR><TH id="L1600"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1600">1600</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1601"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1601">1601</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Shoots a firework into the air that bursts into a thousand green stars</SPAN></TD></TR><TR><TH id="L1602"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1602">1602</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1603"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1603">1603</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11542</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Red Streaks Firework</SPAN></TD></TR><TR><TH id="L1604"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1604">1604</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1605"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1605">1605</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Shoots a firework into the air that bursts into a thousand red streaks</SPAN></TD></TR><TR><TH id="L1606"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1606">1606</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1607"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1607">1607</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11543</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Red, White and Blue Firework</SPAN></TD></TR><TR><TH id="L1608"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1608">1608</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1609"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1609">1609</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Shoots a firework into the air that bursts into red, white and blue stars</SPAN></TD></TR><TR><TH id="L1610"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1610">1610</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1611"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1611">1611</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11544</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Yellow Rose Firework</SPAN></TD></TR><TR><TH id="L1612"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1612">1612</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1613"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1613">1613</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Shoots a firework into the air that bursts in a yellow pattern</SPAN></TD></TR><TR><TH id="L1614"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1614">1614</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1615"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1615">1615</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">12151</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Summon Atal'ai Skeleton</SPAN></TD></TR><TR><TH id="L1616"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1616">1616</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1617"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1617">1617</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//8324&nbsp; Atal'ai Skeleton</SPAN></TD></TR><TR><TH id="L1618"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1618">1618</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1619"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1619">1619</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Add here remove in time event</SPAN></TD></TR><TR><TH id="L1620"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1620">1620</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1621"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1621">1621</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">13006</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Shrink Ray</SPAN></TD></TR><TR><TH id="L1622"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1622">1622</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1623"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1623">1623</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Schematic is learned from the gnomish engineering trainer. The gnomish/gobblin engineering decision is made when you are lvl40+ and your engineering is 200+. Interestingly, however, when this item fails to shrink the target, it can do a variety of things, such as...</SPAN></TD></TR><TR><TH id="L1624"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1624">1624</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//-Make you bigger (attack power +250)</SPAN></TD></TR><TR><TH id="L1625"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1625">1625</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//-Make you smaller (attack power -250)</SPAN></TD></TR><TR><TH id="L1626"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1626">1626</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//-Make them bigger (same effect as above)</SPAN></TD></TR><TR><TH id="L1627"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1627">1627</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//-Make your entire party bigger</SPAN></TD></TR><TR><TH id="L1628"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1628">1628</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//-Make your entire party smaller</SPAN></TD></TR><TR><TH id="L1629"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1629">1629</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//-Make every attacking enemy bigger</SPAN></TD></TR><TR><TH id="L1630"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1630">1630</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//-Make ever attacking enemy smaller</SPAN></TD></TR><TR><TH id="L1631"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1631">1631</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Works to your advantage for the most part (about 70% of the time), but don't use in high-pressure situations, unless you're going to die if you don't. Could tip the scales the wrong way.</SPAN></TD></TR><TR><TH id="L1632"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1632">1632</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Search for spells of this</SPAN></TD></TR><TR><TH id="L1633"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1633">1633</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1634"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1634">1634</A></TH><TD></TR><TR><TH id="L1635"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1635">1635</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//13004 - grow &lt;- this one</SPAN></TD></TR><TR><TH id="L1636"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1636">1636</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//13010 - shrink &lt;-this one</SPAN></TD></TR><TR><TH id="L1637"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1637">1637</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//</SPAN></TD></TR><TR><TH id="L1638"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1638">1638</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1639"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1639">1639</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">13180</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Gnomish Mind Control Cap</SPAN></TD></TR><TR><TH id="L1640"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1640">1640</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1641"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1641">1641</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// FIXME:Take control of humanoid target by chance(it can be player)</SPAN></TD></TR><TR><TH id="L1642"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1642">1642</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1643"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1643">1643</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">13278</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Gnomish Death Ray</SPAN></TD></TR><TR><TH id="L1644"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1644">1644</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1645"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1645">1645</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// FIXME:The devices charges over time using your life force and then directs a burst of energy at your opponent</SPAN></TD></TR><TR><TH id="L1646"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1646">1646</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Drops life</SPAN></TD></TR><TR><TH id="L1647"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1647">1647</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1648"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1648">1648</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">13280</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Gnomish Death Ray</SPAN></TD></TR><TR><TH id="L1649"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1649">1649</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1650"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1650">1650</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME: Drop life</SPAN></TD></TR><TR><TH id="L1651"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1651">1651</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1652"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1652">1652</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">17816</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Sharp Dresser</SPAN></TD></TR><TR><TH id="L1653"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1653">1653</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1654"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1654">1654</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Impress others with your fashion sense</SPAN></TD></TR><TR><TH id="L1655"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1655">1655</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1656"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1656">1656</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">21343</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Snowball</SPAN></TD></TR><TR><TH id="L1657"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1657">1657</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1658"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1658">1658</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1659"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1659">1659</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23645</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Hourglass Sand</SPAN></TD></TR><TR><TH id="L1660"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1660">1660</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1661"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1661">1661</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Indeed used at the Chromo fight in BWL. Chromo has a stunning debuff, uncleansable, unless you have hourglass sand. This debuff will stun you every 4 seconds, for 4 seconds. It is resisted a lot though. Mage's and other casters usually have to do this fight with the debuff on, healers, tanks and hunters will get some to cure themselves from the debuff</SPAN></TD></TR><TR><TH id="L1662"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1662">1662</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1663"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1663">1663</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">24325</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Pagle's Point Cast - Create Mudskunk Lure</SPAN></TD></TR><TR><TH id="L1664"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1664">1664</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1665"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1665">1665</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Load with 5 Zulian Mudskunks, and then cast from Pagle's Point in Zul'Gurub</SPAN></TD></TR><TR><TH id="L1666"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1666">1666</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1667"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1667">1667</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">24392</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Frosty Zap</SPAN></TD></TR><TR><TH id="L1668"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1668">1668</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1669"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1669">1669</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Your Frostbolt spells have a 6% chance to restore 50 mana when cast.</SPAN></TD></TR><TR><TH id="L1670"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1670">1670</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//damage == 50</SPAN></TD></TR><TR><TH id="L1671"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1671">1671</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1672"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1672">1672</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">25822</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Firecrackers</SPAN></TD></TR><TR><TH id="L1673"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1673">1673</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1674"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1674">1674</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Find firecrackers</SPAN></TD></TR><TR><TH id="L1675"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1675">1675</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1676"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1676">1676</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">26373</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Lunar Invititation</SPAN></TD></TR><TR><TH id="L1677"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1677">1677</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1678"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1678">1678</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME: Teleports the caster from within Greater Moonlight</SPAN></TD></TR><TR><TH id="L1679"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1679">1679</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1680"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1680">1680</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">26374</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Elune's Candle</SPAN></TD></TR><TR><TH id="L1681"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1681">1681</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1682"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1682">1682</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Shoots a firework at target</SPAN></TD></TR><TR><TH id="L1683"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1683">1683</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1684"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1684">1684</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">26889</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Give Friendship Bracelet</SPAN></TD></TR><TR><TH id="L1685"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1685">1685</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1686"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1686">1686</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Give to a Heartbroken player to cheer them up</SPAN></TD></TR><TR><TH id="L1687"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1687">1687</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//laugh emote</SPAN></TD></TR><TR><TH id="L1688"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1688">1688</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1689"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1689">1689</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27662</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Throw Cupid's Dart</SPAN></TD></TR><TR><TH id="L1690"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1690">1690</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1691"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1691">1691</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Shoot a player, and Kwee Q. Peddlefeet will find them! (Only works on players with no current critter pets.)</SPAN></TD></TR><TR><TH id="L1692"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1692">1692</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1693"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1693">1693</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">28414</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Call Ashbringer</SPAN></TD></TR><TR><TH id="L1694"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1694">1694</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1695"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1695">1695</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//http://www.thottbot.com/?i=53974</SPAN></TD></TR><TR><TH id="L1696"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1696">1696</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1697"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1697">1697</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">28806</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Toss Fuel on Bonfire</SPAN></TD></TR><TR><TH id="L1698"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1698">1698</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1699"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1699">1699</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Dont know what this dummy does</SPAN></TD></TR><TR><TH id="L1700"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1700">1700</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1701"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1701">1701</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">7669</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Bethor's Potion</SPAN></TD></TR><TR><TH id="L1702"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1702">1702</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1703"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1703">1703</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// related to Hex of Ravenclaw,</SPAN></TD></TR><TR><TH id="L1704"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1704">1704</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// its a dispell spell.</SPAN></TD></TR><TR><TH id="L1705"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1705">1705</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Dont know whats the usage of this dummy</SPAN></TD></TR><TR><TH id="L1706"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1706">1706</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1707"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1707">1707</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8283</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Snufflenose Command</SPAN></TD></TR><TR><TH id="L1708"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1708">1708</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1709"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1709">1709</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Quest Blueleaf Tubers</SPAN></TD></TR><TR><TH id="L1710"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1710">1710</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//For use on a Snufflenose Gopher</SPAN></TD></TR><TR><TH id="L1711"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1711">1711</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1712"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1712">1712</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8913</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Sacred Cleansing</SPAN></TD></TR><TR><TH id="L1713"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1713">1713</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1714"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1714">1714</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Removes the protective enchantments around Morbent Fel</SPAN></TD></TR><TR><TH id="L1715"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1715">1715</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Morbent Fel</SPAN></TD></TR><TR><TH id="L1716"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1716">1716</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1717"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1717">1717</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">9962</SPAN><SPAN class="o">:</SPAN><SPAN class="c">//Capture Treant</SPAN></TD></TR><TR><TH id="L1718"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1718">1718</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1719"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1719">1719</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Treant Muisek</SPAN></TD></TR><TR><TH id="L1720"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1720">1720</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1721"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1721">1721</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">10113</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Flare Gun's flare</SPAN></TD></TR><TR><TH id="L1722"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1722">1722</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1723"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1723">1723</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Quest Deep Cover</SPAN></TD></TR><TR><TH id="L1724"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1724">1724</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//1543 may need to cast this</SPAN></TD></TR><TR><TH id="L1725"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1725">1725</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//2 flares and the /salute</SPAN></TD></TR><TR><TH id="L1726"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1726">1726</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1727"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1727">1727</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">10617</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Release Rageclaw</SPAN></TD></TR><TR><TH id="L1728"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1728">1728</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1729"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1729">1729</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Druid of the Claw</SPAN></TD></TR><TR><TH id="L1730"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1730">1730</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Use on the fallen body of Rageclaw</SPAN></TD></TR><TR><TH id="L1731"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1731">1731</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1732"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1732">1732</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11402</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Shay's Bell</SPAN></TD></TR><TR><TH id="L1733"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1733">1733</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1734"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1734">1734</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Quest Wandering Shay</SPAN></TD></TR><TR><TH id="L1735"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1735">1735</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Ring to call Shay back to you</SPAN></TD></TR><TR><TH id="L1736"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1736">1736</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1737"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1737">1737</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11548</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Summon Spider God</SPAN></TD></TR><TR><TH id="L1738"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1738">1738</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1739"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1739">1739</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Quest Summoning Shadra&nbsp; (Elite)</SPAN></TD></TR><TR><TH id="L1740"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1740">1740</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Use at the Shadra'Alor Altar to summon the spider god</SPAN></TD></TR><TR><TH id="L1741"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1741">1741</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1742"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1742">1742</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11610</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Gammerita Turtle Camera</SPAN></TD></TR><TR><TH id="L1743"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1743">1743</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1744"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1744">1744</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest The Super Snapper FX</SPAN></TD></TR><TR><TH id="L1745"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1745">1745</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1746"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1746">1746</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11886</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Capture Wildkin</SPAN></TD></TR><TR><TH id="L1747"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1747">1747</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1748"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1748">1748</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Testing the Vessel</SPAN></TD></TR><TR><TH id="L1749"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1749">1749</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Shrink and Capture a Fallen Wildkin</SPAN></TD></TR><TR><TH id="L1750"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1750">1750</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1751"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1751">1751</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11887</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Capture Hippogryph</SPAN></TD></TR><TR><TH id="L1752"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1752">1752</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1753"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1753">1753</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Same with 11888</SPAN></TD></TR><TR><TH id="L1754"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1754">1754</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Hippogryph Muisek</SPAN></TD></TR><TR><TH id="L1755"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1755">1755</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1756"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1756">1756</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11888</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Capture Faerie Dragon</SPAN></TD></TR><TR><TH id="L1757"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1757">1757</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1758"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1758">1758</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Check Faerie Dragon Muisek is killed or not if its killed update quest</SPAN></TD></TR><TR><TH id="L1759"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1759">1759</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//And allow create of fearie Dragon which is effect 1</SPAN></TD></TR><TR><TH id="L1760"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1760">1760</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest: Faerie Dragon Muisek</SPAN></TD></TR><TR><TH id="L1761"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1761">1761</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1762"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1762">1762</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11889</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Capture Mountain Giant</SPAN></TD></TR><TR><TH id="L1763"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1763">1763</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1764"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1764">1764</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Same with 11888</SPAN></TD></TR><TR><TH id="L1765"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1765">1765</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest: Mountain Giant Muisek</SPAN></TD></TR><TR><TH id="L1766"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1766">1766</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1767"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1767">1767</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">12189</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Summon Echeyakee</SPAN></TD></TR><TR><TH id="L1768"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1768">1768</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1769"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1769">1769</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//3475&nbsp; Echeyakee</SPAN></TD></TR><TR><TH id="L1770"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1770">1770</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1771"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1771">1771</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Quest Echeyakee</SPAN></TD></TR><TR><TH id="L1772"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1772">1772</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1773"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1773">1773</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">12283</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Xiggs Signal Flare</SPAN></TD></TR><TR><TH id="L1774"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1774">1774</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1775"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1775">1775</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Signal for Pickup</SPAN></TD></TR><TR><TH id="L1776"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1776">1776</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//To be used at the makeshift helipad in Azshara. It will summon Pilot Xiggs Fuselighter to pick up the tablet rubbings</SPAN></TD></TR><TR><TH id="L1777"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1777">1777</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1778"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1778">1778</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">12938</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Fel Curse</SPAN></TD></TR><TR><TH id="L1779"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1779">1779</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1780"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1780">1780</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Makes near target killable(servants of Razelikh the Defiler)</SPAN></TD></TR><TR><TH id="L1781"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1781">1781</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1782"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1782">1782</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">14247</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Blazerunner Dispel</SPAN></TD></TR><TR><TH id="L1783"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1783">1783</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1784"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1784">1784</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Quest Aquementas and some more</SPAN></TD></TR><TR><TH id="L1785"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1785">1785</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1786"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1786">1786</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">14250</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Capture Grark</SPAN></TD></TR><TR><TH id="L1787"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1787">1787</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1788"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1788">1788</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Precarious Predicament</SPAN></TD></TR><TR><TH id="L1789"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1789">1789</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1790"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1790">1790</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">14813</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Rocknot's Ale</SPAN></TD></TR><TR><TH id="L1791"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1791">1791</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1792"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1792">1792</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//you throw the mug</SPAN></TD></TR><TR><TH id="L1793"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1793">1793</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//and the guy gets pissed well everyone gets pissed and he crushes the door so you can get past</SPAN></TD></TR><TR><TH id="L1794"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1794">1794</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//maybe after like 30 seconds so you can get past.&nbsp; but lke I said I have never done it myself</SPAN></TD></TR><TR><TH id="L1795"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1795">1795</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//so i am not 100% sure what happens.</SPAN></TD></TR><TR><TH id="L1796"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1796">1796</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1797"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1797">1797</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">15991</SPAN><SPAN class="o">:</SPAN><SPAN class="c">//Revive Ringo</SPAN></TD></TR><TR><TH id="L1798"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1798">1798</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1799"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1799">1799</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest A Little Help From My Friends</SPAN></TD></TR><TR><TH id="L1800"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1800">1800</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Revive Ringo with water</SPAN></TD></TR><TR><TH id="L1801"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1801">1801</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1802"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1802">1802</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">15998</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Capture Worg Pup</SPAN></TD></TR><TR><TH id="L1803"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1803">1803</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1804"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1804">1804</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Ends Kibler's Exotic Pets&nbsp; (Dungeon) quest</SPAN></TD></TR><TR><TH id="L1805"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1805">1805</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1806"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1806">1806</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">16031</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Releasing Corrupt Ooze</SPAN></TD></TR><TR><TH id="L1807"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1807">1807</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1808"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1808">1808</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Released ooze moves to master ooze and "Merged Ooze Sample"</SPAN></TD></TR><TR><TH id="L1809"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1809">1809</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//occurs after some time.This item helps to finish quest</SPAN></TD></TR><TR><TH id="L1810"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1810">1810</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1811"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1811">1811</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">16378</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Temperature Reading</SPAN></TD></TR><TR><TH id="L1812"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1812">1812</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1813"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1813">1813</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Quest Finding the Source</SPAN></TD></TR><TR><TH id="L1814"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1814">1814</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Take a reading of the temperature at a hot spot.</SPAN></TD></TR><TR><TH id="L1815"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1815">1815</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1816"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1816">1816</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">17166</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Release Umi's Yeti</SPAN></TD></TR><TR><TH id="L1817"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1817">1817</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1818"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1818">1818</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Are We There, Yeti?</SPAN></TD></TR><TR><TH id="L1819"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1819">1819</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Select Umi's friend and click to release the Mechanical Yeti</SPAN></TD></TR><TR><TH id="L1820"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1820">1820</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1821"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1821">1821</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">17271</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Test Fetid Skull</SPAN></TD></TR><TR><TH id="L1822"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1822">1822</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1823"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1823">1823</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Marauders of Darrowshire</SPAN></TD></TR><TR><TH id="L1824"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1824">1824</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Wave over a Fetid skull to test its resonance</SPAN></TD></TR><TR><TH id="L1825"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1825">1825</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1826"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1826">1826</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">18153</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Kodo Kombobulator</SPAN></TD></TR><TR><TH id="L1827"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1827">1827</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1828"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1828">1828</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Kodo Roundup Quest</SPAN></TD></TR><TR><TH id="L1829"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1829">1829</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Kodo Kombobulator on any Ancient, Aged, or Dying Kodo to lure the Kodo to follow (one at a time)</SPAN></TD></TR><TR><TH id="L1830"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1830">1830</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1831"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1831">1831</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">19250</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Placing Smokey's Explosives</SPAN></TD></TR><TR><TH id="L1832"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1832">1832</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1833"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1833">1833</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//This is something related to quest i think</SPAN></TD></TR><TR><TH id="L1834"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1834">1834</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1835"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1835">1835</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">19512</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Apply Salve</SPAN></TD></TR><TR><TH id="L1836"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1836">1836</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1837"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1837">1837</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Cure a sickly animal afflicted by the taint of poisoning</SPAN></TD></TR><TR><TH id="L1838"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1838">1838</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1839"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1839">1839</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20804</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Triage</SPAN></TD></TR><TR><TH id="L1840"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1840">1840</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1841"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1841">1841</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Triage</SPAN></TD></TR><TR><TH id="L1842"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1842">1842</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Use on Injured, Badly Injured, and Critically Injured Soldiers</SPAN></TD></TR><TR><TH id="L1843"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1843">1843</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1844"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1844">1844</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">21050</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Melodious Rapture</SPAN></TD></TR><TR><TH id="L1845"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1845">1845</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1846"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1846">1846</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Deeprun Rat Roundup</SPAN></TD></TR><TR><TH id="L1847"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1847">1847</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1848"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1848">1848</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">21332</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Aspect of Neptulon</SPAN></TD></TR><TR><TH id="L1849"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1849">1849</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1850"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1850">1850</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Used on plagued water elementals in Eastern Plaguelands</SPAN></TD></TR><TR><TH id="L1851"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1851">1851</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest:Poisoned Water</SPAN></TD></TR><TR><TH id="L1852"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1852">1852</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1853"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1853">1853</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">21960</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Manifest Spirit</SPAN></TD></TR><TR><TH id="L1854"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1854">1854</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1855"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1855">1855</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//FIXME:Forces the spirits of the first centaur Kahns to manifest in the physical world</SPAN></TD></TR><TR><TH id="L1856"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1856">1856</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//thats a quest</SPAN></TD></TR><TR><TH id="L1857"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1857">1857</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//its for maraudon i think</SPAN></TD></TR><TR><TH id="L1858"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1858">1858</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//u use that on the spirit mobs</SPAN></TD></TR><TR><TH id="L1859"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1859">1859</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//to release them</SPAN></TD></TR><TR><TH id="L1860"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1860">1860</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1861"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1861">1861</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23359</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Transmogrify!</SPAN></TD></TR><TR><TH id="L1862"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1862">1862</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1863"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1863">1863</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Quest Zapped Giants</SPAN></TD></TR><TR><TH id="L1864"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1864">1864</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Zap a Feralas giant into a more manageable form</SPAN></TD></TR><TR><TH id="L1865"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1865">1865</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1866"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1866">1866</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27184</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Summon Mor Grayhoof</SPAN></TD></TR><TR><TH id="L1867"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1867">1867</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1868"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1868">1868</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//16044 Mor Grayhoof Trigger</SPAN></TD></TR><TR><TH id="L1869"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1869">1869</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//16080 Mor Grayhoof</SPAN></TD></TR><TR><TH id="L1870"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1870">1870</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1871"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1871">1871</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Related to quests The Left Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1872"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1872">1872</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//and The Right Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1873"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1873">1873</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1874"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1874">1874</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27190</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Summon Isalien</SPAN></TD></TR><TR><TH id="L1875"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1875">1875</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1876"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1876">1876</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//16045 Isalien Trigger</SPAN></TD></TR><TR><TH id="L1877"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1877">1877</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//16097 Isalien</SPAN></TD></TR><TR><TH id="L1878"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1878">1878</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1879"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1879">1879</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Related to quests The Left Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1880"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1880">1880</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//and The Right Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1881"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1881">1881</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1882"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1882">1882</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27191</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Summon the remains of Jarien and Sothos</SPAN></TD></TR><TR><TH id="L1883"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1883">1883</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1884"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1884">1884</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L1885"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1885">1885</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16046&nbsp; &nbsp;Jarien and Sothos Trigger</SPAN></TD></TR><TR><TH id="L1886"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1886">1886</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16101&nbsp; &nbsp;Jarien</SPAN></TD></TR><TR><TH id="L1887"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1887">1887</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16103&nbsp; &nbsp;Spirit of Jarien</SPAN></TD></TR><TR><TH id="L1888"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1888">1888</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1889"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1889">1889</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16102&nbsp; &nbsp;Sothos</SPAN></TD></TR><TR><TH id="L1890"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1890">1890</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16104&nbsp; &nbsp;Spirit of Sothos</SPAN></TD></TR><TR><TH id="L1891"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1891">1891</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1892"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1892">1892</A></TH><TD></TR><TR><TH id="L1893"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1893">1893</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Related to quests The Left Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1894"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1894">1894</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//and The Right Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1895"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1895">1895</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1896"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1896">1896</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27201</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Summon the spirit of Kormok</SPAN></TD></TR><TR><TH id="L1897"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1897">1897</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1898"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1898">1898</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*16047 Kormok Trigger</SPAN></TD></TR><TR><TH id="L1899"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1899">1899</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16118&nbsp; &nbsp;Kormok</SPAN></TD></TR><TR><TH id="L1900"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1900">1900</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1901"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1901">1901</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Related to quests The Left Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1902"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1902">1902</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//and The Right Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1903"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1903">1903</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1904"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1904">1904</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27202</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Summon Lord Valthalak</SPAN></TD></TR><TR><TH id="L1905"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1905">1905</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1906"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1906">1906</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L1907"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1907">1907</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16042&nbsp; &nbsp;Lord Valthalak</SPAN></TD></TR><TR><TH id="L1908"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1908">1908</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16048&nbsp; &nbsp;Lord Valthalak Trigger</SPAN></TD></TR><TR><TH id="L1909"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1909">1909</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16073&nbsp; &nbsp;Spirit of Lord Valthalak</SPAN></TD></TR><TR><TH id="L1910"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1910">1910</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L1911"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1911">1911</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L1912"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1912">1912</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Related to quests The Left Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1913"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1913">1913</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//and The Right Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1914"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1914">1914</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1915"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1915">1915</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27203</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Summon the spirits of the dead at haunted locations</SPAN></TD></TR><TR><TH id="L1916"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1916">1916</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1917"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1917">1917</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Related to quests The Left Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1918"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1918">1918</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//and The Right Piece of Lord Valthalak's Amulet&nbsp; (Dungeon)</SPAN></TD></TR><TR><TH id="L1919"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1919">1919</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1920"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1920">1920</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27517</SPAN><SPAN class="o">:</SPAN><SPAN class="c">// Use this banner at the Arena in Blackrock Depths to challenge Theldren</SPAN></TD></TR><TR><TH id="L1921"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1921">1921</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1922"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1922">1922</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//This is used to make Theldren spawn at the place where it used</SPAN></TD></TR><TR><TH id="L1923"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1923">1923</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//I couldnt find theldrin, and his men in creature names database</SPAN></TD></TR><TR><TH id="L1924"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1924">1924</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Someone has to write this and this is related to The Challange quest</SPAN></TD></TR><TR><TH id="L1925"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1925">1925</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*By moving to the center grate, you trigger the arena event.</SPAN></TD></TR><TR><TH id="L1926"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1926">1926</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A random group of mobs (spiders, worms, bats, raptors) spawns,</SPAN></TD></TR><TR><TH id="L1927"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1927">1927</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and you have to kill them. After the last one dies, and a small</SPAN></TD></TR><TR><TH id="L1928"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1928">1928</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break, a boss mob spawns. Successfully completing this event</SPAN></TD></TR><TR><TH id="L1929"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1929">1929</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; turns the arena spectators from red to yellow*/</SPAN></TD></TR><TR><TH id="L1930"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1930">1930</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1931"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1931">1931</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">29858</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Soulshatter</SPAN></TD></TR><TR><TH id="L1932"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1932">1932</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1933"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1933">1933</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1934"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1934">1934</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1935"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1935">1935</A></TH><TD></TR><TR><TH id="L1936"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1936">1936</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">32835</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1937"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1937">1937</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1938"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1938">1938</A></TH><TD></TR><TR><TH id="L1939"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1939">1939</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/***Death Coil DK***/</SPAN></TD></TR><TR><TH id="L1940"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1940">1940</A></TH><TD></TR><TR><TH id="L1941"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1941">1941</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">52375</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1942"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1942">1942</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">49892</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1943"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1943">1943</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">49893</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1944"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1944">1944</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">49894</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1945"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1945">1945</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">49895</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L1946"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1946">1946</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1947"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1947">1947</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1948"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1948">1948</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1949"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1949">1949</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>spellId <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">52375</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1950"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1950">1950</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; damage <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">2</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">5</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1951"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1951">1951</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>isAttackable<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L1952"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1952">1952</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>SpellNonMeleeDamageLog<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;spellId<SPAN class="p">,</SPAN>&nbsp;damage<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L1953"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1953">1953</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsCreature<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L1954"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1954">1954</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1955"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1955">1955</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Creature<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L1956"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1956">1956</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>ci <SPAN class="o">&amp;&amp;</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Type <SPAN class="o">==</SPAN>&nbsp;UNDEAD<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1957"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1957">1957</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Heal<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;spellId<SPAN class="p">,</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">1.5f</SPAN><SPAN class="p">));</SPAN></TD></TR><TR><TH id="L1958"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1958">1958</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1959"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1959">1959</A></TH><TD></TR><TR><TH id="L1960"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1960">1960</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1961"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1961">1961</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1962"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1962">1962</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1963"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1963">1963</A></TH><TD></TR><TR><TH id="L1964"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1964">1964</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectTeleportUnits<SPAN class="p">(</SPAN>&nbsp;uint32 i <SPAN class="p">)</SPAN>&nbsp; <SPAN class="c">// Teleport Units</SPAN></TD></TR><TR><TH id="L1965"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1965">1965</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1966"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1966">1966</A></TH><TD></TR><TR><TH id="L1967"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1967">1967</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1968"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1968">1968</A></TH><TD></TR><TR><TH id="L1969"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1969">1969</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 spellId <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1970"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1970">1970</A></TH><TD></TR><TR><TH id="L1971"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1971">1971</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Try a dummy SpellHandler</SPAN></TD></TR><TR><TH id="L1972"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1972">1972</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;sScriptMgr<SPAN class="p">.</SPAN>CallScriptedDummySpell<SPAN class="p">(</SPAN>&nbsp;spellId<SPAN class="p">,</SPAN>&nbsp;i<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1973"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1973">1973</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1974"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1974">1974</A></TH><TD></TR><TR><TH id="L1975"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1975">1975</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Shadowstep</SPAN></TD></TR><TR><TH id="L1976"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1976">1976</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_SHADOWSTEP <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1977"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1977">1977</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1978"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1978">1978</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* this is rather tricky actually. we have to calculate the orientation of the creature/player, and then calculate a little bit of distance behind that. */</SPAN></TD></TR><TR><TH id="L1979"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1979">1979</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;ang<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1980"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1980">1980</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="o">==</SPAN>&nbsp;m_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1981"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1981">1981</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1982"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1982">1982</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* try to get a selection */</SPAN></TD></TR><TR><TH id="L1983"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1983">1983</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetUnit<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetSelection<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L1984"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1984">1984</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( (unitTarget == NULL ) || !isHostile(p_caster, unitTarget) || (unitTarget-&gt;CalcDistance(p_caster) &gt; 25.0f)) //removed by Zack : no idea why hostile is used. Isattackable should give a wider solution range</SPAN></TD></TR><TR><TH id="L1985"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1985">1985</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>isAttackable<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">!</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>c_is_flags <SPAN class="o">&amp;</SPAN>&nbsp;SPELL_FLAG_IS_TARGETINGSTEALTHED<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>CalcDistance<SPAN class="p">(</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mf">28.0f</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L1986"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1986">1986</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1987"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1987">1987</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1988"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1988">1988</A></TH><TD></TR><TR><TH id="L1989"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1989">1989</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_UNIT <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1990"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1990">1990</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1991"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1991">1991</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt64Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_TARGET <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L1992"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1992">1992</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L1993"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1993">1993</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* We're chasing a target. We have to calculate the angle to this target, this is our orientation. */</SPAN></TD></TR><TR><TH id="L1994"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1994">1994</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ang <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>calcAngle<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L1995"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1995">1995</A></TH><TD></TR><TR><TH id="L1996"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1996">1996</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* convert degree angle to radians */</SPAN></TD></TR><TR><TH id="L1997"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1997">1997</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ang <SPAN class="o">=</SPAN>&nbsp;ang <SPAN class="o">*</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>M_PI<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mf">180.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L1998"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1998">1998</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L1999"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L1999">1999</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2000"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2000">2000</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2001"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2001">2001</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* Our orientation has already been set. */</SPAN></TD></TR><TR><TH id="L2002"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2002">2002</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ang <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2003"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2003">2003</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2004"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2004">2004</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2005"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2005">2005</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2006"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2006">2006</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2007"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2007">2007</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* Players orientation is sent in movement packets */</SPAN></TD></TR><TR><TH id="L2008"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2008">2008</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ang <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2009"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2009">2009</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2010"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2010">2010</A></TH><TD></TR><TR><TH id="L2011"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2011">2011</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// avoid teleporting into the model on scaled models</SPAN></TD></TR><TR><TH id="L2012"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2012">2012</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">const</SPAN>&nbsp;<SPAN class="k">static</SPAN>&nbsp;<SPAN class="kt">float</SPAN>&nbsp;shadowstep_distance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mf">1.6f</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>OBJECT_FIELD_SCALE_X<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2013"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2013">2013</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;new_x <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;<SPAN class="p">(</SPAN>shadowstep_distance <SPAN class="o">*</SPAN>&nbsp;cosf<SPAN class="p">(</SPAN>ang<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L2014"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2014">2014</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;new_y <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;<SPAN class="p">(</SPAN>shadowstep_distance <SPAN class="o">*</SPAN>&nbsp;sinf<SPAN class="p">(</SPAN>ang<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L2015"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2015">2015</A></TH><TD></TR><TR><TH id="L2016"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2016">2016</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* Send a movement packet to "charge" at this target. Similar to warrior charge. */</SPAN></TD></TR><TR><TH id="L2017"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2017">2017</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>z_axisposition <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2018"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2018">2018</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SafeTeleport<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">(),</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">(),</SPAN>&nbsp;LocationVector<SPAN class="p">(</SPAN>new_x<SPAN class="p">,</SPAN>&nbsp;new_y<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="mf">0.1f</SPAN><SPAN class="p">),</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">()));</SPAN></TD></TR><TR><TH id="L2019"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2019">2019</A></TH><TD></TR><TR><TH id="L2020"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2020">2020</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2021"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2021">2021</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2022"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2022">2022</A></TH><TD></TR><TR><TH id="L2023"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2023">2023</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* TODO: Remove Player From bg */</SPAN></TD></TR><TR><TH id="L2024"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2024">2024</A></TH><TD></TR><TR><TH id="L2025"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2025">2025</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_PLAYER<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2026"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2026">2026</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HandleTeleport<SPAN class="p">(</SPAN>spellId<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2027"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2027">2027</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2028"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2028">2028</A></TH><TD></TR><TR><TH id="L2029"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2029">2029</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectApplyAura<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp; <SPAN class="c">// Apply Aura</SPAN></TD></TR><TR><TH id="L2030"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2030">2030</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2031"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2031">2031</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2032"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2032">2032</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2033"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2033">2033</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// can't apply stuns/fear/polymorph/root etc on boss</SPAN></TD></TR><TR><TH id="L2034"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2034">2034</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2035"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2035">2035</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2036"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2036">2036</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>u_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="p">(</SPAN>u_caster <SPAN class="o">!=</SPAN>&nbsp;unitTarget<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2037"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2037">2037</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2038"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2038">2038</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>&nbsp;c <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature <SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2039"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2039">2039</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2040"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2040">2040</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2041"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2041">2041</A></TH><TD></TR><TR><TH id="L2042"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2042">2042</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L2043"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2043">2043</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Charm (Mind Control, enslave demon): 1</SPAN></TD></TR><TR><TH id="L2044"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2044">2044</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Confuse (Blind etc): 2</SPAN></TD></TR><TR><TH id="L2045"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2045">2045</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Fear: 4</SPAN></TD></TR><TR><TH id="L2046"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2046">2046</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Root: 8</SPAN></TD></TR><TR><TH id="L2047"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2047">2047</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Silence : 16</SPAN></TD></TR><TR><TH id="L2048"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2048">2048</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Stun: 32</SPAN></TD></TR><TR><TH id="L2049"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2049">2049</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sheep: 64</SPAN></TD></TR><TR><TH id="L2050"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2050">2050</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Banish: 128</SPAN></TD></TR><TR><TH id="L2051"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2051">2051</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sap: 256</SPAN></TD></TR><TR><TH id="L2052"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2052">2052</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Frozen : 512</SPAN></TD></TR><TR><TH id="L2053"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2053">2053</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ensnared 1024</SPAN></TD></TR><TR><TH id="L2054"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2054">2054</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sleep 2048</SPAN></TD></TR><TR><TH id="L2055"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2055">2055</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Taunt (aura): 4096</SPAN></TD></TR><TR><TH id="L2056"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2056">2056</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Decrease Speed (Hamstring) (aura): 8192</SPAN></TD></TR><TR><TH id="L2057"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2057">2057</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell Haste (Curse of Tongues) (aura): 16384</SPAN></TD></TR><TR><TH id="L2058"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2058">2058</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt Cast: 32768</SPAN></TD></TR><TR><TH id="L2059"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2059">2059</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mod Healing % (Mortal Strike) (aura): 65536</SPAN></TD></TR><TR><TH id="L2060"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2060">2060</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Total Stats % (Vindication) (aura): 131072</SPAN></TD></TR><TR><TH id="L2061"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2061">2061</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L2062"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2062">2062</A></TH><TD></TR><TR><TH id="L2063"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2063">2063</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Spells with Mechanic also add other ugly auras, but if the main aura is the effect --&gt; immune to whole spell</SPAN></TD></TR><TR><TH id="L2064"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2064">2064</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2065"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2065">2065</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2066"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2066">2066</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2067"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2067">2067</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>MechanicsType<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2068"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2068">2068</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2069"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2069">2069</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>MechanicsType<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2070"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2070">2070</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2071"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2071">2071</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_CHARMED:</SPAN></TD></TR><TR><TH id="L2072"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2072">2072</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2073"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2073">2073</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2074"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2074">2074</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2075"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2075">2075</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_DISORIENTED:</SPAN></TD></TR><TR><TH id="L2076"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2076">2076</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2077"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2077">2077</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2078"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2078">2078</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2079"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2079">2079</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_FLEEING:</SPAN></TD></TR><TR><TH id="L2080"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2080">2080</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">4</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2081"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2081">2081</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2082"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2082">2082</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2083"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2083">2083</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_ROOTED:</SPAN></TD></TR><TR><TH id="L2084"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2084">2084</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">8</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2085"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2085">2085</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2086"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2086">2086</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2087"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2087">2087</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_SILENCED:</SPAN></TD></TR><TR><TH id="L2088"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2088">2088</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">16</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2089"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2089">2089</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2090"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2090">2090</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2091"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2091">2091</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_STUNNED:</SPAN></TD></TR><TR><TH id="L2092"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2092">2092</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">32</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2093"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2093">2093</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2094"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2094">2094</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2095"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2095">2095</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_POLYMORPHED:</SPAN></TD></TR><TR><TH id="L2096"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2096">2096</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">64</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2097"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2097">2097</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2098"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2098">2098</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2099"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2099">2099</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_BANISHED:</SPAN></TD></TR><TR><TH id="L2100"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2100">2100</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">128</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2101"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2101">2101</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2102"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2102">2102</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2103"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2103">2103</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_SAPPED:</SPAN></TD></TR><TR><TH id="L2104"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2104">2104</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">256</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2105"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2105">2105</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2106"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2106">2106</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2107"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2107">2107</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_FROZEN:</SPAN></TD></TR><TR><TH id="L2108"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2108">2108</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">512</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2109"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2109">2109</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2110"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2110">2110</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2111"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2111">2111</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_ENSNARED:</SPAN></TD></TR><TR><TH id="L2112"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2112">2112</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">1024</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2113"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2113">2113</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2114"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2114">2114</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2115"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2115">2115</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">MECHANIC_ASLEEP:</SPAN></TD></TR><TR><TH id="L2116"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2116">2116</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">2048</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2117"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2117">2117</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2118"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2118">2118</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2119"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2119">2119</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2120"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2120">2120</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2121"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2121">2121</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>immune<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2122"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2122">2122</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2123"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2123">2123</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Spells wich do more than just one thing (damage and the effect) dont have a mechanic and we should only cancel the aura to be placed</SPAN></TD></TR><TR><TH id="L2124"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2124">2124</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>EffectApplyAuraName<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L2125"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2125">2125</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2126"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2126">2126</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_CONFUSE:</SPAN></TD></TR><TR><TH id="L2127"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2127">2127</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2128"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2128">2128</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2129"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2129">2129</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2130"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2130">2130</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_FEAR:</SPAN></TD></TR><TR><TH id="L2131"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2131">2131</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">4</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2132"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2132">2132</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2133"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2133">2133</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2134"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2134">2134</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_TAUNT:</SPAN></TD></TR><TR><TH id="L2135"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2135">2135</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">4096</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2136"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2136">2136</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2137"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2137">2137</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2138"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2138">2138</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_STUN:</SPAN></TD></TR><TR><TH id="L2139"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2139">2139</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">32</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2140"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2140">2140</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2141"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2141">2141</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2142"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2142">2142</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_SILENCE:</SPAN></TD></TR><TR><TH id="L2143"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2143">2143</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">((</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">32768</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">16</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2144"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2144">2144</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2145"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2145">2145</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2146"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2146">2146</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_DECREASE_SPEED:</SPAN></TD></TR><TR><TH id="L2147"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2147">2147</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">8192</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2148"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2148">2148</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2149"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2149">2149</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2150"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2150">2150</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_INCREASE_CASTING_TIME_PCT:</SPAN></TD></TR><TR><TH id="L2151"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2151">2151</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">16384</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2152"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2152">2152</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2153"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2153">2153</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2154"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2154">2154</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_LANGUAGE:</SPAN>&nbsp;<SPAN class="c">//hacky way to prefer that the COT icon is set to mob</SPAN></TD></TR><TR><TH id="L2155"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2155">2155</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">16384</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2156"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2156">2156</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2157"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2157">2157</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2158"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2158">2158</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_HEALING_DONE_PERCENT:</SPAN></TD></TR><TR><TH id="L2159"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2159">2159</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">65536</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2160"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2160">2160</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2161"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2161">2161</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2162"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2162">2162</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_AURA_MOD_TOTAL_STAT_PERCENTAGE:</SPAN></TD></TR><TR><TH id="L2163"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2163">2163</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">131072</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2164"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2164">2164</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; immune <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2165"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2165">2165</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2166"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2166">2166</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2167"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2167">2167</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2168"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2168">2168</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>immune<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2169"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2169">2169</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2170"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2170">2170</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2171"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2171">2171</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2172"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2172">2172</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2173"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2173">2173</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2174"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2174">2174</A></TH><TD><SPAN class="cp"></SPAN></TD></TR><TR><TH id="L2175"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2175">2175</A></TH><TD><SPAN class="cp">#ifdef GM_Z_DEBUG_DIRECTLY</SPAN></TD></TR><TR><TH id="L2176"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2176">2176</A></TH><TD><SPAN class="cp"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2177"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2177">2177</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CanUseCommand<SPAN class="p">(</SPAN><SPAN class="sc">'z'</SPAN><SPAN class="p">)</SPAN>&nbsp; <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2178"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2178">2178</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sChatHandler<SPAN class="p">.</SPAN>BlueSystemMessage<SPAN class="p">(</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget&nbsp; <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="s">"[%sSystem%s] |rSpell::SpellEffectApplyAura: %s EffectApplyAuraName [%u] ."</SPAN><SPAN class="p">,</SPAN>&nbsp;MSG_COLOR_WHITE<SPAN class="p">,</SPAN>&nbsp;MSG_COLOR_LIGHTBLUE<SPAN class="p">,</SPAN>&nbsp;MSG_COLOR_SUBWHITE<SPAN class="p">,</SPAN></TD></TR><TR><TH id="L2179"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2179">2179</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2180"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2180">2180</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2181"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2181">2181</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2182"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2182">2182</A></TH><TD><SPAN class="cp">#endif</SPAN></TD></TR><TR><TH id="L2183"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2183">2183</A></TH><TD><SPAN class="cp"></SPAN></TD></TR><TR><TH id="L2184"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2184">2184</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// avoid map corruption.</SPAN></TD></TR><TR><TH id="L2185"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2185">2185</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L2186"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2186">2186</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2187"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2187">2187</A></TH><TD></TR><TR><TH id="L2188"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2188">2188</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//check if we already have stronger aura</SPAN></TD></TR><TR><TH id="L2189"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2189">2189</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; Aura <SPAN class="o">*</SPAN>pAura<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2190"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2190">2190</A></TH><TD></TR><TR><TH id="L2191"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2191">2191</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; std<SPAN class="o">::</SPAN>map<SPAN class="o">&lt;</SPAN>uint32<SPAN class="p">,</SPAN>Aura<SPAN class="o">*&gt;::</SPAN>iterator itr<SPAN class="o">=</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>tmpAura<SPAN class="p">.</SPAN>find<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2192"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2192">2192</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//if we do not make a check to see if the aura owner is the same as the caster then we will stack the 2 auras and they will not be visible client sided</SPAN></TD></TR><TR><TH id="L2193"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2193">2193</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>itr <SPAN class="o">==</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>tmpAura<SPAN class="p">.</SPAN>end<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L2194"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2194">2194</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2195"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2195">2195</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_BLOOD_FRENZY <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="o">-&gt;</SPAN>ProcedOnSpell <SPAN class="p">)</SPAN><SPAN class="c">//Warrior's Blood Frenzy</SPAN></TD></TR><TR><TH id="L2196"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2196">2196</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">this</SPAN><SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>DurationIndex <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="o">-&gt;</SPAN>ProcedOnSpell<SPAN class="o">-&gt;</SPAN>DurationIndex<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2197"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2197">2197</A></TH><TD></TR><TR><TH id="L2198"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2198">2198</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 Duration <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="o">-&gt;</SPAN>GetDuration<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2199"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2199">2199</A></TH><TD></TR><TR><TH id="L2200"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2200">2200</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Handle diminishing returns, if it should be resisted, it'll make duration 0 here.</SPAN></TD></TR><TR><TH id="L2201"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2201">2201</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Attributes <SPAN class="o">&amp;</SPAN>&nbsp;ATTRIBUTES_PASSIVE<SPAN class="p">))</SPAN>&nbsp;<SPAN class="c">// Passive</SPAN></TD></TR><TR><TH id="L2202"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2202">2202</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">::</SPAN>ApplyDiminishingReturnTimer<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>Duration<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L2203"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2203">2203</A></TH><TD></TR><TR><TH id="L2204"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2204">2204</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>Duration<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2205"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2205">2205</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2206"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2206">2206</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_IMMUNE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2207"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2207">2207</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2208"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2208">2208</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2209"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2209">2209</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura <SPAN class="o">=</SPAN>&nbsp;AuraPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2210"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2210">2210</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>pAura<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2211"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2211">2211</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2212"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2212">2212</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>g_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;g_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>OBJECT_FIELD_CREATED_BY<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;g_caster<SPAN class="o">-&gt;</SPAN>m_summoner<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2213"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2213">2213</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>GetProto<SPAN class="p">(),</SPAN>&nbsp;Duration<SPAN class="p">,</SPAN>&nbsp;g_caster<SPAN class="o">-&gt;</SPAN>m_summoner<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;m_triggeredSpell<SPAN class="p">,</SPAN>&nbsp;i_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2214"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2214">2214</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2215"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2215">2215</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>GetProto<SPAN class="p">(),</SPAN>&nbsp;Duration<SPAN class="p">,</SPAN>&nbsp;m_caster<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;m_triggeredSpell<SPAN class="p">,</SPAN>&nbsp;i_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2216"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2216">2216</A></TH><TD></TR><TR><TH id="L2217"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2217">2217</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura<SPAN class="o">-&gt;</SPAN>pSpellId <SPAN class="o">=</SPAN>&nbsp;pSpellId<SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//this is required for triggered spells</SPAN></TD></TR><TR><TH id="L2218"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2218">2218</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L2219"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2219">2219</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>tmpAura<SPAN class="p">[</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;pAura<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2220"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2220">2220</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2221"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2221">2221</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2222"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2222">2222</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2223"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2223">2223</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura<SPAN class="o">=</SPAN>itr<SPAN class="o">-&gt;</SPAN>second<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2224"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2224">2224</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2225"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2225">2225</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pAura<SPAN class="o">-&gt;</SPAN>AddMod<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectApplyAuraName<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>damage<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2226"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2226">2226</A></TH><TD></TR><TR><TH id="L2227"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2227">2227</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2228"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2228">2228</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2229"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2229">2229</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">38177</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Blackwhelp Net</SPAN></TD></TR><TR><TH id="L2230"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2230">2230</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2231"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2231">2231</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">38178</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2232"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2232">2232</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>Despawn<SPAN class="p">(</SPAN><SPAN class="mi">1000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">360000</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2233"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2233">2233</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2234"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2234">2234</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2235"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2235">2235</A></TH><TD></TR><TR><TH id="L2236"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2236">2236</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2237"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2237">2237</A></TH><TD></TR><TR><TH id="L2238"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2238">2238</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectPowerDrain<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp; <SPAN class="c">// Power Drain</SPAN></TD></TR><TR><TH id="L2239"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2239">2239</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2240"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2240">2240</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L2241"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2241">2241</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2242"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2242">2242</A></TH><TD></TR><TR><TH id="L2243"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2243">2243</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 powerField <SPAN class="o">=</SPAN>&nbsp;UNIT_FIELD_POWER1<SPAN class="o">+</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L2244"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2244">2244</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 curPower <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>powerField<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2245"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2245">2245</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;powerField <SPAN class="o">==</SPAN>&nbsp;UNIT_FIELD_POWER1 <SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2246"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2246">2246</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2247"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2247">2247</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Player<SPAN class="o">*</SPAN>&nbsp;mPlayer <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2248"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2248">2248</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;mPlayer<SPAN class="o">-&gt;</SPAN>IsInFeralForm<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2249"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2249">2249</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2250"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2250">2250</A></TH><TD></TR><TR><TH id="L2251"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2251">2251</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Resilience - reduces the effect of mana drains by (CalcRating*2)%.</SPAN></TD></TR><TR><TH id="L2252"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2252">2252</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; damage <SPAN class="o">*=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>CalcRating<SPAN class="p">(</SPAN>&nbsp;PLAYER_RATING_MODIFIER_SPELL_CRIT_RESILIENCE <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">2</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mf">100.0f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2253"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2253">2253</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2254"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2254">2254</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 amt <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">+</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetDamageDoneMod<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>School <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">80</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2255"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2255">2255</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>amt<SPAN class="o">&gt;</SPAN>curPower<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2256"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2256">2256</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; amt<SPAN class="o">=</SPAN>curPower<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2257"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2257">2257</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>powerField<SPAN class="p">,</SPAN>curPower<SPAN class="o">-</SPAN>amt<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2258"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2258">2258</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Energize<SPAN class="p">(</SPAN>&nbsp;u_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>&nbsp;amt<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2259"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2259">2259</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2260"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2260">2260</A></TH><TD></TR><TR><TH id="L2261"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2261">2261</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectHealthLeech<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Health Leech</SPAN></TD></TR><TR><TH id="L2262"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2262">2262</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2263"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2263">2263</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L2264"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2264">2264</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2265"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2265">2265</A></TH><TD></TR><TR><TH id="L2266"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2266">2266</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 curHealth <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_HEALTH<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2267"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2267">2267</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 amt <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2268"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2268">2268</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>amt <SPAN class="o">&gt;</SPAN>&nbsp;curHealth<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2269"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2269">2269</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2270"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2270">2270</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; amt <SPAN class="o">=</SPAN>&nbsp;curHealth<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2271"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2271">2271</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2272"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2272">2272</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>DealDamage<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;damage<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2273"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2273">2273</A></TH><TD></TR><TR><TH id="L2274"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2274">2274</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 playerCurHealth <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_HEALTH<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2275"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2275">2275</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 playerMaxHealth <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2276"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2276">2276</A></TH><TD></TR><TR><TH id="L2277"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2277">2277</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerCurHealth <SPAN class="o">+</SPAN>&nbsp;amt <SPAN class="o">&gt;</SPAN>&nbsp;playerMaxHealth<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2278"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2278">2278</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2279"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2279">2279</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_HEALTH<SPAN class="p">,</SPAN>&nbsp;playerMaxHealth<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2280"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2280">2280</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2281"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2281">2281</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2282"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2282">2282</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2283"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2283">2283</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_HEALTH<SPAN class="p">,</SPAN>&nbsp;playerCurHealth <SPAN class="o">+</SPAN>&nbsp;amt<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2284"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2284">2284</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2285"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2285">2285</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2286"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2286">2286</A></TH><TD></TR><TR><TH id="L2287"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2287">2287</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectHeal<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Heal</SPAN></TD></TR><TR><TH id="L2288"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2288">2288</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2289"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2289">2289</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectChainTarget<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN><SPAN class="c">//chain</SPAN></TD></TR><TR><TH id="L2290"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2290">2290</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2291"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2291">2291</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>chaindamage<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2292"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2292">2292</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2293"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2293">2293</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; chaindamage <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2294"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2294">2294</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Heal<SPAN class="p">((</SPAN>int32<SPAN class="p">)</SPAN>chaindamage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2295"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2295">2295</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2296"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2296">2296</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2297"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2297">2297</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2298"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2298">2298</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 reduce<SPAN class="o">=</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectDieSides<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2299"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2299">2299</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType <SPAN class="o">&amp;&amp;</SPAN>&nbsp;u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2300"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2300">2300</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2301"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2301">2301</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SM_FIValue<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>SM_PJumpReduce<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>reduce<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2302"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2302">2302</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2303"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2303">2303</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; chaindamage <SPAN class="o">-=</SPAN>&nbsp;<SPAN class="p">(</SPAN>reduce <SPAN class="o">*</SPAN>&nbsp;chaindamage<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2304"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2304">2304</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Heal<SPAN class="p">((</SPAN>int32<SPAN class="p">)</SPAN>chaindamage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2305"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2305">2305</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2306"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2306">2306</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2307"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2307">2307</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2308"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2308">2308</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2309"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2309">2309</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//yep, the usual special case. This one is shaman talent : Nature's guardian</SPAN></TD></TR><TR><TH id="L2310"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2310">2310</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//health is below 30%, we have a mother spell to get value from</SPAN></TD></TR><TR><TH id="L2311"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2311">2311</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2312"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2312">2312</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2313"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2313">2313</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">31616</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2314"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2314">2314</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2315"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2315">2315</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget <SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;pSpellId <SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetHealthPct<SPAN class="p">()</SPAN><SPAN class="o">&lt;</SPAN><SPAN class="mi">30</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2316"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2316">2316</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2317"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2317">2317</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//check for that 10 second cooldown</SPAN></TD></TR><TR><TH id="L2318"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2318">2318</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>spellInfo <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>pSpellId <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2319"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2319">2319</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>spellInfo<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2320"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2320">2320</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2321"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2321">2321</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//heal value is receivad by the level of current active talent :s</SPAN></TD></TR><TR><TH id="L2322"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2322">2322</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//maybe we should use CalculateEffect(uint32 i) to gain SM benefits</SPAN></TD></TR><TR><TH id="L2323"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2323">2323</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 value <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2324"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2324">2324</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 basePoints <SPAN class="o">=</SPAN>&nbsp;spellInfo<SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//+(m_caster-&gt;getLevel()*basePointsPerLevel);</SPAN></TD></TR><TR><TH id="L2325"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2325">2325</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 randomPoints <SPAN class="o">=</SPAN>&nbsp;spellInfo<SPAN class="o">-&gt;</SPAN>EffectDieSides<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L2326"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2326">2326</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>randomPoints <SPAN class="o">&lt;=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2327"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2327">2327</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value <SPAN class="o">=</SPAN>&nbsp;basePoints<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2328"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2328">2328</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2329"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2329">2329</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value <SPAN class="o">=</SPAN>&nbsp;basePoints <SPAN class="o">+</SPAN>&nbsp;rand<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">%</SPAN>&nbsp;randomPoints<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2330"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2330">2330</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//the value is in percent. Until now it's a fixed 10%</SPAN></TD></TR><TR><TH id="L2331"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2331">2331</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Heal<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">)</SPAN><SPAN class="o">*</SPAN>value<SPAN class="o">/</SPAN><SPAN class="mi">100</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2332"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2332">2332</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2333"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2333">2333</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2334"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2334">2334</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2335"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2335">2335</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Bloodthirst</SPAN></TD></TR><TR><TH id="L2336"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2336">2336</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23880</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2337"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2337">2337</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2338"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2338">2338</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2339"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2339">2339</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2340"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2340">2340</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Heal<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="mi">100</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2341"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2341">2341</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2342"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2342">2342</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2343"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2343">2343</A></TH><TD></TR><TR><TH id="L2344"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2344">2344</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">34299</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Druid: Improved Leader of the PAck</SPAN></TD></TR><TR><TH id="L2345"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2345">2345</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2346"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2346">2346</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L2347"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2347">2347</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2348"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2348">2348</A></TH><TD></TR><TR><TH id="L2349"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2349">2349</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Player<SPAN class="o">*</SPAN>&nbsp;mPlayer <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2350"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2350">2350</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>mPlayer<SPAN class="o">-&gt;</SPAN>IsInFeralForm<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="p">(</SPAN></TD></TR><TR><TH id="L2351"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2351">2351</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mPlayer<SPAN class="o">-&gt;</SPAN>GetShapeShift<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;FORM_CAT <SPAN class="o">&amp;&amp;</SPAN></TD></TR><TR><TH id="L2352"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2352">2352</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mPlayer<SPAN class="o">-&gt;</SPAN>GetShapeShift<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;FORM_BEAR <SPAN class="o">&amp;&amp;</SPAN></TD></TR><TR><TH id="L2353"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2353">2353</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mPlayer<SPAN class="o">-&gt;</SPAN>GetShapeShift<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;FORM_DIREBEAR <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2354"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2354">2354</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2355"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2355">2355</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 max <SPAN class="o">=</SPAN>&nbsp;mPlayer<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_MAXHEALTH <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2356"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2356">2356</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 val <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;mPlayer<SPAN class="o">-&gt;</SPAN>FindAura<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">34300</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="mf">0.04f</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="mf">0.02f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;max <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2357"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2357">2357</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>val<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2358"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2358">2358</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mPlayer<SPAN class="o">-&gt;</SPAN>Heal<SPAN class="p">(</SPAN>mPlayer<SPAN class="p">,</SPAN><SPAN class="mi">34299</SPAN><SPAN class="p">,(</SPAN>uint32<SPAN class="p">)(</SPAN>val<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L2359"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2359">2359</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2360"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2360">2360</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">22845</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Druid: Frenzied Regeneration</SPAN></TD></TR><TR><TH id="L2361"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2361">2361</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2362"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2362">2362</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L2363"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2363">2363</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2364"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2364">2364</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Player<SPAN class="o">*</SPAN>&nbsp;mPlayer <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2365"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2365">2365</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>mPlayer<SPAN class="o">-&gt;</SPAN>IsInFeralForm<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN></TD></TR><TR><TH id="L2366"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2366">2366</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">(</SPAN>mPlayer<SPAN class="o">-&gt;</SPAN>GetShapeShift<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;FORM_BEAR <SPAN class="o">&amp;&amp;</SPAN></TD></TR><TR><TH id="L2367"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2367">2367</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mPlayer<SPAN class="o">-&gt;</SPAN>GetShapeShift<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;FORM_DIREBEAR<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2368"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2368">2368</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2369"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2369">2369</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 val <SPAN class="o">=</SPAN>&nbsp;mPlayer<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER2<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2370"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2370">2370</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>val<SPAN class="o">&gt;</SPAN><SPAN class="mi">100</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2371"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2371">2371</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; val <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2372"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2372">2372</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 HpPerPoint <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">((</SPAN>mPlayer<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_MAXHEALTH <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">0.003f</SPAN><SPAN class="p">));</SPAN>&nbsp;<SPAN class="c">//0.3% of hp per point of rage</SPAN></TD></TR><TR><TH id="L2373"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2373">2373</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 heal <SPAN class="o">=</SPAN>&nbsp;HpPerPoint <SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN>val<SPAN class="o">/</SPAN><SPAN class="mi">10</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//1 point of rage = 0.3% of max hp</SPAN></TD></TR><TR><TH id="L2374"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2374">2374</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mPlayer<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER2<SPAN class="p">,</SPAN>mPlayer<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER2<SPAN class="p">)</SPAN><SPAN class="o">-</SPAN>val<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2375"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2375">2375</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>val<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2376"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2376">2376</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mPlayer<SPAN class="o">-&gt;</SPAN>Heal<SPAN class="p">(</SPAN>mPlayer<SPAN class="p">,</SPAN><SPAN class="mi">22845</SPAN><SPAN class="p">,</SPAN>heal<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2377"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2377">2377</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2378"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2378">2378</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">18562</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//druid - swiftmend</SPAN></TD></TR><TR><TH id="L2379"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2379">2379</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2380"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2380">2380</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2381"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2381">2381</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2382"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2382">2382</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 new_dmg <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2383"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2383">2383</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//consume rejuvenetaion and regrowth</SPAN></TD></TR><TR><TH id="L2384"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2384">2384</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Aura <SPAN class="o">*</SPAN>&nbsp;taura <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>FindAuraByNameHash<SPAN class="p">(</SPAN>&nbsp;SPELL_HASH_REGROWTH <SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Regrowth</SPAN></TD></TR><TR><TH id="L2385"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2385">2385</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;taura <SPAN class="o">&amp;&amp;</SPAN>&nbsp;taura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L2386"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2386">2386</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2387"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2387">2387</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 amplitude <SPAN class="o">=</SPAN>&nbsp;taura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectAmplitude<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">1000</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2388"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2388">2388</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>amplitude <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2389"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2389">2389</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; amplitude <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2390"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2390">2390</A></TH><TD></TR><TR><TH id="L2391"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2391">2391</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//our hapiness is that we did not store the aura mod amount so we have to recalc it</SPAN></TD></TR><TR><TH id="L2392"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2392">2392</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>spell <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2393"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2393">2393</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2394"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2394">2394</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2395"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2395">2395</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>m_caster<SPAN class="p">,</SPAN>&nbsp;taura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2396"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2396">2396</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 healamount <SPAN class="o">=</SPAN>&nbsp;spell<SPAN class="o">-&gt;</SPAN>CalculateEffect<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2397"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2397">2397</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellPool<SPAN class="p">.</SPAN>PooledDelete<SPAN class="p">(</SPAN>&nbsp;spell <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2398"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2398">2398</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2399"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2399">2399</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new_dmg <SPAN class="o">=</SPAN>&nbsp;healamount <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">18</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;amplitude<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2400"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2400">2400</A></TH><TD></TR><TR><TH id="L2401"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2401">2401</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>RemoveAura<SPAN class="p">(</SPAN>&nbsp;taura <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2402"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2402">2402</A></TH><TD></TR><TR><TH id="L2403"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2403">2403</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//do not remove flag if we still can cast it again</SPAN></TD></TR><TR><TH id="L2404"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2404">2404</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>HasAurasWithNameHash<SPAN class="p">(</SPAN>&nbsp;SPELL_HASH_REJUVENATION <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2405"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2405">2405</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2406"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2406">2406</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>RemoveFlag<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_AURASTATE<SPAN class="p">,</SPAN>&nbsp;AURASTATE_FLAG_REJUVENATE <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2407"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2407">2407</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;EVENT_REJUVENATION_FLAG_EXPIRE <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2408"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2408">2408</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2409"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2409">2409</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2410"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2410">2410</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2411"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2411">2411</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2412"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2412">2412</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; taura <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>FindAuraByNameHash<SPAN class="p">(</SPAN>&nbsp;SPELL_HASH_REJUVENATION <SPAN class="p">);</SPAN><SPAN class="c">//Rejuvenation</SPAN></TD></TR><TR><TH id="L2413"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2413">2413</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;taura&nbsp; <SPAN class="o">&amp;&amp;</SPAN>&nbsp;taura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2414"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2414">2414</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2415"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2415">2415</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 amplitude <SPAN class="o">=</SPAN>&nbsp;taura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectAmplitude<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">1000</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2416"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2416">2416</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>amplitude <SPAN class="p">)</SPAN>&nbsp;amplitude <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2417"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2417">2417</A></TH><TD></TR><TR><TH id="L2418"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2418">2418</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//our hapiness is that we did not store the aura mod amount so we have to recalc it</SPAN></TD></TR><TR><TH id="L2419"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2419">2419</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>spell <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2420"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2420">2420</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2421"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2421">2421</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2422"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2422">2422</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="p">,</SPAN>&nbsp;taura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2423"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2423">2423</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 healamount <SPAN class="o">=</SPAN>&nbsp;spell<SPAN class="o">-&gt;</SPAN>CalculateEffect<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2424"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2424">2424</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellPool<SPAN class="p">.</SPAN>PooledDelete<SPAN class="p">(</SPAN>&nbsp;spell <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2425"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2425">2425</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2426"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2426">2426</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new_dmg <SPAN class="o">=</SPAN>&nbsp;healamount <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">12</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;amplitude<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2427"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2427">2427</A></TH><TD></TR><TR><TH id="L2428"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2428">2428</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>RemoveAura<SPAN class="p">(</SPAN>&nbsp;taura <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2429"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2429">2429</A></TH><TD></TR><TR><TH id="L2430"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2430">2430</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>RemoveFlag<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_AURASTATE<SPAN class="p">,</SPAN>AURASTATE_FLAG_REJUVENATE <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2431"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2431">2431</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>EVENT_REJUVENATION_FLAG_EXPIRE <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2432"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2432">2432</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2433"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2433">2433</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2434"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2434">2434</A></TH><TD></TR><TR><TH id="L2435"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2435">2435</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;new_dmg <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2436"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2436">2436</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2437"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2437">2437</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>spellInfo <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">18562</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2438"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2438">2438</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>spell <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2439"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2439">2439</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2440"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2440">2440</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2441"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2441">2441</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;spellInfo<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2442"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2442">2442</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>SetUnitTarget<SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2443"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2443">2443</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>Heal<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>int32<SPAN class="p">)</SPAN>new_dmg <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2444"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2444">2444</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2445"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2445">2445</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2446"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2446">2446</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2447"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2447">2447</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2448"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2448">2448</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Heal<SPAN class="p">(</SPAN>damage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2449"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2449">2449</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2450"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2450">2450</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2451"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2451">2451</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2452"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2452">2452</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2453"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2453">2453</A></TH><TD></TR><TR><TH id="L2454"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2454">2454</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectQuestComplete<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Quest Complete</SPAN></TD></TR><TR><TH id="L2455"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2455">2455</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2456"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2456">2456</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2457"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2457">2457</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; QuestLogEntry <SPAN class="o">*</SPAN>&nbsp;en <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetQuestLogForEntry<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2458"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2458">2458</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;en <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>en<SPAN class="o">-&gt;</SPAN>CanBeFinished<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2459"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2459">2459</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en<SPAN class="o">-&gt;</SPAN>SendQuestComplete<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2460"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2460">2460</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2461"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2461">2461</A></TH><TD></TR><TR><TH id="L2462"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2462">2462</A></TH><TD><SPAN class="c">//wand-&gt;</SPAN></TD></TR><TR><TH id="L2463"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2463">2463</A></TH><TD><SPAN class="c"></SPAN><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectWeapondamageNoschool<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Weapon damage + (no School)</SPAN></TD></TR><TR><TH id="L2464"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2464">2464</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2465"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2465">2465</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||!</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2466"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2466">2466</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2467"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2467">2467</A></TH><TD></TR><TR><TH id="L2468"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2468">2468</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_DMG_TYPE_RANGED <SPAN class="o">&amp;&amp;</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>speed <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2469"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2469">2469</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2470"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2470">2470</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;time <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>CalcDistance<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">1000.0f</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>speed<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2471"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2471">2471</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>time <SPAN class="o">&lt;=</SPAN>&nbsp;<SPAN class="mf">100.0f</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2472"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2472">2472</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Strike<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;RANGED<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2473"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2473">2473</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2474"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2474">2474</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>Unit<SPAN class="o">::</SPAN>EventStrikeWithAbility<SPAN class="p">,</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN></TD></TR><TR><TH id="L2475"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2475">2475</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>damage<SPAN class="p">,</SPAN>&nbsp;EVENT_SPELL_DAMAGE_HIT<SPAN class="p">,</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>time<SPAN class="p">),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;EVENT_FLAG_DO_NOT_EXECUTE_IN_WORLD_CONTEXT<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2476"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2476">2476</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2477"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2477">2477</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2478"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2478">2478</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Strike<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;GetType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_DMG_TYPE_RANGED <SPAN class="o">?</SPAN>&nbsp;RANGED <SPAN class="o">:</SPAN>&nbsp;MELEE <SPAN class="p">),</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;damage<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2479"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2479">2479</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2480"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2480">2480</A></TH><TD></TR><TR><TH id="L2481"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2481">2481</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectAddExtraAttacks<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Add Extra Attacks</SPAN></TD></TR><TR><TH id="L2482"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2482">2482</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2483"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2483">2483</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2484"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2484">2484</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2485"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2485">2485</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>m_extraattacks <SPAN class="o">+=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2486"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2486">2486</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2487"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2487">2487</A></TH><TD></TR><TR><TH id="L2488"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2488">2488</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDodge<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2489"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2489">2489</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2490"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2490">2490</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//i think this actually enbles the skill to be able to dodge melee+ranged attacks</SPAN></TD></TR><TR><TH id="L2491"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2491">2491</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//value is static and sets value directly which will be modified by other factors</SPAN></TD></TR><TR><TH id="L2492"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2492">2492</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//this is only basic value and will be overwiten elsewhere !!!</SPAN></TD></TR><TR><TH id="L2493"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2493">2493</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; if(unitTarget-&gt;IsPlayer())</SPAN></TD></TR><TR><TH id="L2494"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2494">2494</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget-&gt;SetFloatValue(PLAYER_DODGE_PERCENTAGE,damage);</SPAN></TD></TR><TR><TH id="L2495"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2495">2495</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2496"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2496">2496</A></TH><TD></TR><TR><TH id="L2497"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2497">2497</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectParry<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2498"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2498">2498</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2499"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2499">2499</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2500"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2500">2500</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>setcanperry<SPAN class="p">(</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2501"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2501">2501</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2502"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2502">2502</A></TH><TD></TR><TR><TH id="L2503"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2503">2503</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectBlock<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2504"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2504">2504</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2505"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2505">2505</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//i think this actually enbles the skill to be able to block melee+ranged attacks</SPAN></TD></TR><TR><TH id="L2506"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2506">2506</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//value is static and sets value directly which will be modified by other factors</SPAN></TD></TR><TR><TH id="L2507"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2507">2507</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; if(unitTarget-&gt;IsPlayer())</SPAN></TD></TR><TR><TH id="L2508"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2508">2508</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget-&gt;SetFloatValue(PLAYER_BLOCK_PERCENTAGE,damage);</SPAN></TD></TR><TR><TH id="L2509"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2509">2509</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2510"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2510">2510</A></TH><TD></TR><TR><TH id="L2511"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2511">2511</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectCreateItem<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Create item</SPAN></TD></TR><TR><TH id="L2512"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2512">2512</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2513"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2513">2513</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">())</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2514"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2514">2514</A></TH><TD></TR><TR><TH id="L2515"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2515">2515</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Player <SPAN class="o">*</SPAN>p_target <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2516"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2516">2516</A></TH><TD></TR><TR><TH id="L2517"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2517">2517</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Item<SPAN class="o">*</SPAN>&nbsp;newItem<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2518"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2518">2518</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Item <SPAN class="o">*</SPAN>add<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2519"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2519">2519</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint8 slot<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2520"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2520">2520</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SlotResult slotresult<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2521"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2521">2521</A></TH><TD></TR><TR><TH id="L2522"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2522">2522</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; skilllinespell<SPAN class="o">*</SPAN>&nbsp;skill <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetSpellSkill<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2523"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2523">2523</A></TH><TD></TR><TR><TH id="L2524"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2524">2524</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN><SPAN class="kt">int</SPAN>&nbsp;j<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;j<SPAN class="o">&lt;</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN>&nbsp;j<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// now create the Items</SPAN></TD></TR><TR><TH id="L2525"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2525">2525</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2526"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2526">2526</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ItemPrototype <SPAN class="o">*</SPAN>m_itemProto<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2527"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2527">2527</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_itemProto <SPAN class="o">=</SPAN>&nbsp;ItemPrototypeStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectItemType<SPAN class="p">[</SPAN>j<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2528"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2528">2528</A></TH><TD></TR><TR><TH id="L2529"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2529">2529</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>m_itemProto<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">continue</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2530"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2530">2530</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectItemType<SPAN class="p">[</SPAN>j<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">continue</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2531"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2531">2531</A></TH><TD></TR><TR><TH id="L2532"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2532">2532</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 item_count <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2533"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2533">2533</A></TH><TD></TR><TR><TH id="L2534"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2534">2534</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2535"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2535">2535</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2536"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2536">2536</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// potions learned by discovery variables</SPAN></TD></TR><TR><TH id="L2537"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2537">2537</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 cast_chance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">5</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2538"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2538">2538</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 learn_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2539"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2539">2539</A></TH><TD></TR><TR><TH id="L2540"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2540">2540</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// tailoring specializations get +1 cloth bonus</SPAN></TD></TR><TR><TH id="L2541"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2541">2541</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2542"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2542">2542</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2543"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2543">2543</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">36686</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Shadowcloth</SPAN></TD></TR><TR><TH id="L2544"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2544">2544</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">26801</SPAN><SPAN class="p">))</SPAN>&nbsp;item_count <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2545"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2545">2545</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2546"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2546">2546</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">26751</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Primal Mooncloth</SPAN></TD></TR><TR><TH id="L2547"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2547">2547</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">26798</SPAN><SPAN class="p">))</SPAN>&nbsp;item_count <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2548"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2548">2548</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2549"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2549">2549</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">31373</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Spellcloth</SPAN></TD></TR><TR><TH id="L2550"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2550">2550</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">26797</SPAN><SPAN class="p">))</SPAN>&nbsp;item_count <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2551"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2551">2551</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2552"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2552">2552</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2553"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2553">2553</A></TH><TD></TR><TR><TH id="L2554"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2554">2554</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>skill <SPAN class="o">&amp;&amp;</SPAN>&nbsp;skill<SPAN class="o">-&gt;</SPAN>skilline <SPAN class="o">==</SPAN>&nbsp;SKILL_ALCHEMY<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2555"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2555">2555</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2556"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2556">2556</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Potion Master</SPAN></TD></TR><TR><TH id="L2557"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2557">2557</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>strstr<SPAN class="p">(</SPAN>m_itemProto<SPAN class="o">-&gt;</SPAN>Name1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="s">"Potion"</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2558"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2558">2558</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2559"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2559">2559</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">28675</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2560"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2560">2560</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">while</SPAN>&nbsp;<SPAN class="p">(</SPAN>Rand<SPAN class="p">(</SPAN><SPAN class="mi">20</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;item_count<SPAN class="o">&lt;</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">)</SPAN>&nbsp;item_count<SPAN class="o">++</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2561"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2561">2561</A></TH><TD></TR><TR><TH id="L2562"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2562">2562</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Super Rejuvenation Potion</SPAN></TD></TR><TR><TH id="L2563"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2563">2563</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cast_chance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2564"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2564">2564</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; learn_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">28586</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2565"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2565">2565</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2566"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2566">2566</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Elixir Master</SPAN></TD></TR><TR><TH id="L2567"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2567">2567</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>strstr<SPAN class="p">(</SPAN>m_itemProto<SPAN class="o">-&gt;</SPAN>Name1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="s">"Elixir"</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;strstr<SPAN class="p">(</SPAN>m_itemProto<SPAN class="o">-&gt;</SPAN>Name1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="s">"Flask"</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2568"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2568">2568</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2569"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2569">2569</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">28677</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2570"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2570">2570</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">while</SPAN>&nbsp;<SPAN class="p">(</SPAN>Rand<SPAN class="p">(</SPAN><SPAN class="mi">20</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;item_count<SPAN class="o">&lt;</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">)</SPAN>&nbsp;item_count<SPAN class="o">++</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2571"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2571">2571</A></TH><TD></TR><TR><TH id="L2572"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2572">2572</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 spList<SPAN class="p">[]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">{</SPAN><SPAN class="mi">28590</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">28587</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">28588</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">28591</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">28589</SPAN><SPAN class="p">};</SPAN></TD></TR><TR><TH id="L2573"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2573">2573</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cast_chance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2574"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2574">2574</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; learn_spell <SPAN class="o">=</SPAN>&nbsp;spList<SPAN class="p">[</SPAN>RandomUInt<SPAN class="p">(</SPAN><SPAN class="mi">4</SPAN><SPAN class="p">)];</SPAN></TD></TR><TR><TH id="L2575"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2575">2575</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2576"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2576">2576</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Transmutation Master</SPAN></TD></TR><TR><TH id="L2577"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2577">2577</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>Category <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">310</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2578"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2578">2578</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2579"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2579">2579</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">29688</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//rate for primal might is lower than for anything else</SPAN></TD></TR><TR><TH id="L2580"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2580">2580</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2581"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2581">2581</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">28672</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2582"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2582">2582</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">while</SPAN>&nbsp;<SPAN class="p">(</SPAN>Rand<SPAN class="p">(</SPAN><SPAN class="mi">40</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;item_count<SPAN class="o">&lt;</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">)</SPAN>&nbsp;item_count<SPAN class="o">++</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2583"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2583">2583</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2584"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2584">2584</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2585"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2585">2585</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2586"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2586">2586</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">28672</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2587"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2587">2587</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">while</SPAN>&nbsp;<SPAN class="p">(</SPAN>Rand<SPAN class="p">(</SPAN><SPAN class="mi">20</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;item_count<SPAN class="o">&lt;</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">)</SPAN>&nbsp;item_count<SPAN class="o">++</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2588"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2588">2588</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2589"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2589">2589</A></TH><TD></TR><TR><TH id="L2590"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2590">2590</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 spList<SPAN class="p">[]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">{</SPAN><SPAN class="mi">28581</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">28585</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">28585</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">28584</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">28582</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">28580</SPAN><SPAN class="p">};</SPAN></TD></TR><TR><TH id="L2591"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2591">2591</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cast_chance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">5</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2592"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2592">2592</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; learn_spell <SPAN class="o">=</SPAN>&nbsp;spList<SPAN class="p">[</SPAN>RandomUInt<SPAN class="p">(</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">)];</SPAN></TD></TR><TR><TH id="L2593"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2593">2593</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2594"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2594">2594</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2595"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2595">2595</A></TH><TD></TR><TR><TH id="L2596"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2596">2596</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//random discovery by crafter item id</SPAN></TD></TR><TR><TH id="L2597"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2597">2597</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;m_itemProto<SPAN class="o">-&gt;</SPAN>ItemId <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2598"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2598">2598</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2599"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2599">2599</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">22845</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Major Arcane Protection Potion</SPAN></TD></TR><TR><TH id="L2600"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2600">2600</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2601"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2601">2601</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cast_chance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2602"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2602">2602</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; learn_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">41458</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2603"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2603">2603</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2604"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2604">2604</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">22841</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Major Fire Protection Potion</SPAN></TD></TR><TR><TH id="L2605"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2605">2605</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2606"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2606">2606</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cast_chance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2607"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2607">2607</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; learn_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">41500</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2608"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2608">2608</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2609"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2609">2609</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">22842</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Major Frost Protection Potion</SPAN></TD></TR><TR><TH id="L2610"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2610">2610</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2611"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2611">2611</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cast_chance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2612"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2612">2612</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; learn_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">41501</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2613"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2613">2613</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2614"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2614">2614</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">22847</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Major Holy Protection Potion</SPAN></TD></TR><TR><TH id="L2615"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2615">2615</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2616"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2616">2616</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// there is none</SPAN></TD></TR><TR><TH id="L2617"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2617">2617</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2618"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2618">2618</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">22844</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Major Nature Protection Potion</SPAN></TD></TR><TR><TH id="L2619"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2619">2619</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2620"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2620">2620</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cast_chance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2621"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2621">2621</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; learn_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">41502</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2622"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2622">2622</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2623"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2623">2623</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">22846</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Major Shadow Protection Potion</SPAN></TD></TR><TR><TH id="L2624"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2624">2624</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2625"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2625">2625</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cast_chance <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2626"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2626">2626</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; learn_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">41503</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2627"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2627">2627</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2628"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2628">2628</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2629"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2629">2629</A></TH><TD></TR><TR><TH id="L2630"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2630">2630</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;learn_spell <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">60</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN>&nbsp;learn_spell <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;Rand<SPAN class="p">(</SPAN>&nbsp;cast_chance <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2631"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2631">2631</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2632"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2632">2632</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry<SPAN class="o">*</SPAN>&nbsp;_spellproto <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;learn_spell <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2633"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2633">2633</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;_spellproto <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2634"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2634">2634</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2635"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2635">2635</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>BroadcastMessage<SPAN class="p">(</SPAN>&nbsp;<SPAN class="s">"%sDISCOVERY! You discovered the %s !|r"</SPAN><SPAN class="p">,</SPAN>&nbsp;MSG_COLOR_YELLOW<SPAN class="p">,</SPAN>&nbsp;_spellproto<SPAN class="o">-&gt;</SPAN>Name <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2636"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2636">2636</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;learn_spell <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2637"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2637">2637</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2638"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2638">2638</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2639"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2639">2639</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2640"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2640">2640</A></TH><TD></TR><TR><TH id="L2641"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2641">2641</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// item count cannot be more than allowed in a single stack</SPAN></TD></TR><TR><TH id="L2642"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2642">2642</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>item_count <SPAN class="o">&gt;</SPAN>&nbsp;m_itemProto<SPAN class="o">-&gt;</SPAN>MaxCount<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2643"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2643">2643</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; item_count <SPAN class="o">=</SPAN>&nbsp;m_itemProto<SPAN class="o">-&gt;</SPAN>MaxCount<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2644"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2644">2644</A></TH><TD></TR><TR><TH id="L2645"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2645">2645</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// item count cannot be more than item unique value</SPAN></TD></TR><TR><TH id="L2646"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2646">2646</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_itemProto<SPAN class="o">-&gt;</SPAN>Unique <SPAN class="o">&amp;&amp;</SPAN>&nbsp;item_count <SPAN class="o">&gt;</SPAN>&nbsp;m_itemProto<SPAN class="o">-&gt;</SPAN>Unique<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2647"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2647">2647</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; item_count <SPAN class="o">=</SPAN>&nbsp;m_itemProto<SPAN class="o">-&gt;</SPAN>Unique<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2648"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2648">2648</A></TH><TD></TR><TR><TH id="L2649"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2649">2649</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_target<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CanReceiveItem<SPAN class="p">(</SPAN>m_itemProto<SPAN class="p">,</SPAN>&nbsp;item_count<SPAN class="p">))</SPAN>&nbsp;<SPAN class="c">//reversed since it sends &gt;1 as invalid and 0 as valid</SPAN></TD></TR><TR><TH id="L2650"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2650">2650</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2651"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2651">2651</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_TOO_MANY_OF_ITEM<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2652"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2652">2652</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2653"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2653">2653</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2654"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2654">2654</A></TH><TD></TR><TR><TH id="L2655"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2655">2655</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slot <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2656"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2656">2656</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add <SPAN class="o">=</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>FindItemLessMax<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectItemType<SPAN class="p">[</SPAN>j<SPAN class="p">],</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2657"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2657">2657</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>add<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2658"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2658">2658</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2659"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2659">2659</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slotresult <SPAN class="o">=</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>FindFreeInventorySlot<SPAN class="p">(</SPAN>m_itemProto<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2660"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2660">2660</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>slotresult<SPAN class="p">.</SPAN>Result<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2661"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2661">2661</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2662"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2662">2662</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_TOO_MANY_OF_ITEM<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2663"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2663">2663</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2664"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2664">2664</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2665"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2665">2665</A></TH><TD></TR><TR><TH id="L2666"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2666">2666</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem <SPAN class="o">=</SPAN>objmgr<SPAN class="p">.</SPAN>CreateItem<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectItemType<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>p_target<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2667"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2667">2667</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>newItem<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2668"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2668">2668</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2669"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2669">2669</A></TH><TD></TR><TR><TH id="L2670"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2670">2670</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>ITEM_FIELD_CREATOR<SPAN class="p">,</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L2671"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2671">2671</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>ITEM_FIELD_STACK_COUNT<SPAN class="p">,</SPAN>&nbsp;item_count<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2672"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2672">2672</A></TH><TD></TR><TR><TH id="L2673"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2673">2673</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_itemProto<SPAN class="o">-&gt;</SPAN>RandomPropId<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2674"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2674">2674</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2675"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2675">2675</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RandomProps <SPAN class="o">*</SPAN>&nbsp;iRandomProperty <SPAN class="o">=</SPAN>&nbsp;lootmgr<SPAN class="p">.</SPAN>GetRandomProperties<SPAN class="p">(</SPAN>m_itemProto<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2676"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2676">2676</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>iRandomProperty <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2677"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2677">2677</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sLog<SPAN class="p">.</SPAN>outError<SPAN class="p">(</SPAN>&nbsp;<SPAN class="s">"DB Error: Item %u has unknown RandomPropId %u"</SPAN><SPAN class="p">,</SPAN>&nbsp;m_itemProto<SPAN class="o">-&gt;</SPAN>ItemId<SPAN class="p">,</SPAN>&nbsp;m_itemProto<SPAN class="o">-&gt;</SPAN>RandomPropId <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2678"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2678">2678</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2679"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2679">2679</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2680"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2680">2680</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>SetRandomProperty<SPAN class="p">(</SPAN>iRandomProperty<SPAN class="o">-&gt;</SPAN>ID<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2681"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2681">2681</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>ApplyRandomProperties<SPAN class="p">(</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2682"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2682">2682</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2683"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2683">2683</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2684"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2684">2684</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_itemProto<SPAN class="o">-&gt;</SPAN>RandomSuffixId<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2685"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2685">2685</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2686"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2686">2686</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ItemRandomSuffixEntry <SPAN class="o">*</SPAN>&nbsp;iRandomSuffix <SPAN class="o">=</SPAN>&nbsp;lootmgr<SPAN class="p">.</SPAN>GetRandomSuffix<SPAN class="p">(</SPAN>m_itemProto<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2687"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2687">2687</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>iRandomSuffix<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2688"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2688">2688</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sLog<SPAN class="p">.</SPAN>outError<SPAN class="p">(</SPAN>&nbsp;<SPAN class="s">"DB Error: Item %u has unknown RandomSuffixId %u"</SPAN><SPAN class="p">,</SPAN>&nbsp;m_itemProto<SPAN class="o">-&gt;</SPAN>ItemId<SPAN class="p">,</SPAN>&nbsp;m_itemProto<SPAN class="o">-&gt;</SPAN>RandomSuffixId <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2689"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2689">2689</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2690"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2690">2690</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2691"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2691">2691</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>SetRandomSuffix<SPAN class="p">(</SPAN>iRandomSuffix<SPAN class="o">-&gt;</SPAN>id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2692"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2692">2692</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>ApplyRandomProperties<SPAN class="p">(</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2693"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2693">2693</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2694"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2694">2694</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2695"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2695">2695</A></TH><TD></TR><TR><TH id="L2696"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2696">2696</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_target<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SafeAddItem<SPAN class="p">(</SPAN>newItem<SPAN class="p">,</SPAN>slotresult<SPAN class="p">.</SPAN>ContainerSlot<SPAN class="p">,</SPAN>&nbsp;slotresult<SPAN class="p">.</SPAN>Slot<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2697"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2697">2697</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2698"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2698">2698</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*WorldPacket data(45);</SPAN></TD></TR><TR><TH id="L2699"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2699">2699</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster-&gt;GetSession()-&gt;BuildItemPushResult(&amp;data, p_caster-&gt;GetGUID(), 1, item_count, GetProto()-&gt;EffectSpellGroupRelation[i] ,0,0xFF,1,0xFFFFFFFF);</SPAN></TD></TR><TR><TH id="L2700"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2700">2700</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster-&gt;SendMessageToSet(&amp;data, true);*/</SPAN></TD></TR><TR><TH id="L2701"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2701">2701</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_target<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendItemPushResult<SPAN class="p">(</SPAN>newItem<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>slotresult<SPAN class="p">.</SPAN>ContainerSlot<SPAN class="p">,</SPAN>slotresult<SPAN class="p">.</SPAN>Slot<SPAN class="p">,</SPAN>item_count<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2702"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2702">2702</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN>&nbsp;<SPAN class="k">else</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2703"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2703">2703</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>DeleteMe<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2704"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2704">2704</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2705"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2705">2705</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2706"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2706">2706</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2707"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2707">2707</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2708"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2708">2708</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//scale item_count down if total stack will be more than 20</SPAN></TD></TR><TR><TH id="L2709"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2709">2709</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>add<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>ITEM_FIELD_STACK_COUNT<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;item_count <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2710"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2710">2710</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2711"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2711">2711</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 item_count_filled<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2712"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2712">2712</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; item_count_filled <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;add<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>ITEM_FIELD_STACK_COUNT<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2713"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2713">2713</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add<SPAN class="o">-&gt;</SPAN>SetCount<SPAN class="p">(</SPAN><SPAN class="mi">20</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2714"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2714">2714</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add<SPAN class="o">-&gt;</SPAN>m_isDirty <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2715"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2715">2715</A></TH><TD></TR><TR><TH id="L2716"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2716">2716</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slotresult <SPAN class="o">=</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>FindFreeInventorySlot<SPAN class="p">(</SPAN>m_itemProto<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2717"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2717">2717</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>slotresult<SPAN class="p">.</SPAN>Result<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2718"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2718">2718</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; item_count <SPAN class="o">=</SPAN>&nbsp;item_count_filled<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2719"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2719">2719</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2720"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2720">2720</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2721"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2721">2721</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem <SPAN class="o">=</SPAN>objmgr<SPAN class="p">.</SPAN>CreateItem<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectItemType<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;p_target<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2722"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2722">2722</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>newItem<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2723"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2723">2723</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2724"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2724">2724</A></TH><TD></TR><TR><TH id="L2725"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2725">2725</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>ITEM_FIELD_CREATOR<SPAN class="p">,</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L2726"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2726">2726</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>ITEM_FIELD_STACK_COUNT<SPAN class="p">,</SPAN>&nbsp;item_count <SPAN class="o">-</SPAN>&nbsp;item_count_filled<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2727"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2727">2727</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_target<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SafeAddItem<SPAN class="p">(</SPAN>newItem<SPAN class="p">,</SPAN>slotresult<SPAN class="p">.</SPAN>ContainerSlot<SPAN class="p">,</SPAN>&nbsp;slotresult<SPAN class="p">.</SPAN>Slot<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2728"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2728">2728</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2729"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2729">2729</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newItem<SPAN class="o">-&gt;</SPAN>DeleteMe<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2730"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2730">2730</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; item_count <SPAN class="o">=</SPAN>&nbsp;item_count_filled<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2731"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2731">2731</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2732"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2732">2732</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2733"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2733">2733</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_target<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendItemPushResult<SPAN class="p">(</SPAN>newItem<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;slotresult<SPAN class="p">.</SPAN>ContainerSlot<SPAN class="p">,</SPAN>&nbsp;slotresult<SPAN class="p">.</SPAN>Slot<SPAN class="p">,</SPAN>&nbsp;item_count<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2734"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2734">2734</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2735"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2735">2735</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2736"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2736">2736</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L2737"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2737">2737</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2738"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2738">2738</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add<SPAN class="o">-&gt;</SPAN>SetCount<SPAN class="p">(</SPAN>add<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>ITEM_FIELD_STACK_COUNT<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;item_count<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2739"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2739">2739</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add<SPAN class="o">-&gt;</SPAN>m_isDirty <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2740"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2740">2740</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_target<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendItemPushResult<SPAN class="p">(</SPAN>add<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetBagSlotByGuid<SPAN class="p">(</SPAN>add<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()),</SPAN>&nbsp;<SPAN class="mh">0xFFFFFFFF</SPAN><SPAN class="p">,</SPAN>&nbsp;item_count<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2741"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2741">2741</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2742"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2742">2742</A></TH><TD></TR><TR><TH id="L2743"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2743">2743</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*WorldPacket data(45);</SPAN></TD></TR><TR><TH id="L2744"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2744">2744</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster-&gt;GetSession()-&gt;BuildItemPushResult(&amp;data, p_caster-&gt;GetGUID(), 1, item_count, GetProto()-&gt;EffectSpellGroupRelation[i] ,0,0xFF,1,0xFFFFFFFF);</SPAN></TD></TR><TR><TH id="L2745"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2745">2745</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster-&gt;SendMessageToSet(&amp;data, true);*/</SPAN></TD></TR><TR><TH id="L2746"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2746">2746</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2747"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2747">2747</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;skill<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2748"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2748">2748</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2749"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2749">2749</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// skill up</SPAN></TD></TR><TR><TH id="L2750"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2750">2750</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DetermineSkillUp<SPAN class="p">(</SPAN>&nbsp;skill<SPAN class="o">-&gt;</SPAN>skilline <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2751"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2751">2751</A></TH><TD></TR><TR><TH id="L2752"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2752">2752</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// profession discoveries</SPAN></TD></TR><TR><TH id="L2753"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2753">2753</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 discovered_recipe <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2754"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2754">2754</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; std<SPAN class="o">::</SPAN>set<SPAN class="o">&lt;</SPAN>ProfessionDiscovery<SPAN class="o">*&gt;::</SPAN>iterator itr <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>ProfessionDiscoveryTable<SPAN class="p">.</SPAN>begin<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2755"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2755">2755</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">;</SPAN>&nbsp;itr <SPAN class="o">!=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>ProfessionDiscoveryTable<SPAN class="p">.</SPAN>end<SPAN class="p">();</SPAN>&nbsp;itr<SPAN class="o">++</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2756"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2756">2756</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2757"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2757">2757</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ProfessionDiscovery <SPAN class="o">*</SPAN>&nbsp;pf <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">*</SPAN>itr <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2758"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2758">2758</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;pf <SPAN class="o">&amp;&amp;</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;pf<SPAN class="o">-&gt;</SPAN>SpellId <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>_GetSkillLineCurrent<SPAN class="p">(</SPAN>&nbsp;skill<SPAN class="o">-&gt;</SPAN>skilline <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&gt;=</SPAN>&nbsp;pf<SPAN class="o">-&gt;</SPAN>SkillValue <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN>&nbsp;pf<SPAN class="o">-&gt;</SPAN>SpellToDiscover <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;Rand<SPAN class="p">(</SPAN>&nbsp;pf<SPAN class="o">-&gt;</SPAN>Chance <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2759"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2759">2759</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2760"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2760">2760</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; discovered_recipe <SPAN class="o">=</SPAN>&nbsp;pf<SPAN class="o">-&gt;</SPAN>SpellToDiscover<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2761"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2761">2761</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2762"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2762">2762</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2763"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2763">2763</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2764"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2764">2764</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// if something discovered learn p_caster that recipe and broadcast message</SPAN></TD></TR><TR><TH id="L2765"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2765">2765</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;discovered_recipe <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2766"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2766">2766</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2767"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2767">2767</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>&nbsp;se <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;discovered_recipe <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2768"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2768">2768</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;se <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2769"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2769">2769</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2770"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2770">2770</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;discovered_recipe <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2771"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2771">2771</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WorldPacket <SPAN class="o">*</SPAN>&nbsp;data<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2772"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2772">2772</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">char</SPAN>&nbsp;msg<SPAN class="p">[</SPAN><SPAN class="mi">256</SPAN><SPAN class="p">];</SPAN></TD></TR><TR><TH id="L2773"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2773">2773</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sprintf<SPAN class="p">(</SPAN>&nbsp;msg<SPAN class="p">,</SPAN>&nbsp;<SPAN class="s">"%sDISCOVERY! %s has discovered how to create %s.|r"</SPAN><SPAN class="p">,</SPAN>&nbsp;MSG_COLOR_GOLD<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetName<SPAN class="p">(),</SPAN>&nbsp;se<SPAN class="o">-&gt;</SPAN>Name <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2774"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2774">2774</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">=</SPAN>&nbsp;sChatHandler<SPAN class="p">.</SPAN>FillMessageData<SPAN class="p">(</SPAN>&nbsp;CHAT_MSG_SYSTEM<SPAN class="p">,</SPAN>&nbsp;LANG_UNIVERSAL<SPAN class="p">,</SPAN>&nbsp; msg<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2775"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2775">2775</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendChatMessageToCellPlayers<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;data<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;LANG_UNIVERSAL<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2776"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2776">2776</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">delete</SPAN>&nbsp;data<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2777"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2777">2777</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2778"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2778">2778</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2779"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2779">2779</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2780"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2780">2780</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2781"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2781">2781</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2782"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2782">2782</A></TH><TD></TR><TR><TH id="L2783"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2783">2783</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectWeapon<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2784"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2784">2784</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2785"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2785">2785</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2786"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2786">2786</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2787"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2787">2787</A></TH><TD></TR><TR><TH id="L2788"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2788">2788</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 skill <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2789"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2789">2789</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2790"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2790">2790</A></TH><TD></TR><TR><TH id="L2791"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2791">2791</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2792"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2792">2792</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2793"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2793">2793</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">201</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; <SPAN class="c">// one-handed swords</SPAN></TD></TR><TR><TH id="L2794"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2794">2794</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2795"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2795">2795</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_SWORDS<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2796"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2796">2796</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2797"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2797">2797</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">202</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp;<SPAN class="c">// two-handed swords</SPAN></TD></TR><TR><TH id="L2798"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2798">2798</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2799"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2799">2799</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_2H_SWORDS<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2800"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2800">2800</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2801"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2801">2801</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">203</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp;<SPAN class="c">// Unarmed</SPAN></TD></TR><TR><TH id="L2802"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2802">2802</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2803"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2803">2803</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_UNARMED<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2804"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2804">2804</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2805"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2805">2805</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">199</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp;<SPAN class="c">// two-handed maces</SPAN></TD></TR><TR><TH id="L2806"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2806">2806</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2807"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2807">2807</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_2H_MACES<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2808"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2808">2808</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2809"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2809">2809</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">198</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp;<SPAN class="c">// one-handed maces</SPAN></TD></TR><TR><TH id="L2810"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2810">2810</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2811"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2811">2811</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_MACES<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2812"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2812">2812</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2813"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2813">2813</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">197</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp;<SPAN class="c">// two-handed axes</SPAN></TD></TR><TR><TH id="L2814"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2814">2814</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2815"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2815">2815</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_2H_AXES<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2816"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2816">2816</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2817"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2817">2817</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">196</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp;<SPAN class="c">// one-handed axes</SPAN></TD></TR><TR><TH id="L2818"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2818">2818</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2819"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2819">2819</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_AXES<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2820"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2820">2820</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2821"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2821">2821</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">5011</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// crossbows</SPAN></TD></TR><TR><TH id="L2822"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2822">2822</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2823"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2823">2823</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_CROSSBOWS<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2824"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2824">2824</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell <SPAN class="o">=</SPAN>&nbsp;SPELL_RANGED_GENERAL<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2825"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2825">2825</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2826"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2826">2826</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">227</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp;<SPAN class="c">// staves</SPAN></TD></TR><TR><TH id="L2827"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2827">2827</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2828"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2828">2828</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_STAVES<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2829"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2829">2829</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2830"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2830">2830</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">1180</SPAN><SPAN class="o">:</SPAN>&nbsp; <SPAN class="c">// daggers</SPAN></TD></TR><TR><TH id="L2831"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2831">2831</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2832"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2832">2832</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_DAGGERS<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2833"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2833">2833</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2834"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2834">2834</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">200</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp;<SPAN class="c">// polearms</SPAN></TD></TR><TR><TH id="L2835"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2835">2835</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2836"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2836">2836</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_POLEARMS<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2837"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2837">2837</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2838"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2838">2838</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">15590</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// fist weapons</SPAN></TD></TR><TR><TH id="L2839"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2839">2839</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2840"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2840">2840</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_UNARMED<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2841"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2841">2841</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2842"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2842">2842</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">264</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp;<SPAN class="c">// bows</SPAN></TD></TR><TR><TH id="L2843"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2843">2843</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2844"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2844">2844</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_BOWS<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2845"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2845">2845</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell <SPAN class="o">=</SPAN>&nbsp;SPELL_RANGED_GENERAL<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2846"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2846">2846</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2847"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2847">2847</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">266</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// guns</SPAN></TD></TR><TR><TH id="L2848"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2848">2848</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2849"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2849">2849</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_GUNS<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2850"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2850">2850</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell <SPAN class="o">=</SPAN>&nbsp;SPELL_RANGED_GENERAL<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2851"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2851">2851</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2852"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2852">2852</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">2567</SPAN><SPAN class="o">:</SPAN>&nbsp; <SPAN class="c">// thrown</SPAN></TD></TR><TR><TH id="L2853"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2853">2853</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2854"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2854">2854</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_THROWN<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2855"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2855">2855</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2856"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2856">2856</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">5009</SPAN><SPAN class="o">:</SPAN>&nbsp; <SPAN class="c">// wands</SPAN></TD></TR><TR><TH id="L2857"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2857">2857</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2858"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2858">2858</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_WANDS<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2859"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2859">2859</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell <SPAN class="o">=</SPAN>&nbsp;SPELL_RANGED_GENERAL<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2860"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2860">2860</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2861"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2861">2861</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//case 3386:&nbsp; // spears</SPAN></TD></TR><TR><TH id="L2862"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2862">2862</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; skill = 0;&nbsp; &nbsp;// ??!!</SPAN></TD></TR><TR><TH id="L2863"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2863">2863</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; break;</SPAN></TD></TR><TR><TH id="L2864"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2864">2864</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2865"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2865">2865</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2866"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2866">2866</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2867"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2867">2867</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sLog<SPAN class="p">.</SPAN>outDebug<SPAN class="p">(</SPAN><SPAN class="s">"WARNING: Could not determine skill for spell id %d (SPELL_EFFECT_WEAPON)"</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2868"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2868">2868</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2869"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2869">2869</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2870"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2870">2870</A></TH><TD></TR><TR><TH id="L2871"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2871">2871</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Don't add skills to players logging in.</SPAN></TD></TR><TR><TH id="L2872"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2872">2872</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*if((GetProto()-&gt;Attributes &amp; ATTRIBUTES_PASSIVE) &amp;&amp; playerTarget-&gt;m_TeleportState == 1)</SPAN></TD></TR><TR><TH id="L2873"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2873">2873</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; return;*/</SPAN></TD></TR><TR><TH id="L2874"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2874">2874</A></TH><TD></TR><TR><TH id="L2875"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2875">2875</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>skill<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2876"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2876">2876</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2877"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2877">2877</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>spell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2878"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2878">2878</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>spell<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2879"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2879">2879</A></TH><TD></TR><TR><TH id="L2880"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2880">2880</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// if we do not have the skill line</SPAN></TD></TR><TR><TH id="L2881"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2881">2881</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>_HasSkillLine<SPAN class="p">(</SPAN>skill<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L2882"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2882">2882</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2883"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2883">2883</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>_AddSkillLine<SPAN class="p">(</SPAN>skill<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">()</SPAN><SPAN class="o">*</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2884"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2884">2884</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2885"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2885">2885</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="c">// unhandled.... if we have the skill line</SPAN></TD></TR><TR><TH id="L2886"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2886">2886</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2887"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2887">2887</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2888"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2888">2888</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2889"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2889">2889</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2890"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2890">2890</A></TH><TD></TR><TR><TH id="L2891"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2891">2891</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDefense<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2892"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2892">2892</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2893"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2893">2893</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//i think this actually enbles the skill to be able to use defense</SPAN></TD></TR><TR><TH id="L2894"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2894">2894</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//value is static and sets value directly which will be modified by other factors</SPAN></TD></TR><TR><TH id="L2895"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2895">2895</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//this is only basic value and will be overwiten elsewhere !!!</SPAN></TD></TR><TR><TH id="L2896"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2896">2896</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; if(unitTarget-&gt;IsPlayer())</SPAN></TD></TR><TR><TH id="L2897"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2897">2897</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget-&gt;SetFloatValue(UNIT_FIELD_RESISTANCES,damage);</SPAN></TD></TR><TR><TH id="L2898"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2898">2898</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2899"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2899">2899</A></TH><TD></TR><TR><TH id="L2900"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2900">2900</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectPersistentAA<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Persistent Area Aura</SPAN></TD></TR><TR><TH id="L2901"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2901">2901</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2902"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2902">2902</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>m_AreaAura <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L2903"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2903">2903</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2904"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2904">2904</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//create only 1 dyn object</SPAN></TD></TR><TR><TH id="L2905"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2905">2905</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; uint32 dur <SPAN class="o">=</SPAN>&nbsp;GetDuration<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2906"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2906">2906</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;r <SPAN class="o">=</SPAN>&nbsp;GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2907"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2907">2907</A></TH><TD></TR><TR><TH id="L2908"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2908">2908</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Note: this code seems to be useless</SPAN></TD></TR><TR><TH id="L2909"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2909">2909</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//this must be only source point or dest point</SPAN></TD></TR><TR><TH id="L2910"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2910">2910</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//this AREA aura it's apllied on area</SPAN></TD></TR><TR><TH id="L2911"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2911">2911</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//it can'be on unit or self or item or object</SPAN></TD></TR><TR><TH id="L2912"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2912">2912</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//uncomment it if i'm wrong</SPAN></TD></TR><TR><TH id="L2913"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2913">2913</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//We are thinking in general so it might be useful later DK</SPAN></TD></TR><TR><TH id="L2914"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2914">2914</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L2915"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2915">2915</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// grep: this is a hack!</SPAN></TD></TR><TR><TH id="L2916"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2916">2916</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// our shitty dynobj system doesnt support GO casters, so we gotta</SPAN></TD></TR><TR><TH id="L2917"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2917">2917</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// kinda have 2 summoners for traps that apply AA.</SPAN></TD></TR><TR><TH id="L2918"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2918">2918</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; DynamicObject <SPAN class="o">*</SPAN>&nbsp;dynObj <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateDynamicObject<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2919"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2919">2919</A></TH><TD></TR><TR><TH id="L2920"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2920">2920</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>g_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;g_caster<SPAN class="o">-&gt;</SPAN>m_summoner <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2921"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2921">2921</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2922"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2922">2922</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Unit <SPAN class="o">*</SPAN>&nbsp;caster <SPAN class="o">=</SPAN>&nbsp;g_caster<SPAN class="o">-&gt;</SPAN>m_summoner<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2923"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2923">2923</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>Create<SPAN class="p">(</SPAN>caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">,</SPAN>&nbsp;g_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;g_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN></TD></TR><TR><TH id="L2924"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2924">2924</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">(),</SPAN>&nbsp;dur<SPAN class="p">,</SPAN>&nbsp;r<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2925"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2925">2925</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_AreaAura <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2926"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2926">2926</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2927"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2927">2927</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2928"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2928">2928</A></TH><TD></TR><TR><TH id="L2929"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2929">2929</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>m_targets<SPAN class="p">.</SPAN>m_targetMask<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2930"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2930">2930</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2931"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2931">2931</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">TARGET_FLAG_SELF:</SPAN></TD></TR><TR><TH id="L2932"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2932">2932</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2933"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2933">2933</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>Create<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">,</SPAN>&nbsp; m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN></TD></TR><TR><TH id="L2934"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2934">2934</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">(),</SPAN>&nbsp;dur<SPAN class="p">,</SPAN>r<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2935"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2935">2935</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2936"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2936">2936</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">TARGET_FLAG_UNIT:</SPAN></TD></TR><TR><TH id="L2937"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2937">2937</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2938"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2938">2938</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="o">||!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L2939"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2939">2939</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2940"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2940">2940</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>Create<SPAN class="p">(</SPAN>&nbsp;u_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">(),</SPAN></TD></TR><TR><TH id="L2941"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2941">2941</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dur<SPAN class="p">,</SPAN>&nbsp;r<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2942"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2942">2942</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2943"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2943">2943</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">TARGET_FLAG_OBJECT:</SPAN></TD></TR><TR><TH id="L2944"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2944">2944</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2945"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2945">2945</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2946"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2946">2946</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2947"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2947">2947</A></TH><TD></TR><TR><TH id="L2948"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2948">2948</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>Create<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">(),</SPAN></TD></TR><TR><TH id="L2949"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2949">2949</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dur<SPAN class="p">,</SPAN>&nbsp;r<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2950"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2950">2950</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2951"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2951">2951</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">TARGET_FLAG_SOURCE_LOCATION:</SPAN></TD></TR><TR><TH id="L2952"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2952">2952</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2953"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2953">2953</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>SetInstanceID<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L2954"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2954">2954</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>Create<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">,</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_srcX<SPAN class="p">,</SPAN></TD></TR><TR><TH id="L2955"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2955">2955</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_targets<SPAN class="p">.</SPAN>m_srcY<SPAN class="p">,</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_srcZ<SPAN class="p">,</SPAN>&nbsp;dur<SPAN class="p">,</SPAN>r<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2956"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2956">2956</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2957"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2957">2957</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">TARGET_FLAG_DEST_LOCATION:</SPAN></TD></TR><TR><TH id="L2958"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2958">2958</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2959"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2959">2959</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>SetInstanceID<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L2960"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2960">2960</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>Create<SPAN class="p">(</SPAN>u_caster<SPAN class="o">?</SPAN><SPAN class="nl">u_caster:</SPAN>g_caster<SPAN class="o">-&gt;</SPAN>m_summoner<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">,</SPAN></TD></TR><TR><TH id="L2961"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2961">2961</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_targets<SPAN class="p">.</SPAN>m_destX<SPAN class="p">,</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY<SPAN class="p">,</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ<SPAN class="p">,</SPAN>dur<SPAN class="p">,</SPAN>r<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2962"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2962">2962</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2963"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2963">2963</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2964"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2964">2964</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2965"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2965">2965</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2966"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2966">2966</A></TH><TD></TR><TR><TH id="L2967"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2967">2967</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2968"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2968">2968</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>ChannelInterruptFlags <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2969"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2969">2969</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2970"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2970">2970</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>UNIT_FIELD_CHANNEL_OBJECT<SPAN class="p">,</SPAN>dynObj<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L2971"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2971">2971</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_CHANNEL_SPELL<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L2972"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2972">2972</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2973"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2973">2973</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_AreaAura <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2974"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2974">2974</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2975"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2975">2975</A></TH><TD></TR><TR><TH id="L2976"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2976">2976</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummon<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L2977"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2977">2977</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2978"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2978">2978</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>EffectMiscValueB<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L2979"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2979">2979</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L2980"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2980">2980</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">63</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2981"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2981">2981</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">81</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2982"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2982">2982</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">82</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2983"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2983">2983</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">83</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2984"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2984">2984</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">121</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;SpellEffectSummonTotem<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2985"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2985">2985</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">41</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2986"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2986">2986</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">407</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;SpellEffectSummonCritter<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN>&nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2987"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2987">2987</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">61</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2988"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2988">2988</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">669</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2989"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2989">2989</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">881</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;SpellEffectSummonGuardian<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN>&nbsp; &nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2990"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2990">2990</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">64</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; SpellEffectSummonWild<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2991"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2991">2991</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">65</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L2992"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2992">2992</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">428</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;SpellEffectSummonPossessed<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN>&nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2993"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2993">2993</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">66</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; SpellEffectSummonDemon<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2994"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2994">2994</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L2995"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2995">2995</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L2996"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2996">2996</A></TH><TD></TR><TR><TH id="L2997"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2997">2997</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">24207</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Tempfix</SPAN></TD></TR><TR><TH id="L2998"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2998">2998</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>RemoveFieldSummon<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L2999"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L2999">2999</A></TH><TD></TR><TR><TH id="L3000"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3000">3000</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* This is for summon water elemenal, etc */</SPAN></TD></TR><TR><TH id="L3001"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3001">3001</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L3002"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3002">3002</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CreatureProto <SPAN class="o">*</SPAN>&nbsp;cp <SPAN class="o">=</SPAN>&nbsp;CreatureProtoStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L3003"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3003">3003</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>ci <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>cp <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3004"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3004">3004</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3005"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3005">3005</A></TH><TD></TR><TR><TH id="L3006"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3006">3006</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3007"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3007">3007</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3008"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3008">3008</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">510</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// Water Elemental</SPAN></TD></TR><TR><TH id="L3009"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3009">3009</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3010"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3010">3010</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>summon <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>CreatePet<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L3011"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3011">3011</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>CreateAsSummon<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;ci<SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3012"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3012">3012</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">31707</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3013"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3013">3013</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">33395</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3014"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3014">3014</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3015"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3015">3015</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">29264</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Feral Spirit</SPAN></TD></TR><TR><TH id="L3016"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3016">3016</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3017"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3017">3017</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L3018"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3018">3018</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Feral Spirit</SPAN></TD></TR><TR><TH id="L3019"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3019">3019</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12% of base mana&nbsp; &nbsp; &nbsp; &nbsp; 30 yd range</SPAN></TD></TR><TR><TH id="L3020"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3020">3020</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Instant cast&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3 min cooldown</SPAN></TD></TR><TR><TH id="L3021"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3021">3021</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Summons two Spirit Wolves under the command of the Shaman, lasting 45 sec.</SPAN></TD></TR><TR><TH id="L3022"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3022">3022</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L3023"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3023">3023</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//First wolf</SPAN></TD></TR><TR><TH id="L3024"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3024">3024</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>summon <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>CreatePet<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L3025"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3025">3025</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>CreateAsSummon<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;ci<SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">4</SPAN><SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3026"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3026">3026</A></TH><TD></TR><TR><TH id="L3027"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3027">3027</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Second wolf</SPAN></TD></TR><TR><TH id="L3028"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3028">3028</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>summon2 <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>CreatePet<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L3029"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3029">3029</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon2<SPAN class="o">-&gt;</SPAN>CreateAsSummon<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;ci<SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">4</SPAN><SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3030"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3030">3030</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon2<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetUnitToFollow<SPAN class="p">(</SPAN>p_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3031"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3031">3031</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon2<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetUnitToFollowAngle<SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN><SPAN class="o">-</SPAN><SPAN class="p">(</SPAN>M_PI<SPAN class="o">/</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">)));</SPAN></TD></TR><TR><TH id="L3032"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3032">3032</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </TD></TR><TR><TH id="L3033"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3033">3033</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Spells</SPAN></TD></TR><TR><TH id="L3034"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3034">3034</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">58877</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Spirit Hunt</SPAN></TD></TR><TR><TH id="L3035"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3035">3035</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">58875</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Spirit walk</SPAN></TD></TR><TR><TH id="L3036"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3036">3036</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">58857</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Twin Howl</SPAN></TD></TR><TR><TH id="L3037"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3037">3037</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">58861</SPAN><SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Spirit Bash</SPAN></TD></TR><TR><TH id="L3038"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3038">3038</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3039"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3039">3039</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27893</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Dancing Rune Weapon</SPAN></TD></TR><TR><TH id="L3040"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3040">3040</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3041"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3041">3041</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L3042"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3042">3042</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dancing Rune Weapon</SPAN></TD></TR><TR><TH id="L3043"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3043">3043</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 40 Runic Power&nbsp; 30 yd range</SPAN></TD></TR><TR><TH id="L3044"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3044">3044</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Instant 3 min cooldown</SPAN></TD></TR><TR><TH id="L3045"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3045">3045</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Requires Melee Weapon</SPAN></TD></TR><TR><TH id="L3046"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3046">3046</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Unleashes all available runic power to summon a second rune weapon</SPAN></TD></TR><TR><TH id="L3047"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3047">3047</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; that fights on its own for 10 sec plus 1 sec per 5 additional runic power,</SPAN></TD></TR><TR><TH id="L3048"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3048">3048</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; doing the same attacks as the Death Knight.</SPAN></TD></TR><TR><TH id="L3049"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3049">3049</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L3050"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3050">3050</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 duration <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">10000</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3051"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3051">3051</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 curPow <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER7<SPAN class="p">)</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3052"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3052">3052</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 extradur <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>duration<SPAN class="o">+</SPAN><SPAN class="p">(</SPAN>curPow<SPAN class="o">/</SPAN><SPAN class="mf">50.0f</SPAN><SPAN class="p">));</SPAN></TD></TR><TR><TH id="L3053"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3053">3053</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Item <SPAN class="o">*</SPAN>&nbsp;item <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetInventoryItem<SPAN class="p">(</SPAN>&nbsp;EQUIPMENT_SLOT_MAINHAND <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3054"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3054">3054</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 mitemID <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3055"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3055">3055</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>item<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3056"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3056">3056</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mitemID <SPAN class="o">=</SPAN>&nbsp;item<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3057"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3057">3057</A></TH><TD></TR><TR><TH id="L3058"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3058">3058</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>summon <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>CreatePet<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L3059"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3059">3059</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>CreateAsSummon<SPAN class="p">(</SPAN><SPAN class="mi">26125</SPAN><SPAN class="p">,</SPAN>&nbsp;ci<SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;extradur <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3060"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3060">3060</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_DISPLAYID<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN><SPAN class="mi">15435</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3061"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3061">3061</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_VIRTUAL_ITEM_SLOT_ID<SPAN class="p">,</SPAN>&nbsp;mitemID <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3062"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3062">3062</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_BASEATTACKTIME<SPAN class="p">,</SPAN>&nbsp;item<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Delay<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3063"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3063">3063</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MINDAMAGE<SPAN class="p">,(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">)</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetDamageDoneMod<SPAN class="p">(</SPAN>SCHOOL_NORMAL<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L3064"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3064">3064</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MAXDAMAGE<SPAN class="p">,(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">)</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetDamageDoneMod<SPAN class="p">(</SPAN>SCHOOL_NORMAL<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L3065"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3065">3065</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetUnitToFollowAngle<SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN><SPAN class="o">-</SPAN><SPAN class="p">(</SPAN>M_PI<SPAN class="o">/</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">)));</SPAN></TD></TR><TR><TH id="L3066"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3066">3066</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER7<SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Drains all runic power.</SPAN></TD></TR><TR><TH id="L3067"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3067">3067</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3068"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3068">3068</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3069"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3069">3069</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3070"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3070">3070</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>&nbsp;pCreature <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateCreature<SPAN class="p">(</SPAN>cp<SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3071"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3071">3071</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ASSERT<SPAN class="p">(</SPAN>pCreature <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3072"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3072">3072</A></TH><TD></TR><TR><TH id="L3073"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3073">3073</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>Load<SPAN class="p">(</SPAN>cp<SPAN class="p">,</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3074"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3074">3074</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>_setFaction<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3075"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3075">3075</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>AITYPE_PET<SPAN class="p">,</SPAN>MOVEMENTTYPE_NONE<SPAN class="p">,</SPAN>u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3076"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3076">3076</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetUnitToFollow<SPAN class="p">(</SPAN>u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3077"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3077">3077</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetUnitToFollowAngle<SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN><SPAN class="o">-</SPAN><SPAN class="p">(</SPAN>M_PI<SPAN class="o">/</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">)));</SPAN></TD></TR><TR><TH id="L3078"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3078">3078</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetFollowDistance<SPAN class="p">(</SPAN>GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L3079"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3079">3079</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_LEVEL<SPAN class="p">,</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3080"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3080">3080</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_FACTIONTEMPLATE<SPAN class="p">,</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_FACTIONTEMPLATE<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L3081"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3081">3081</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>_setFaction<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3082"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3082">3082</A></TH><TD></TR><TR><TH id="L3083"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3083">3083</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>UNIT_FIELD_SUMMONEDBY<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3084"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3084">3084</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>UNIT_FIELD_CREATEDBY<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3085"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3085">3085</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>UNIT_FIELD_SUMMON<SPAN class="p">,</SPAN>&nbsp;pCreature<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3086"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3086">3086</A></TH><TD></TR><TR><TH id="L3087"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3087">3087</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 MiscValue <SPAN class="o">=</SPAN>&nbsp;m_spellInfo<SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L3088"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3088">3088</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;MiscValue <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">19668</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//shadowfiend</SPAN></TD></TR><TR><TH id="L3089"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3089">3089</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3090"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3090">3090</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;parent_bonus <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">)(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetDamageDoneMod<SPAN class="p">(</SPAN>SCHOOL_SHADOW<SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="mf">0.065f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3091"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3091">3091</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MINDAMAGE<SPAN class="p">,</SPAN>&nbsp;pCreature<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MINDAMAGE<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;parent_bonus<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3092"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3092">3092</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MAXDAMAGE<SPAN class="p">,</SPAN>&nbsp;pCreature<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MAXDAMAGE<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;parent_bonus<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3093"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3093">3093</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>BaseDamage<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">+=</SPAN>&nbsp;parent_bonus<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3094"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3094">3094</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>BaseDamage<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">+=</SPAN>&nbsp;parent_bonus<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3095"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3095">3095</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Unit<SPAN class="o">*</SPAN>&nbsp;uTarget <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetUnit<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetSelection<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3096"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3096">3096</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;uTarget <SPAN class="o">&amp;&amp;</SPAN>&nbsp;isAttackable<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;uTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3097"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3097">3097</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3098"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3098">3098</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttackReaction<SPAN class="p">(</SPAN>&nbsp;uTarget<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3099"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3099">3099</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetNextTarget<SPAN class="p">(</SPAN>&nbsp;uTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3100"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3100">3100</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3101"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3101">3101</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3102"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3102">3102</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;MiscValue <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">24207</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Army of the dead ghoul.</SPAN></TD></TR><TR><TH id="L3103"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3103">3103</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3104"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3104">3104</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;parent_bonus <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">)(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetDamageDoneMod<SPAN class="p">(</SPAN>SCHOOL_NORMAL<SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="mf">0.04f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3105"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3105">3105</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;pi_rand <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">((</SPAN>int32<SPAN class="p">)(</SPAN>rand<SPAN class="p">()</SPAN><SPAN class="o">-</SPAN>RAND_MAX<SPAN class="o">*</SPAN><SPAN class="mf">0.5f</SPAN><SPAN class="p">)</SPAN><SPAN class="o">%</SPAN><SPAN class="mi">15707</SPAN><SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="mf">10000.0f</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// should be random enough.</SPAN></TD></TR><TR><TH id="L3106"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3106">3106</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MINDAMAGE<SPAN class="p">,</SPAN>&nbsp;pCreature<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MINDAMAGE<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;parent_bonus<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3107"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3107">3107</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MAXDAMAGE<SPAN class="p">,</SPAN>&nbsp;pCreature<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_MAXDAMAGE<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;parent_bonus<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3108"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3108">3108</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetUnitToFollowAngle<SPAN class="p">(</SPAN>pi_rand<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3109"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3109">3109</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetFollowDistance<SPAN class="p">(</SPAN><SPAN class="mf">3.0f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3110"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3110">3110</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;x<SPAN class="p">,</SPAN>y<SPAN class="p">,</SPAN>z<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3111"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3111">3111</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">()</SPAN><SPAN class="o">+</SPAN>rand<SPAN class="p">()</SPAN><SPAN class="o">%</SPAN><SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3112"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3112">3112</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN><SPAN class="o">+</SPAN>rand<SPAN class="p">()</SPAN><SPAN class="o">%</SPAN><SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3113"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3113">3113</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; z <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3114"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3114">3114</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetPosition<SPAN class="p">(</SPAN>x<SPAN class="p">,</SPAN>y<SPAN class="p">,</SPAN>z<SPAN class="p">,</SPAN><SPAN class="mf">0.0f</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3115"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3115">3115</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN><SPAN class="mi">50142</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3116"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3116">3116</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3117"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3117">3117</A></TH><TD></TR><TR><TH id="L3118"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3118">3118</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;MiscValue <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">31893</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;MiscValue <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">31894</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;MiscValue <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">31895</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;MiscValue <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">31896</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;MiscValue <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">31897</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;MiscValue <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">31883</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Light wells!</SPAN></TD></TR><TR><TH id="L3119"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3119">3119</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3120"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3120">3120</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">59907</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3121"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3121">3121</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Creature<SPAN class="o">::</SPAN>SafeDelete<SPAN class="p">,</SPAN>&nbsp;EVENT_CREATURE_REMOVE_CORPSE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">180000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3122"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3122">3122</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3123"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3123">3123</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3124"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3124">3124</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3125"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3125">3125</A></TH><TD></TR><TR><TH id="L3126"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3126">3126</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Creature<SPAN class="o">::</SPAN>SafeDelete<SPAN class="p">,</SPAN>&nbsp;EVENT_CREATURE_REMOVE_CORPSE<SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3127"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3127">3127</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3128"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3128">3128</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3129"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3129">3129</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3130"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3130">3130</A></TH><TD></TR><TR><TH id="L3131"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3131">3131</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectLeap<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Leap</SPAN></TD></TR><TR><TH id="L3132"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3132">3132</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3133"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3133">3133</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;radius <SPAN class="o">=</SPAN>&nbsp;GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3134"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3134">3134</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// remove movement impeding auras</SPAN></TD></TR><TR><TH id="L3135"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3135">3135</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>RemoveAurasByInterruptFlag<SPAN class="p">(</SPAN>AURA_INTERRUPT_ON_ANY_DAMAGE_TAKEN<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3136"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3136">3136</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// cebernic: 2008-10-11</SPAN></TD></TR><TR><TH id="L3137"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3137">3137</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// thanks for the guys who gave the suggestions to my private forum(p2wow.com)</SPAN></TD></TR><TR><TH id="L3138"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3138">3138</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Blink works perfectly atm.Features:no traversed / never outspace falling:D / calc right everwhere even multi floors or underground / much blizzlike.</SPAN></TD></TR><TR><TH id="L3139"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3139">3139</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// a couple hours i wasted, so it full tested.</SPAN></TD></TR><TR><TH id="L3140"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3140">3140</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L3141"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3141">3141</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>sWorld<SPAN class="p">.</SPAN>Collision<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3142"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3142">3142</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_bg <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>m_bg<SPAN class="o">-&gt;</SPAN>HasStarted<SPAN class="p">())</SPAN>&nbsp;<SPAN class="c">// tempfix</SPAN></TD></TR><TR><TH id="L3143"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3143">3143</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3144"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3144">3144</A></TH><TD></TR><TR><TH id="L3145"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3145">3145</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;_UNDERGROUND&nbsp; &nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="mh">0x2</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3146"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3146">3146</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;_COLLIDED&nbsp; &nbsp; &nbsp; <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mh">0x4</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3147"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3147">3147</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;_LAND_BREAK&nbsp; &nbsp; <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mh">0x8</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3148"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3148">3148</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;_POS_BREAK&nbsp; &nbsp; &nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="mh">0x10</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3149"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3149">3149</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;_BLOCK_BREAK&nbsp; &nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="mh">0x20</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3150"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3150">3150</A></TH><TD></TR><TR><TH id="L3151"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3151">3151</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;flag<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3152"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3152">3152</A></TH><TD></TR><TR><TH id="L3153"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3153">3153</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;newposX<SPAN class="p">,</SPAN>&nbsp;newposY<SPAN class="p">,</SPAN>&nbsp;newposZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3154"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3154">3154</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// init first variables</SPAN></TD></TR><TR><TH id="L3155"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3155">3155</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;ori <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3156"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3156">3156</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;posX <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3157"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3157">3157</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;posY <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3158"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3158">3158</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;posZ <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3159"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3159">3159</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>IsUnderground<SPAN class="p">(</SPAN>posX<SPAN class="p">,</SPAN>posY<SPAN class="p">,</SPAN>posZ<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN><SPAN class="c">// make sure not eq.</SPAN></TD></TR><TR><TH id="L3160"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3160">3160</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flag <SPAN class="o">|=</SPAN>&nbsp;_UNDERGROUND<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3161"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3161">3161</A></TH><TD></TR><TR><TH id="L3162"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3162">3162</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LocationVector src<SPAN class="p">(</SPAN>posX<SPAN class="p">,</SPAN>posY<SPAN class="p">,</SPAN>posZ<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3163"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3163">3163</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LocationVector finaldest<SPAN class="p">(</SPAN>posX<SPAN class="p">,</SPAN>posY<SPAN class="p">,</SPAN>posZ<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3164"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3164">3164</A></TH><TD></TR><TR><TH id="L3165"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3165">3165</A></TH><TD></TR><TR><TH id="L3166"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3166">3166</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint8 steps <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// heigher percision,but more performance waste,radius =20.0f may each 1y will be checked.</SPAN></TD></TR><TR><TH id="L3167"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3167">3167</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;radius_steps <SPAN class="o">=</SPAN>&nbsp;radius <SPAN class="o">/</SPAN>&nbsp;steps<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3168"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3168">3168</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint8 i <SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3169"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3169">3169</A></TH><TD></TR><TR><TH id="L3170"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3170">3170</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;_SharpCounter <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3171"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3171">3171</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;i <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN>&nbsp;i <SPAN class="o">&lt;</SPAN>&nbsp;steps<SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">++</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3172"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3172">3172</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3173"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3173">3173</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newposX <SPAN class="o">=</SPAN>&nbsp;posX <SPAN class="o">+</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;radius_steps <SPAN class="o">*</SPAN>&nbsp;cosf<SPAN class="p">(</SPAN>&nbsp;ori <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3174"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3174">3174</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newposY <SPAN class="o">=</SPAN>&nbsp;posY <SPAN class="o">+</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;radius_steps <SPAN class="o">*</SPAN>&nbsp;sinf<SPAN class="p">(</SPAN>&nbsp;ori <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3175"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3175">3175</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newposZ <SPAN class="o">=</SPAN>&nbsp; m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetFirstZWithCPZ<SPAN class="p">(</SPAN>newposX<SPAN class="p">,</SPAN>newposY<SPAN class="p">,</SPAN>posZ<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3176"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3176">3176</A></TH><TD></TR><TR><TH id="L3177"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3177">3177</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;newposZ <SPAN class="o">!=</SPAN>&nbsp;NO_WMO_HEIGHT <SPAN class="p">)</SPAN>&nbsp;flag <SPAN class="o">|=</SPAN>&nbsp;_COLLIDED<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3178"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3178">3178</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>flag <SPAN class="o">&amp;</SPAN>&nbsp;_COLLIDED<SPAN class="p">){</SPAN></TD></TR><TR><TH id="L3179"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3179">3179</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;newposZ <SPAN class="o">==</SPAN>&nbsp;NO_WMO_HEIGHT <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN>&nbsp;<SPAN class="c">// been round 2</SPAN></TD></TR><TR><TH id="L3180"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3180">3180</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flag <SPAN class="o">|=</SPAN>&nbsp;_LAND_BREAK<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3181"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3181">3181</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3182"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3182">3182</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3183"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3183">3183</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">else</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3184"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3184">3184</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newposZ <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetLandHeight<SPAN class="p">(</SPAN>newposX<SPAN class="p">,</SPAN>newposY<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3185"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3185">3185</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3186"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3186">3186</A></TH><TD></TR><TR><TH id="L3187"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3187">3187</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;fabs<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;newposZ <SPAN class="o">-</SPAN>&nbsp;finaldest<SPAN class="p">.</SPAN>z <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;radius_steps <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN>flag <SPAN class="o">|=</SPAN>&nbsp;_POS_BREAK<SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;}</SPAN>&nbsp;<SPAN class="c">// too heigh</SPAN></TD></TR><TR><TH id="L3188"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3188">3188</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L3189"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3189">3189</A></TH><TD></TR><TR><TH id="L3190"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3190">3190</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LocationVector dest<SPAN class="p">(</SPAN>newposX<SPAN class="p">,</SPAN>newposY<SPAN class="p">,</SPAN>newposZ<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3191"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3191">3191</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dest<SPAN class="p">.</SPAN>o <SPAN class="o">=</SPAN>&nbsp;ori<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3192"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3192">3192</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;i<SPAN class="o">&gt;</SPAN><SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;CollideInterface<SPAN class="p">.</SPAN>GetFirstPoint<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">(),</SPAN>src<SPAN class="p">,</SPAN>&nbsp;dest<SPAN class="p">,</SPAN>dest<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">-</SPAN><SPAN class="mf">1.5f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN>flag <SPAN class="o">|=</SPAN>&nbsp;_BLOCK_BREAK<SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;}</SPAN>&nbsp;<SPAN class="c">// blocked then break;</SPAN></TD></TR><TR><TH id="L3193"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3193">3193</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L3194"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3194">3194</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;newposZ <SPAN class="o">&gt;</SPAN>&nbsp;finaldest<SPAN class="p">.</SPAN>z <SPAN class="p">){</SPAN></TD></TR><TR><TH id="L3195"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3195">3195</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _SharpCounter <SPAN class="o">=</SPAN>&nbsp;_SharpCounter<SPAN class="o">+</SPAN><SPAN class="p">(</SPAN>newposZ <SPAN class="o">-</SPAN>&nbsp;finaldest<SPAN class="p">.</SPAN>z<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// this value reserved for more extends.</SPAN></TD></TR><TR><TH id="L3196"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3196">3196</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3197"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3197">3197</A></TH><TD></TR><TR><TH id="L3198"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3198">3198</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//printf("x:%f y:%f z:%f counter%d sharp%f\n",newposX,newposY,newposZ,i,_SharpCounter );</SPAN></TD></TR><TR><TH id="L3199"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3199">3199</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L3200"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3200">3200</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; finaldest<SPAN class="p">.</SPAN>x <SPAN class="o">=</SPAN>&nbsp;newposX<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3201"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3201">3201</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; finaldest<SPAN class="p">.</SPAN>y <SPAN class="o">=</SPAN>&nbsp;newposY<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3202"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3202">3202</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; finaldest<SPAN class="p">.</SPAN>z <SPAN class="o">=</SPAN>&nbsp;newposZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3203"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3203">3203</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3204"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3204">3204</A></TH><TD></TR><TR><TH id="L3205"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3205">3205</A></TH><TD></TR><TR><TH id="L3206"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3206">3206</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*if ( flag &amp; _UNDERGROUND ) printf("_UNDERGROUND 1\n");</SPAN></TD></TR><TR><TH id="L3207"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3207">3207</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( flag &amp; _COLLIDED ) printf("_COLLIDED 1\n");</SPAN></TD></TR><TR><TH id="L3208"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3208">3208</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( flag &amp; _LAND_BREAK ) printf("_LAND_BREAK 1\n");</SPAN></TD></TR><TR><TH id="L3209"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3209">3209</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( flag &amp; _POS_BREAK ) printf("_POS_BREAK 1\n");</SPAN></TD></TR><TR><TH id="L3210"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3210">3210</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( flag &amp; _BLOCK_BREAK ) printf("_BLOCK_BREAK 1\n");*/</SPAN></TD></TR><TR><TH id="L3211"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3211">3211</A></TH><TD></TR><TR><TH id="L3212"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3212">3212</A></TH><TD></TR><TR><TH id="L3213"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3213">3213</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;i <SPAN class="o">&lt;</SPAN><SPAN class="mi">3</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//wallhack?</SPAN></TD></TR><TR><TH id="L3214"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3214">3214</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L3215"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3215">3215</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN><SPAN class="p">(</SPAN>flag <SPAN class="o">&amp;</SPAN>&nbsp;_UNDERGROUND<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3216"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3216">3216</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3217"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3217">3217</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newposZ <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetLandHeight<SPAN class="p">(</SPAN>&nbsp;finaldest<SPAN class="p">.</SPAN>x<SPAN class="p">,</SPAN>finaldest<SPAN class="p">.</SPAN>y <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3218"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3218">3218</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;newposZ <SPAN class="o">&gt;</SPAN>&nbsp;finaldest<SPAN class="p">.</SPAN>z <SPAN class="p">)</SPAN>&nbsp;finaldest<SPAN class="p">.</SPAN>z <SPAN class="o">=</SPAN>&nbsp;newposZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3219"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3219">3219</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3220"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3220">3220</A></TH><TD></TR><TR><TH id="L3221"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3221">3221</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN><SPAN class="p">(</SPAN>flag<SPAN class="o">&amp;</SPAN>_COLLIDED<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="p">(</SPAN>flag<SPAN class="o">&amp;</SPAN>_POS_BREAK<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3222"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3222">3222</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// just test again ,landheight wasn't strictly, collision system better;p</SPAN></TD></TR><TR><TH id="L3223"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3223">3223</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// so it makes you on falling.</SPAN></TD></TR><TR><TH id="L3224"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3224">3224</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newposX <SPAN class="o">=</SPAN>&nbsp;posX <SPAN class="o">+</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">((</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;radius_steps<SPAN class="p">)</SPAN><SPAN class="o">+</SPAN><SPAN class="mf">0.5f</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;cosf<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3225"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3225">3225</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newposY <SPAN class="o">=</SPAN>&nbsp;posY <SPAN class="o">+</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">((</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;radius_steps<SPAN class="p">)</SPAN><SPAN class="o">+</SPAN><SPAN class="mf">0.5f</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;sinf<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3226"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3226">3226</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newposZ <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetLandHeight<SPAN class="p">(</SPAN>newposX<SPAN class="p">,</SPAN>newposY<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3227"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3227">3227</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;newposZ <SPAN class="o">&gt;</SPAN>&nbsp;finaldest<SPAN class="p">.</SPAN>z <SPAN class="p">)</SPAN>&nbsp;finaldest<SPAN class="p">.</SPAN>z <SPAN class="o">=</SPAN>&nbsp;finaldest<SPAN class="p">.</SPAN>z<SPAN class="o">+</SPAN><SPAN class="mf">4.0f</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// taking big Z</SPAN></TD></TR><TR><TH id="L3228"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3228">3228</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3229"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3229">3229</A></TH><TD></TR><TR><TH id="L3230"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3230">3230</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; finaldest<SPAN class="p">.</SPAN>o <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3231"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3231">3231</A></TH><TD></TR><TR><TH id="L3232"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3232">3232</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3233"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3233">3233</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3234"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3234">3234</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>blinked <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3235"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3235">3235</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SafeTeleport<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">(),</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">(),</SPAN>&nbsp;finaldest <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3236"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3236">3236</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3237"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3237">3237</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3238"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3238">3238</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3239"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3239">3239</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>SetPosition<SPAN class="p">(</SPAN>finaldest<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3240"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3240">3240</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3241"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3241">3241</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN>&nbsp;<SPAN class="k">else</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3242"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3242">3242</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3243"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3243">3243</A></TH><TD></TR><TR><TH id="L3244"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3244">3244</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_MOVE_KNOCK_BACK<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">50</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3245"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3245">3245</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3246"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3246">3246</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;getMSTime<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3247"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3247">3247</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;cosf<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">())</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;sinf<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3248"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3248">3248</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;radius<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3249"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3249">3249</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN><SPAN class="o">-</SPAN><SPAN class="mf">10.0f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3250"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3250">3250</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendPacket<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3251"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3251">3251</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3252"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3252">3252</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3253"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3253">3253</A></TH><TD></TR><TR><TH id="L3254"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3254">3254</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectEnergize<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Energize</SPAN></TD></TR><TR><TH id="L3255"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3255">3255</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3256"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3256">3256</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L3257"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3257">3257</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3258"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3258">3258</A></TH><TD></TR><TR><TH id="L3259"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3259">3259</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 modEnergy <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3260"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3260">3260</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//yess there is always someone special : shamanistic rage - talent</SPAN></TD></TR><TR><TH id="L3261"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3261">3261</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">30824</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3262"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3262">3262</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="o">*</SPAN>GetUnitTarget<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetAP<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3263"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3263">3263</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//paladin illumination</SPAN></TD></TR><TR><TH id="L3264"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3264">3264</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">20272</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;ProcedOnSpell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3265"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3265">3265</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3266"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3266">3266</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>motherspell <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>pSpellId<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3267"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3267">3267</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>motherspell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3268"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3268">3268</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>motherspell<SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN><SPAN class="o">*</SPAN>ProcedOnSpell<SPAN class="o">-&gt;</SPAN>manaCost <SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3269"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3269">3269</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3270"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3270">3270</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//paladin - Spiritual Attunement</SPAN></TD></TR><TR><TH id="L3271"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3271">3271</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">31786</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;ProcedOnSpell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3272"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3272">3272</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3273"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3273">3273</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>motherspell <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>pSpellId<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3274"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3274">3274</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>motherspell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3275"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3275">3275</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3276"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3276">3276</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//heal amount from procspell (we only proced on a heal spell)</SPAN></TD></TR><TR><TH id="L3277"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3277">3277</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 healamt <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3278"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3278">3278</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>ProcedOnSpell<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_HEAL <SPAN class="o">||</SPAN>&nbsp;ProcedOnSpell<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_SCRIPT_EFFECT<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3279"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3279">3279</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; healamt<SPAN class="o">=</SPAN>ProcedOnSpell<SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3280"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3280">3280</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>ProcedOnSpell<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_HEAL <SPAN class="o">||</SPAN>&nbsp;ProcedOnSpell<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_SCRIPT_EFFECT<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3281"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3281">3281</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; healamt<SPAN class="o">=</SPAN>ProcedOnSpell<SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3282"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3282">3282</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>ProcedOnSpell<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_HEAL <SPAN class="o">||</SPAN>&nbsp;ProcedOnSpell<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_SCRIPT_EFFECT<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3283"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3283">3283</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; healamt <SPAN class="o">=</SPAN>&nbsp;ProcedOnSpell<SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3284"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3284">3284</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>motherspell<SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN>healamt<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3285"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3285">3285</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3286"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3286">3286</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3287"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3287">3287</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">2687</SPAN><SPAN class="p">){</SPAN></TD></TR><TR><TH id="L3288"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3288">3288</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3289"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3289">3289</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3290"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3290">3290</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3291"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3291">3291</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*for(set&lt;uint32&gt;::iterator itr = p_caster-&gt;mSpells.begin(); itr != p_caster-&gt;mSpells.end(); ++itr)</SPAN></TD></TR><TR><TH id="L3292"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3292">3292</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L3293"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3293">3293</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(*itr == 12818)</SPAN></TD></TR><TR><TH id="L3294"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3294">3294</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy += 60;</SPAN></TD></TR><TR><TH id="L3295"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3295">3295</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if(*itr == 12301)</SPAN></TD></TR><TR><TH id="L3296"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3296">3296</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy += 30;</SPAN></TD></TR><TR><TH id="L3297"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3297">3297</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }*/</SPAN></TD></TR><TR><TH id="L3298"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3298">3298</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>mSpells<SPAN class="p">.</SPAN>find<SPAN class="p">(</SPAN><SPAN class="mi">12818</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>mSpells<SPAN class="p">.</SPAN>end<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L3299"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3299">3299</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mi">60</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3300"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3300">3300</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>mSpells<SPAN class="p">.</SPAN>find<SPAN class="p">(</SPAN><SPAN class="mi">12301</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>mSpells<SPAN class="p">.</SPAN>end<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L3301"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3301">3301</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mi">30</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3302"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3302">3302</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3303"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3303">3303</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3304"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3304">3304</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3305"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3305">3305</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3306"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3306">3306</A></TH><TD></TR><TR><TH id="L3307"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3307">3307</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>HasAura<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">17619</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3308"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3308">3308</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3309"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3309">3309</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy <SPAN class="o">=</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;modEnergy <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">1.4f</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3310"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3310">3310</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3311"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3311">3311</A></TH><TD></TR><TR><TH id="L3312"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3312">3312</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Judgement of Wisdom </SPAN></TD></TR><TR><TH id="L3313"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3313">3313</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">20268</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3314"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3314">3314</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modEnergy <SPAN class="o">=</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN><SPAN class="mf">0.02f</SPAN><SPAN class="o">*</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_BASE_MANA<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L3315"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3315">3315</A></TH><TD></TR><TR><TH id="L3316"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3316">3316</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Energize<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>&nbsp;modEnergy<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3317"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3317">3317</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3318"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3318">3318</A></TH><TD></TR><TR><TH id="L3319"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3319">3319</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectWeaponDmgPerc<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Weapon Percent damage</SPAN></TD></TR><TR><TH id="L3320"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3320">3320</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3321"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3321">3321</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3322"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3322">3322</A></TH><TD></TR><TR><TH id="L3323"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3323">3323</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_DMG_TYPE_MAGIC <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3324"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3324">3324</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3325"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3325">3325</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;fdmg <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">)</SPAN>CalculateDamage<SPAN class="p">(</SPAN>&nbsp;u_caster<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;MELEE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3326"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3326">3326</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 dmg <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>fdmg<SPAN class="o">*</SPAN><SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>damage<SPAN class="o">/</SPAN><SPAN class="mf">100.0f</SPAN><SPAN class="p">)));</SPAN></TD></TR><TR><TH id="L3327"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3327">3327</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>SpellNonMeleeDamageLog<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>&nbsp;dmg<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3328"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3328">3328</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3329"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3329">3329</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3330"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3330">3330</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3331"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3331">3331</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 _type<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3332"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3332">3332</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_DMG_TYPE_RANGED <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3333"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3333">3333</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp;RANGED<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3334"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3334">3334</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3335"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3335">3335</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3336"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3336">3336</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttributesExC <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mh">0x1000000</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3337"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3337">3337</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp; OFFHAND<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3338"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3338">3338</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3339"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3339">3339</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp;MELEE<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3340"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3340">3340</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3341"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3341">3341</A></TH><TD></TR><TR><TH id="L3342"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3342">3342</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Strike<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;_type<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;add_damage<SPAN class="p">,</SPAN>&nbsp;damage<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3343"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3343">3343</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3344"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3344">3344</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3345"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3345">3345</A></TH><TD></TR><TR><TH id="L3346"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3346">3346</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectTriggerMissile<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Trigger Missile</SPAN></TD></TR><TR><TH id="L3347"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3347">3347</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3348"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3348">3348</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Used by mortar team</SPAN></TD></TR><TR><TH id="L3349"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3349">3349</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Triggers area affect spell at destinatiom</SPAN></TD></TR><TR><TH id="L3350"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3350">3350</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>m_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3351"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3351">3351</A></TH><TD></TR><TR><TH id="L3352"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3352">3352</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 spellid <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectTriggerSpell<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L3353"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3353">3353</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spellid<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3354"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3354">3354</A></TH><TD></TR><TR><TH id="L3355"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3355">3355</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>spInfo <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>spellid<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3356"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3356">3356</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spInfo<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3357"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3357">3357</A></TH><TD></TR><TR><TH id="L3358"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3358">3358</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;spellRadius <SPAN class="o">=</SPAN>&nbsp;GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3359"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3359">3359</A></TH><TD></TR><TR><TH id="L3360"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3360">3360</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>std<SPAN class="o">::</SPAN>set<SPAN class="o">&lt;</SPAN>Object<SPAN class="o">*&gt;::</SPAN>iterator itr <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetInRangeSetBegin<SPAN class="p">();</SPAN>&nbsp;itr <SPAN class="o">!=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetInRangeSetEnd<SPAN class="p">();</SPAN>&nbsp;itr<SPAN class="o">++</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3361"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3361">3361</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3362"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3362">3362</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>IsUnit<SPAN class="p">())</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Unit<SPAN class="o">*&gt;</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">))</SPAN><SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L3363"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3363">3363</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">continue</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3364"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3364">3364</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Unit <SPAN class="o">*</SPAN>t<SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Unit<SPAN class="o">*&gt;</SPAN><SPAN class="p">((</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L3365"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3365">3365</A></TH><TD></TR><TR><TH id="L3366"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3366">3366</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;r<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3367"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3367">3367</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;d<SPAN class="o">=</SPAN>m_targets<SPAN class="p">.</SPAN>m_destX<SPAN class="o">-</SPAN>t<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3368"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3368">3368</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r <SPAN class="o">=</SPAN>&nbsp;d<SPAN class="o">*</SPAN>d<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3369"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3369">3369</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY<SPAN class="o">-</SPAN>t<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3370"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3370">3370</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r <SPAN class="o">+=</SPAN>&nbsp;d<SPAN class="o">*</SPAN>d<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3371"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3371">3371</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ<SPAN class="o">-</SPAN>t<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3372"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3372">3372</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r <SPAN class="o">+=</SPAN>&nbsp;d<SPAN class="o">*</SPAN>d<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3373"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3373">3373</A></TH><TD></TR><TR><TH id="L3374"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3374">3374</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>sqrt<SPAN class="p">(</SPAN>r<SPAN class="p">)</SPAN><SPAN class="o">&gt;</SPAN>&nbsp;spellRadius<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">continue</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3375"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3375">3375</A></TH><TD></TR><TR><TH id="L3376"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3376">3376</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>isAttackable<SPAN class="p">(</SPAN>m_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Unit<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">)))</SPAN><SPAN class="c">//Fixme only enemy targets?</SPAN></TD></TR><TR><TH id="L3377"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3377">3377</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">continue</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3378"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3378">3378</A></TH><TD></TR><TR><TH id="L3379"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3379">3379</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>&nbsp;sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3380"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3380">3380</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3381"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3381">3381</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3382"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3382">3382</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>m_caster<SPAN class="p">,</SPAN>spInfo<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3383"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3383">3383</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3384"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3384">3384</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tgt<SPAN class="p">.</SPAN>m_unitTarget<SPAN class="o">=</SPAN><SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3385"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3385">3385</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>tgt<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3386"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3386">3386</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3387"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3387">3387</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3388"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3388">3388</A></TH><TD></TR><TR><TH id="L3389"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3389">3389</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectOpenLock<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Open Lock</SPAN></TD></TR><TR><TH id="L3390"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3390">3390</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3391"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3391">3391</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3392"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3392">3392</A></TH><TD></TR><TR><TH id="L3393"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3393">3393</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint8 loottype <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3394"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3394">3394</A></TH><TD></TR><TR><TH id="L3395"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3395">3395</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 locktype<SPAN class="o">=</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L3396"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3396">3396</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>locktype<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3397"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3397">3397</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3398"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3398">3398</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">LOCKTYPE_PICKLOCK:</SPAN></TD></TR><TR><TH id="L3399"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3399">3399</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3400"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3400">3400</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 v <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3401"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3401">3401</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 lockskill <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>_GetSkillLineCurrent<SPAN class="p">(</SPAN>SKILL_LOCKPICKING<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3402"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3402">3402</A></TH><TD></TR><TR><TH id="L3403"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3403">3403</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>itemTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3404"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3404">3404</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3405"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3405">3405</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>locked<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3406"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3406">3406</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3407"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3407">3407</A></TH><TD></TR><TR><TH id="L3408"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3408">3408</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Lock <SPAN class="o">*</SPAN>lock <SPAN class="o">=</SPAN>&nbsp;dbcLock<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>LockId <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3409"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3409">3409</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>lock<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3410"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3410">3410</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN><SPAN class="kt">int</SPAN>&nbsp;i <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">&lt;</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3411"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3411">3411</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>lock<SPAN class="o">-&gt;</SPAN>locktype<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">2</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;lock<SPAN class="o">-&gt;</SPAN>minlockskill<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;lockskill <SPAN class="o">&gt;=</SPAN>&nbsp;lock<SPAN class="o">-&gt;</SPAN>minlockskill<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L3412"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3412">3412</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3413"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3413">3413</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v <SPAN class="o">=</SPAN>&nbsp;lock<SPAN class="o">-&gt;</SPAN>minlockskill<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L3414"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3414">3414</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; itemTarget<SPAN class="o">-&gt;</SPAN>locked <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3415"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3415">3415</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; itemTarget<SPAN class="o">-&gt;</SPAN>SetFlag<SPAN class="p">(</SPAN>ITEM_FIELD_FLAGS<SPAN class="p">,</SPAN><SPAN class="mi">4</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// unlock</SPAN></TD></TR><TR><TH id="L3416"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3416">3416</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DetermineSkillUp<SPAN class="p">(</SPAN>SKILL_LOCKPICKING<SPAN class="p">,</SPAN>v<SPAN class="o">/</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3417"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3417">3417</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3418"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3418">3418</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3419"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3419">3419</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3420"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3420">3420</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>gameObjTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3421"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3421">3421</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3422"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3422">3422</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GameObjectInfo <SPAN class="o">*</SPAN>info <SPAN class="o">=</SPAN>&nbsp;GameObjectNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3423"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3423">3423</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>info <SPAN class="o">||</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetByte<SPAN class="p">(</SPAN>GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3424"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3424">3424</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Lock <SPAN class="o">*</SPAN>lock <SPAN class="o">=</SPAN>&nbsp;dbcLock<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;info<SPAN class="o">-&gt;</SPAN>SpellFocus <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3425"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3425">3425</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>lock <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3426"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3426">3426</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3427"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3427">3427</A></TH><TD></TR><TR><TH id="L3428"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3428">3428</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN><SPAN class="kt">int</SPAN>&nbsp;i<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>i<SPAN class="o">&lt;</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">;</SPAN>i<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3429"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3429">3429</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3430"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3430">3430</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>lock<SPAN class="o">-&gt;</SPAN>locktype<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">2</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;lock<SPAN class="o">-&gt;</SPAN>minlockskill<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;lockskill <SPAN class="o">&gt;=</SPAN>&nbsp;lock<SPAN class="o">-&gt;</SPAN>minlockskill<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L3431"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3431">3431</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3432"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3432">3432</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v <SPAN class="o">=</SPAN>&nbsp;lock<SPAN class="o">-&gt;</SPAN>minlockskill<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L3433"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3433">3433</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gameObjTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>GAMEOBJECT_FLAGS<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3434"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3434">3434</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gameObjTarget<SPAN class="o">-&gt;</SPAN>SetByte<SPAN class="p">(</SPAN>GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3435"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3435">3435</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Add Fill GO loot here</SPAN></TD></TR><TR><TH id="L3436"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3436">3436</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>items<SPAN class="p">.</SPAN>size<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3437"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3437">3437</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3438"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3438">3438</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillGOLoot<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">,</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">(),</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>iInstanceMode <SPAN class="o">?</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3439"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3439">3439</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DetermineSkillUp<SPAN class="p">(</SPAN>SKILL_LOCKPICKING<SPAN class="p">,</SPAN>v<SPAN class="o">/</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//to prevent free skill up</SPAN></TD></TR><TR><TH id="L3440"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3440">3440</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3441"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3441">3441</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loottype <SPAN class="o">=</SPAN>&nbsp;LOOT_CORPSE<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3442"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3442">3442</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//End of it</SPAN></TD></TR><TR><TH id="L3443"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3443">3443</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3444"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3444">3444</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3445"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3445">3445</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3446"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3446">3446</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3447"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3447">3447</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3448"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3448">3448</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3449"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3449">3449</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">LOCKTYPE_HERBALISM:</SPAN></TD></TR><TR><TH id="L3450"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3450">3450</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3451"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3451">3451</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>gameObjTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3452"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3452">3452</A></TH><TD></TR><TR><TH id="L3453"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3453">3453</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 v <SPAN class="o">=</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetGOReqSkill<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3454"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3454">3454</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;bAlreadyUsed <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3455"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3455">3455</A></TH><TD></TR><TR><TH id="L3456"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3456">3456</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>Rand<SPAN class="p">(</SPAN><SPAN class="mf">100.0f</SPAN><SPAN class="p">))</SPAN>&nbsp;<SPAN class="c">// 3% chance to fail//why?</SPAN></TD></TR><TR><TH id="L3457"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3457">3457</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3458"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3458">3458</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>_GetSkillLineCurrent<SPAN class="p">(</SPAN>&nbsp;SKILL_HERBALISM <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&lt;</SPAN>&nbsp;v <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3459"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3459">3459</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3460"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3460">3460</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SendCastResult(SPELL_FAILED_LOW_CASTLEVEL);</SPAN></TD></TR><TR><TH id="L3461"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3461">3461</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3462"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3462">3462</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3463"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3463">3463</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3464"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3464">3464</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3465"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3465">3465</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>items<SPAN class="p">.</SPAN>size<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3466"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3466">3466</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3467"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3467">3467</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillGOLoot<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">,</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">(),</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>iInstanceMode <SPAN class="o">?</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3468"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3468">3468</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3469"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3469">3469</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3470"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3470">3470</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bAlreadyUsed <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3471"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3471">3471</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3472"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3472">3472</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loottype <SPAN class="o">=</SPAN>&nbsp;LOOT_SKINNING<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3473"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3473">3473</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3474"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3474">3474</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3475"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3475">3475</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3476"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3476">3476</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L3477"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3477">3477</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(rand()%100 &lt;= 30)</SPAN></TD></TR><TR><TH id="L3478"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3478">3478</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L3479"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3479">3479</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //30% chance to not be able to reskin on fail</SPAN></TD></TR><TR><TH id="L3480"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3480">3480</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((Creature*)unitTarget)-&gt;Skinned = true;</SPAN></TD></TR><TR><TH id="L3481"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3481">3481</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WorldPacket *pkt=unitTarget-&gt;BuildFieldUpdatePacket(UNIT_FIELD_FLAGS,0);</SPAN></TD></TR><TR><TH id="L3482"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3482">3482</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; static_cast&lt; Player* &gt;( m_caster )-&gt;GetSession()-&gt;SendPacket(pkt);</SPAN></TD></TR><TR><TH id="L3483"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3483">3483</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; delete pkt;</SPAN></TD></TR><TR><TH id="L3484"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3484">3484</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L3485"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3485">3485</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }*/</SPAN></TD></TR><TR><TH id="L3486"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3486">3486</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_TRY_AGAIN<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3487"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3487">3487</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3488"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3488">3488</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Skill up</SPAN></TD></TR><TR><TH id="L3489"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3489">3489</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>bAlreadyUsed<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Avoid cheats with opening/closing without taking the loot</SPAN></TD></TR><TR><TH id="L3490"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3490">3490</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DetermineSkillUp<SPAN class="p">(</SPAN>SKILL_HERBALISM<SPAN class="p">,</SPAN>v<SPAN class="o">/</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3491"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3491">3491</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3492"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3492">3492</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3493"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3493">3493</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">LOCKTYPE_MINING:</SPAN></TD></TR><TR><TH id="L3494"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3494">3494</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3495"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3495">3495</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>gameObjTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3496"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3496">3496</A></TH><TD></TR><TR><TH id="L3497"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3497">3497</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 v <SPAN class="o">=</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetGOReqSkill<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3498"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3498">3498</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;bAlreadyUsed <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3499"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3499">3499</A></TH><TD></TR><TR><TH id="L3500"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3500">3500</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;Rand<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mf">100.0f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// 3% chance to fail//why?</SPAN></TD></TR><TR><TH id="L3501"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3501">3501</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3502"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3502">3502</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>_GetSkillLineCurrent<SPAN class="p">(</SPAN>&nbsp;SKILL_MINING <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&lt;</SPAN>&nbsp;v <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3503"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3503">3503</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3504"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3504">3504</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//SendCastResult(SPELL_FAILED_LOW_CASTLEVEL);</SPAN></TD></TR><TR><TH id="L3505"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3505">3505</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3506"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3506">3506</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3507"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3507">3507</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>items<SPAN class="p">.</SPAN>size<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3508"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3508">3508</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3509"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3509">3509</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillGOLoot<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">,</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">(),</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>iInstanceMode <SPAN class="o">?</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3510"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3510">3510</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3511"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3511">3511</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3512"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3512">3512</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bAlreadyUsed <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3513"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3513">3513</A></TH><TD></TR><TR><TH id="L3514"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3514">3514</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loottype <SPAN class="o">=</SPAN>&nbsp;LOOT_SKINNING<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3515"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3515">3515</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3516"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3516">3516</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3517"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3517">3517</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3518"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3518">3518</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_TRY_AGAIN<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3519"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3519">3519</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3520"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3520">3520</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Skill up</SPAN></TD></TR><TR><TH id="L3521"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3521">3521</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>bAlreadyUsed<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Avoid cheats with opening/closing without taking the loot</SPAN></TD></TR><TR><TH id="L3522"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3522">3522</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DetermineSkillUp<SPAN class="p">(</SPAN>SKILL_MINING<SPAN class="p">,</SPAN>&nbsp;v<SPAN class="o">/</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3523"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3523">3523</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3524"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3524">3524</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3525"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3525">3525</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">LOCKTYPE_SLOW_OPEN:</SPAN>&nbsp;<SPAN class="c">// used for BG go's</SPAN></TD></TR><TR><TH id="L3526"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3526">3526</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3527"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3527">3527</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>gameObjTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3528"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3528">3528</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_bg<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3529"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3529">3529</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>m_bg<SPAN class="o">-&gt;</SPAN>HookSlowLockOpen<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L3530"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3530">3530</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3531"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3531">3531</A></TH><TD></TR><TR><TH id="L3532"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3532">3532</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 spellid <SPAN class="o">=</SPAN>&nbsp;<SPAN class="o">!</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetInfo<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Unknown1 <SPAN class="o">?</SPAN>&nbsp;<SPAN class="mi">23932</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetInfo<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Unknown1<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3533"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3533">3533</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>en <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>spellid<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3534"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3534">3534</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3535"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3535">3535</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3536"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3536">3536</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3537"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3537">3537</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>en<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3538"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3538">3538</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3539"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3539">3539</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tgt<SPAN class="p">.</SPAN>m_unitTarget<SPAN class="o">=</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3540"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3540">3540</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>tgt<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3541"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3541">3541</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3542"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3542">3542</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3543"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3543">3543</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3544"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3544">3544</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">LOCKTYPE_QUICK_CLOSE:</SPAN></TD></TR><TR><TH id="L3545"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3545">3545</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3546"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3546">3546</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>gameObjTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3547"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3547">3547</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gameObjTarget<SPAN class="o">-&gt;</SPAN>EventCloseDoor<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3548"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3548">3548</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3549"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3549">3549</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3550"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3550">3550</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN><SPAN class="c">//not profession</SPAN></TD></TR><TR><TH id="L3551"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3551">3551</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3552"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3552">3552</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>gameObjTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3553"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3553">3553</A></TH><TD></TR><TR><TH id="L3554"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3554">3554</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetByte<SPAN class="p">(</SPAN>&nbsp;GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;GAMEOBJECT_TYPE_GOOBER<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3555"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3555">3555</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL_GO_SCRIPT_EVENT<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="p">,</SPAN>&nbsp;OnActivate<SPAN class="p">)(</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L3556"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3556">3556</A></TH><TD></TR><TR><TH id="L3557"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3557">3557</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>sQuestMgr<SPAN class="p">.</SPAN>OnActivateQuestGiver<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L3558"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3558">3558</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3559"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3559">3559</A></TH><TD></TR><TR><TH id="L3560"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3560">3560</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>sQuestMgr<SPAN class="p">.</SPAN>OnGameObjectActivate<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;gameObjTarget<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L3561"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3561">3561</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3562"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3562">3562</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>UpdateNearbyGameObjects<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3563"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3563">3563</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3564"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3564">3564</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3565"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3565">3565</A></TH><TD></TR><TR><TH id="L3566"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3566">3566</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>items<SPAN class="p">.</SPAN>size<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3567"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3567">3567</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3568"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3568">3568</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillGOLoot<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">,</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">(),</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>iInstanceMode <SPAN class="o">?</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3569"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3569">3569</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3570"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3570">3570</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loottype<SPAN class="o">=</SPAN>&nbsp;LOOT_CORPSE <SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3571"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3571">3571</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3572"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3572">3572</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3573"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3573">3573</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">};</SPAN></TD></TR><TR><TH id="L3574"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3574">3574</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gameObjTarget <SPAN class="o">&amp;&amp;</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetByte<SPAN class="p">(</SPAN>&nbsp;GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;GAMEOBJECT_TYPE_CHEST<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3575"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3575">3575</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>SendLoot<SPAN class="p">(</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;loottype <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3576"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3576">3576</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3577"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3577">3577</A></TH><TD></TR><TR><TH id="L3578"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3578">3578</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectOpenLockItem<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3579"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3579">3579</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3580"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3580">3580</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Unit<SPAN class="o">*</SPAN>&nbsp;caster <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3581"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3581">3581</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;i_caster<SPAN class="p">)</SPAN>&nbsp;caster <SPAN class="o">=</SPAN>&nbsp;i_caster<SPAN class="o">-&gt;</SPAN>GetOwner<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3582"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3582">3582</A></TH><TD></TR><TR><TH id="L3583"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3583">3583</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>gameObjTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">())</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3584"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3584">3584</A></TH><TD></TR><TR><TH id="L3585"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3585">3585</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;caster<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;sQuestMgr<SPAN class="p">.</SPAN>OnGameObjectActivate<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>caster<SPAN class="p">)),</SPAN>&nbsp;gameObjTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3586"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3586">3586</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>caster<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>UpdateNearbyGameObjects<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3587"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3587">3587</A></TH><TD></TR><TR><TH id="L3588"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3588">3588</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CALL_GO_SCRIPT_EVENT<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="p">,</SPAN>&nbsp;OnActivate<SPAN class="p">)(</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>caster<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L3589"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3589">3589</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; gameObjTarget<SPAN class="o">-&gt;</SPAN>SetByte<SPAN class="p">(</SPAN>GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3590"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3590">3590</A></TH><TD></TR><TR><TH id="L3591"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3591">3591</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">183146</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3592"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3592">3592</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3593"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3593">3593</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gameObjTarget<SPAN class="o">-&gt;</SPAN>Despawn<SPAN class="p">(</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3594"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3594">3594</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3595"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3595">3595</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3596"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3596">3596</A></TH><TD></TR><TR><TH id="L3597"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3597">3597</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetByte<SPAN class="p">(</SPAN>&nbsp;GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;GAMEOBJECT_TYPE_CHEST<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3598"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3598">3598</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3599"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3599">3599</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillGOLoot<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">,</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">(),</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>iInstanceMode <SPAN class="o">?</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3600"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3600">3600</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>items<SPAN class="p">.</SPAN>size<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3601"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3601">3601</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3602"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3602">3602</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>caster<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>SendLoot<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>LOOT_CORPSE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3603"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3603">3603</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3604"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3604">3604</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3605"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3605">3605</A></TH><TD></TR><TR><TH id="L3606"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3606">3606</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// cebernic: atm doors works fine.</SPAN></TD></TR><TR><TH id="L3607"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3607">3607</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetByte<SPAN class="p">(</SPAN>&nbsp;GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;GAMEOBJECT_TYPE_DOOR</TD></TR><TR><TH id="L3608"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3608">3608</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="o">||</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetByte<SPAN class="p">(</SPAN>&nbsp;GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;GAMEOBJECT_TYPE_GOOBER <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3609"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3609">3609</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gameObjTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>GAMEOBJECT_FLAGS<SPAN class="p">,</SPAN>&nbsp;gameObjTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;GAMEOBJECT_FLAGS <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">|</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3610"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3610">3610</A></TH><TD></TR><TR><TH id="L3611"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3611">3611</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>gameObjTarget<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetMapInfo<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>type<SPAN class="o">==</SPAN>INSTANCE_NULL<SPAN class="p">)</SPAN><SPAN class="c">//dont close doors for instances</SPAN></TD></TR><TR><TH id="L3612"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3612">3612</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>GameObject<SPAN class="o">::</SPAN>EventCloseDoor<SPAN class="p">,</SPAN>&nbsp;EVENT_GAMEOBJECT_DOOR_CLOSE<SPAN class="p">,</SPAN><SPAN class="mi">10000</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3613"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3613">3613</A></TH><TD></TR><TR><TH id="L3614"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3614">3614</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>gameObjTarget<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>GameObject<SPAN class="o">::</SPAN>Despawn<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;EVENT_GAMEOBJECT_ITEM_SPAWN<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">6</SPAN><SPAN class="o">*</SPAN><SPAN class="mi">60</SPAN><SPAN class="o">*</SPAN><SPAN class="mi">1000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3615"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3615">3615</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3616"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3616">3616</A></TH><TD></TR><TR><TH id="L3617"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3617">3617</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectProficiency<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3618"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3618">3618</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3619"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3619">3619</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 skill <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3620"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3620">3620</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; skilllinespell <SPAN class="o">*</SPAN>skillability <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetSpellSkill<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3621"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3621">3621</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>skillability<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3622"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3622">3622</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;skillability<SPAN class="o">-&gt;</SPAN>skilline<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3623"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3623">3623</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; skilllineentry <SPAN class="o">*</SPAN>sk <SPAN class="o">=</SPAN>&nbsp;dbcSkillLine<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>skill<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3624"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3624">3624</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>skill<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3625"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3625">3625</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3626"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3626">3626</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3627"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3627">3627</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3628"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3628">3628</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>_HasSkillLine<SPAN class="p">(</SPAN>skill<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L3629"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3629">3629</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3630"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3630">3630</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Increase it by one</SPAN></TD></TR><TR><TH id="L3631"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3631">3631</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// playerTarget-&gt;AdvanceSkillLine(skill);</SPAN></TD></TR><TR><TH id="L3632"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3632">3632</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3633"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3633">3633</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3634"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3634">3634</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3635"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3635">3635</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Don't add skills to players logging in.</SPAN></TD></TR><TR><TH id="L3636"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3636">3636</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*if((GetProto()-&gt;Attributes &amp; 64) &amp;&amp; playerTarget-&gt;m_TeleportState == 1)</SPAN></TD></TR><TR><TH id="L3637"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3637">3637</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;*/</SPAN></TD></TR><TR><TH id="L3638"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3638">3638</A></TH><TD></TR><TR><TH id="L3639"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3639">3639</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>sk <SPAN class="o">&amp;&amp;</SPAN>&nbsp;sk<SPAN class="o">-&gt;</SPAN>type <SPAN class="o">==</SPAN>&nbsp;SKILL_TYPE_WEAPON<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3640"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3640">3640</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>_AddSkillLine<SPAN class="p">(</SPAN>skill<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">5</SPAN><SPAN class="o">*</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3641"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3641">3641</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3642"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3642">3642</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>_AddSkillLine<SPAN class="p">(</SPAN>skill<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3643"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3643">3643</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3644"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3644">3644</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3645"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3645">3645</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3646"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3646">3646</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3647"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3647">3647</A></TH><TD></TR><TR><TH id="L3648"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3648">3648</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSendEvent<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Send Event</SPAN></TD></TR><TR><TH id="L3649"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3649">3649</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3650"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3650">3650</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//This is mostly used to trigger events on quests or some places</SPAN></TD></TR><TR><TH id="L3651"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3651">3651</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L3652"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3652">3652</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 spellId <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3653"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3653">3653</A></TH><TD></TR><TR><TH id="L3654"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3654">3654</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Try a dummy SpellHandler</SPAN></TD></TR><TR><TH id="L3655"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3655">3655</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>sScriptMgr<SPAN class="p">.</SPAN>CallScriptedDummySpell<SPAN class="p">(</SPAN>spellId<SPAN class="p">,</SPAN>&nbsp;i<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">))</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3656"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3656">3656</A></TH><TD></TR><TR><TH id="L3657"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3657">3657</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>spellId<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3658"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3658">3658</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3659"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3659">3659</A></TH><TD></TR><TR><TH id="L3660"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3660">3660</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// WSG Flags</SPAN></TD></TR><TR><TH id="L3661"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3661">3661</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23333</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3662"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3662">3662</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23335</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3663"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3663">3663</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3664"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3664">3664</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_bg<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3665"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3665">3665</A></TH><TD></TR><TR><TH id="L3666"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3666">3666</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetTeam<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3667"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3667">3667</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>m_bg<SPAN class="o">-&gt;</SPAN>SendChatMessage<SPAN class="p">(</SPAN>&nbsp;CHAT_MSG_BG_EVENT_HORDE<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="s">"The Alliance flag was picked up by %s!"</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetName<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3668"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3668">3668</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3669"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3669">3669</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>m_bg<SPAN class="o">-&gt;</SPAN>SendChatMessage<SPAN class="p">(</SPAN>&nbsp;CHAT_MSG_BG_EVENT_ALLIANCE<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="s">"The Horde flag was picked up by %s!"</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetName<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3670"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3670">3670</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3671"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3671">3671</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3672"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3672">3672</A></TH><TD></TR><TR><TH id="L3673"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3673">3673</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Place Loot</SPAN></TD></TR><TR><TH id="L3674"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3674">3674</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">25720</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Places the Bag of Gold at the designated Drop-Off Point.</SPAN></TD></TR><TR><TH id="L3675"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3675">3675</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3676"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3676">3676</A></TH><TD></TR><TR><TH id="L3677"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3677">3677</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3678"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3678">3678</A></TH><TD></TR><TR><TH id="L3679"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3679">3679</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Item - Cleansing Vial DND</SPAN></TD></TR><TR><TH id="L3680"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3680">3680</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">29297</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Empty the vial near the Bones of Aggonar to cleanse the waters of their demonic taint.</SPAN></TD></TR><TR><TH id="L3681"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3681">3681</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3682"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3682">3682</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; QuestLogEntry <SPAN class="o">*</SPAN>en<SPAN class="o">=</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetQuestLogForEntry<SPAN class="p">(</SPAN><SPAN class="mi">9427</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3683"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3683">3683</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>en<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3684"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3684">3684</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en<SPAN class="o">-&gt;</SPAN>SendQuestComplete<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3685"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3685">3685</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3686"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3686">3686</A></TH><TD></TR><TR><TH id="L3687"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3687">3687</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Warlock: Summon Succubus Quest</SPAN></TD></TR><TR><TH id="L3688"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3688">3688</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8674</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3689"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3689">3689</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">9223</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3690"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3690">3690</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">9224</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3691"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3691">3691</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3692"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3692">3692</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">5677</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3693"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3693">3693</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureProto <SPAN class="o">*</SPAN>&nbsp;cp <SPAN class="o">=</SPAN>&nbsp;CreatureProtoStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">5677</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3694"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3694">3694</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>ci <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>cp <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3695"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3695">3695</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3696"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3696">3696</A></TH><TD></TR><TR><TH id="L3697"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3697">3697</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>&nbsp;pCreature <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateCreature<SPAN class="p">(</SPAN>cp<SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3698"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3698">3698</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>Load<SPAN class="p">(</SPAN>cp<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3699"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3699">3699</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>_setFaction<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3700"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3700">3700</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>&nbsp;AITYPE_AGRO<SPAN class="p">,</SPAN>MOVEMENTTYPE_NONE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3701"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3701">3701</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>taunt<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3702"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3702">3702</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>_setFaction<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3703"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3703">3703</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3704"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3704">3704</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Creature<SPAN class="o">::</SPAN>SafeDelete<SPAN class="p">,</SPAN>&nbsp;EVENT_CREATURE_REMOVE_CORPSE<SPAN class="p">,</SPAN><SPAN class="mi">60000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3705"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3705">3705</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3706"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3706">3706</A></TH><TD></TR><TR><TH id="L3707"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3707">3707</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Warlock: Summon Voidwalker Quest</SPAN></TD></TR><TR><TH id="L3708"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3708">3708</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">30208</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3709"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3709">3709</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">9221</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3710"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3710">3710</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">9222</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3711"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3711">3711</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">7728</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3712"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3712">3712</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3713"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3713">3713</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">5676</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3714"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3714">3714</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureProto <SPAN class="o">*</SPAN>&nbsp;cp <SPAN class="o">=</SPAN>&nbsp;CreatureProtoStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">5676</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3715"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3715">3715</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>ci <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>cp <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3716"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3716">3716</A></TH><TD></TR><TR><TH id="L3717"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3717">3717</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>&nbsp;pCreature <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateCreature<SPAN class="p">(</SPAN>cp<SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3718"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3718">3718</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>Load<SPAN class="p">(</SPAN>cp<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3719"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3719">3719</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>_setFaction<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3720"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3720">3720</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>&nbsp;AITYPE_AGRO<SPAN class="p">,</SPAN>MOVEMENTTYPE_NONE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3721"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3721">3721</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>taunt<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3722"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3722">3722</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>_setFaction<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3723"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3723">3723</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3724"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3724">3724</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Creature<SPAN class="o">::</SPAN>SafeDelete<SPAN class="p">,</SPAN>&nbsp;EVENT_CREATURE_REMOVE_CORPSE<SPAN class="p">,</SPAN><SPAN class="mi">60000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3725"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3725">3725</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3726"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3726">3726</A></TH><TD></TR><TR><TH id="L3727"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3727">3727</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Warlock: Summon Felhunter Quest</SPAN></TD></TR><TR><TH id="L3728"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3728">3728</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8712</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L3729"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3729">3729</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3730"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3730">3730</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">6268</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3731"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3731">3731</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureProto <SPAN class="o">*</SPAN>&nbsp;cp <SPAN class="o">=</SPAN>&nbsp;CreatureProtoStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">6268</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3732"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3732">3732</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>ci <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>cp <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3733"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3733">3733</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3734"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3734">3734</A></TH><TD></TR><TR><TH id="L3735"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3735">3735</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>&nbsp;pCreature <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateCreature<SPAN class="p">(</SPAN>cp<SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3736"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3736">3736</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>Load<SPAN class="p">(</SPAN>cp<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3737"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3737">3737</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>_setFaction<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3738"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3738">3738</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>&nbsp;AITYPE_AGRO<SPAN class="p">,</SPAN>MOVEMENTTYPE_NONE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3739"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3739">3739</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>taunt<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3740"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3740">3740</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>_setFaction<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3741"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3741">3741</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3742"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3742">3742</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Creature<SPAN class="o">::</SPAN>SafeDelete<SPAN class="p">,</SPAN>&nbsp;EVENT_CREATURE_REMOVE_CORPSE<SPAN class="p">,</SPAN><SPAN class="mi">60000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3743"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3743">3743</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3744"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3744">3744</A></TH><TD></TR><TR><TH id="L3745"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3745">3745</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3746"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3746">3746</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3747"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3747">3747</A></TH><TD></TR><TR><TH id="L3748"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3748">3748</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectApplyAA<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Apply Area Aura</SPAN></TD></TR><TR><TH id="L3749"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3749">3749</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3750"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3750">3750</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3751"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3751">3751</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster <SPAN class="o">!=</SPAN>&nbsp;unitTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3752"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3752">3752</A></TH><TD></TR><TR><TH id="L3753"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3753">3753</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Aura <SPAN class="o">*</SPAN>&nbsp;pAura<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3754"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3754">3754</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; std<SPAN class="o">::</SPAN>map<SPAN class="o">&lt;</SPAN>uint32<SPAN class="p">,</SPAN>Aura<SPAN class="o">*&gt;::</SPAN>iterator itr<SPAN class="o">=</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>tmpAura<SPAN class="p">.</SPAN>find<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3755"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3755">3755</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>itr<SPAN class="o">==</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>tmpAura<SPAN class="p">.</SPAN>end<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L3756"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3756">3756</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3757"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3757">3757</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura <SPAN class="o">=</SPAN>&nbsp;AuraPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3758"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3758">3758</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>pAura<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3759"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3759">3759</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3760"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3760">3760</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>GetProto<SPAN class="p">(),</SPAN>GetDuration<SPAN class="p">(),</SPAN>m_caster<SPAN class="p">,</SPAN>unitTarget<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3761"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3761">3761</A></TH><TD></TR><TR><TH id="L3762"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3762">3762</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>tmpAura <SPAN class="p">[</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">]</SPAN><SPAN class="o">=</SPAN>&nbsp;pAura<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3763"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3763">3763</A></TH><TD></TR><TR><TH id="L3764"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3764">3764</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;r <SPAN class="o">=</SPAN>&nbsp;GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3765"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3765">3765</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sEventMgr<SPAN class="p">.</SPAN>HasEvent<SPAN class="p">(</SPAN>pAura<SPAN class="p">,</SPAN>&nbsp;EVENT_AREAAURA_UPDATE<SPAN class="p">))</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">/* only add it once */</SPAN></TD></TR><TR><TH id="L3766"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3766">3766</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>pAura<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Aura<SPAN class="o">::</SPAN>EventUpdateAA<SPAN class="p">,</SPAN>&nbsp;r<SPAN class="o">*</SPAN>r<SPAN class="p">,</SPAN>&nbsp;EVENT_AREAAURA_UPDATE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>EVENT_FLAG_DO_NOT_EXECUTE_IN_WORLD_CONTEXT<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3767"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3767">3767</A></TH><TD></TR><TR><TH id="L3768"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3768">3768</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3769"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3769">3769</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3770"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3770">3770</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pAura <SPAN class="o">=</SPAN>&nbsp;itr<SPAN class="o">-&gt;</SPAN>second<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3771"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3771">3771</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3772"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3772">3772</A></TH><TD></TR><TR><TH id="L3773"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3773">3773</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pAura<SPAN class="o">-&gt;</SPAN>AddMod<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectApplyAuraName<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>damage<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3774"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3774">3774</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3775"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3775">3775</A></TH><TD></TR><TR><TH id="L3776"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3776">3776</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectLearnSpell<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Learn Spell</SPAN></TD></TR><TR><TH id="L3777"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3777">3777</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3778"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3778">3778</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget <SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">())</SPAN>&nbsp;<SPAN class="c">// something's wrong with this logic here.</SPAN></TD></TR><TR><TH id="L3779"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3779">3779</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3780"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3780">3780</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// bug in target map fill?</SPAN></TD></TR><TR><TH id="L3781"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3781">3781</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//playerTarget = m_caster-&gt;GetMapMgr()-&gt;GetPlayer((uint32)m_targets.m_unitTarget);</SPAN></TD></TR><TR><TH id="L3782"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3782">3782</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEffectLearnPetSpell<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3783"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3783">3783</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3784"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3784">3784</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3785"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3785">3785</A></TH><TD></TR><TR><TH id="L3786"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3786">3786</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">483</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">55884</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// "Learning"</SPAN></TD></TR><TR><TH id="L3787"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3787">3787</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3788"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3788">3788</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>i_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3789"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3789">3789</A></TH><TD></TR><TR><TH id="L3790"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3790">3790</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 spellid <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3791"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3791">3791</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN><SPAN class="kt">int</SPAN>&nbsp;i <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;i <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">5</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="o">++</SPAN>i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3792"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3792">3792</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3793"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3793">3793</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;i_caster<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Spells<SPAN class="p">[</SPAN>i<SPAN class="p">].</SPAN>Trigger <SPAN class="o">==</SPAN>&nbsp;LEARNING <SPAN class="o">&amp;&amp;</SPAN>&nbsp;i_caster<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Spells<SPAN class="p">[</SPAN>i<SPAN class="p">].</SPAN>Id <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3794"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3794">3794</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3795"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3795">3795</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spellid <SPAN class="o">=</SPAN>&nbsp;i_caster<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Spells<SPAN class="p">[</SPAN>i<SPAN class="p">].</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3796"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3796">3796</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3797"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3797">3797</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3798"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3798">3798</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3799"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3799">3799</A></TH><TD></TR><TR><TH id="L3800"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3800">3800</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>spellid <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntryForced<SPAN class="p">(</SPAN>spellid<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3801"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3801">3801</A></TH><TD></TR><TR><TH id="L3802"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3802">3802</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// learn me!</SPAN></TD></TR><TR><TH id="L3803"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3803">3803</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;spellid <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3804"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3804">3804</A></TH><TD></TR><TR><TH id="L3805"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3805">3805</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// no normal handler</SPAN></TD></TR><TR><TH id="L3806"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3806">3806</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3807"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3807">3807</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3808"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3808">3808</A></TH><TD></TR><TR><TH id="L3809"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3809">3809</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3810"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3810">3810</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3811"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3811">3811</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*if(u_caster &amp;&amp; isHostile(playerTarget, u_caster))</SPAN></TD></TR><TR><TH id="L3812"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3812">3812</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;*/</SPAN></TD></TR><TR><TH id="L3813"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3813">3813</A></TH><TD></TR><TR><TH id="L3814"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3814">3814</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 spellToLearn <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectTriggerSpell<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L3815"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3815">3815</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>spellToLearn<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3816"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3816">3816</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//smth is wrong here, first we add this spell to player then we may cast it on player...</SPAN></TD></TR><TR><TH id="L3817"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3817">3817</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>spellinfo <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>spellToLearn<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3818"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3818">3818</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//remove specializations</SPAN></TD></TR><TR><TH id="L3819"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3819">3819</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>spellinfo<SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3820"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3820">3820</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3821"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3821">3821</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">26801</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Shadoweave Tailoring</SPAN></TD></TR><TR><TH id="L3822"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3822">3822</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">26798</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Mooncloth Tailoring</SPAN></TD></TR><TR><TH id="L3823"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3823">3823</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">26797</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Spellfire Tailoring</SPAN></TD></TR><TR><TH id="L3824"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3824">3824</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3825"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3825">3825</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">26798</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Mooncloth Tailoring</SPAN></TD></TR><TR><TH id="L3826"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3826">3826</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">26801</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Shadoweave Tailoring</SPAN></TD></TR><TR><TH id="L3827"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3827">3827</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">26797</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Spellfire Tailoring</SPAN></TD></TR><TR><TH id="L3828"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3828">3828</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3829"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3829">3829</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">26797</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Spellfire Tailoring</SPAN></TD></TR><TR><TH id="L3830"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3830">3830</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">26801</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Shadoweave Tailoring</SPAN></TD></TR><TR><TH id="L3831"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3831">3831</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">26798</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Mooncloth Tailoring</SPAN></TD></TR><TR><TH id="L3832"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3832">3832</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3833"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3833">3833</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">10656</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Dragonscale Leatherworking</SPAN></TD></TR><TR><TH id="L3834"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3834">3834</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">10658</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Elemental Leatherworking</SPAN></TD></TR><TR><TH id="L3835"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3835">3835</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">10660</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Tribal Leatherworking</SPAN></TD></TR><TR><TH id="L3836"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3836">3836</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3837"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3837">3837</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">10658</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Elemental Leatherworking</SPAN></TD></TR><TR><TH id="L3838"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3838">3838</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">10656</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Dragonscale Leatherworking</SPAN></TD></TR><TR><TH id="L3839"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3839">3839</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">10660</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Tribal Leatherworking</SPAN></TD></TR><TR><TH id="L3840"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3840">3840</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3841"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3841">3841</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">10660</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Tribal Leatherworking</SPAN></TD></TR><TR><TH id="L3842"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3842">3842</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">10656</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Dragonscale Leatherworking</SPAN></TD></TR><TR><TH id="L3843"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3843">3843</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">10658</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Elemental Leatherworking</SPAN></TD></TR><TR><TH id="L3844"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3844">3844</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3845"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3845">3845</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">28677</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Elixir Master</SPAN></TD></TR><TR><TH id="L3846"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3846">3846</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">28675</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Potion Master</SPAN></TD></TR><TR><TH id="L3847"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3847">3847</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">28672</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Transmutation Maste</SPAN></TD></TR><TR><TH id="L3848"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3848">3848</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3849"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3849">3849</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">28675</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Potion Master</SPAN></TD></TR><TR><TH id="L3850"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3850">3850</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">28677</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Elixir Master</SPAN></TD></TR><TR><TH id="L3851"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3851">3851</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">28672</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Transmutation Maste</SPAN></TD></TR><TR><TH id="L3852"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3852">3852</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3853"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3853">3853</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">28672</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Transmutation Master</SPAN></TD></TR><TR><TH id="L3854"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3854">3854</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">28675</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Potion Master</SPAN></TD></TR><TR><TH id="L3855"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3855">3855</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">28677</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Elixir Master</SPAN></TD></TR><TR><TH id="L3856"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3856">3856</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3857"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3857">3857</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20219</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Gnomish Engineer</SPAN></TD></TR><TR><TH id="L3858"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3858">3858</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">20222</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Goblin Engineer</SPAN></TD></TR><TR><TH id="L3859"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3859">3859</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3860"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3860">3860</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20222</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Goblin Engineer</SPAN></TD></TR><TR><TH id="L3861"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3861">3861</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">20219</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Gnomish Engineer</SPAN></TD></TR><TR><TH id="L3862"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3862">3862</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3863"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3863">3863</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">9788</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Armorsmith</SPAN></TD></TR><TR><TH id="L3864"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3864">3864</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">9787</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Weaponsmith</SPAN></TD></TR><TR><TH id="L3865"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3865">3865</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">17039</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Master Swordsmith</SPAN></TD></TR><TR><TH id="L3866"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3866">3866</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">17040</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Master Hammersmith</SPAN></TD></TR><TR><TH id="L3867"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3867">3867</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">17041</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Master Axesmith</SPAN></TD></TR><TR><TH id="L3868"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3868">3868</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3869"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3869">3869</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">9787</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Weaponsmith</SPAN></TD></TR><TR><TH id="L3870"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3870">3870</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">9788</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Armorsmith</SPAN></TD></TR><TR><TH id="L3871"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3871">3871</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3872"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3872">3872</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">17041</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Master Axesmith</SPAN></TD></TR><TR><TH id="L3873"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3873">3873</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">9788</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Armorsmith</SPAN></TD></TR><TR><TH id="L3874"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3874">3874</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">17040</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Master Hammersmith</SPAN></TD></TR><TR><TH id="L3875"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3875">3875</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">17039</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Master Swordsmith</SPAN></TD></TR><TR><TH id="L3876"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3876">3876</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3877"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3877">3877</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">17040</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Master Hammersmith</SPAN></TD></TR><TR><TH id="L3878"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3878">3878</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">9788</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Armorsmith</SPAN></TD></TR><TR><TH id="L3879"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3879">3879</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">17039</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Master Swordsmith</SPAN></TD></TR><TR><TH id="L3880"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3880">3880</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">17041</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Master Axesmith</SPAN></TD></TR><TR><TH id="L3881"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3881">3881</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3882"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3882">3882</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">17039</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Master Swordsmith</SPAN></TD></TR><TR><TH id="L3883"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3883">3883</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">9788</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Armorsmith</SPAN></TD></TR><TR><TH id="L3884"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3884">3884</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">17040</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Master Hammersmith</SPAN></TD></TR><TR><TH id="L3885"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3885">3885</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN><SPAN class="mi">17041</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//Master Axesmith</SPAN></TD></TR><TR><TH id="L3886"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3886">3886</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3887"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3887">3887</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3888"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3888">3888</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 i <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">&lt;</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3889"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3889">3889</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>spellinfo<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_WEAPON <SPAN class="o">||</SPAN></TD></TR><TR><TH id="L3890"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3890">3890</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spellinfo<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_PROFICIENCY <SPAN class="o">||</SPAN></TD></TR><TR><TH id="L3891"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3891">3891</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spellinfo<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_DUAL_WIELD <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3892"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3892">3892</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3893"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3893">3893</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3894"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3894">3894</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3895"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3895">3895</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3896"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3896">3896</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;spellinfo<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3897"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3897">3897</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets targets<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3898"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3898">3898</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">.</SPAN>m_unitTarget <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3899"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3899">3899</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">.</SPAN>m_targetMask <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mh">0x02</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3900"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3900">3900</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>targets<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3901"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3901">3901</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3902"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3902">3902</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3903"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3903">3903</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3904"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3904">3904</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3905"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3905">3905</A></TH><TD></TR><TR><TH id="L3906"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3906">3906</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// if we got here... try via pet spells..</SPAN></TD></TR><TR><TH id="L3907"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3907">3907</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; SpellEffectLearnPetSpell<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3908"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3908">3908</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3909"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3909">3909</A></TH><TD></TR><TR><TH id="L3910"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3910">3910</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSpellDefense<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3911"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3911">3911</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3912"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3912">3912</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//used to enable this ability. We use it all the time ...</SPAN></TD></TR><TR><TH id="L3913"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3913">3913</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3914"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3914">3914</A></TH><TD></TR><TR><TH id="L3915"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3915">3915</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectLearnPetSpell<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3916"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3916">3916</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3917"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3917">3917</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*if(unitTarget &amp;&amp; m_caster-&gt;GetTypeId() == TYPEID_PLAYER)</SPAN></TD></TR><TR><TH id="L3918"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3918">3918</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L3919"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3919">3919</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if(unitTarget-&gt;IsPet() &amp;&amp; unitTarget-&gt;GetTypeId() == TYPEID_UNIT)</SPAN></TD></TR><TR><TH id="L3920"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3920">3920</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L3921"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3921">3921</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; static_cast&lt; Player* &gt;(m_caster)-&gt;AddPetSpell(GetProto()-&gt;EffectTriggerSpell[i], unitTarget-&gt;GetEntry());</SPAN></TD></TR><TR><TH id="L3922"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3922">3922</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L3923"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3923">3923</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }*/</SPAN></TD></TR><TR><TH id="L3924"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3924">3924</A></TH><TD></TR><TR><TH id="L3925"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3925">3925</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget <SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3926"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3926">3926</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3927"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3927">3927</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>&nbsp;pPet <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Pet<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3928"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3928">3928</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>pPet<SPAN class="o">-&gt;</SPAN>IsSummon<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L3929"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3929">3929</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>AddSummonSpell<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">(),</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectTriggerSpell<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L3930"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3930">3930</A></TH><TD></TR><TR><TH id="L3931"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3931">3931</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>AddSpell<SPAN class="p">(</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectTriggerSpell<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3932"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3932">3932</A></TH><TD></TR><TR><TH id="L3933"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3933">3933</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Send Packet</SPAN></TD></TR><TR><TH id="L3934"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3934">3934</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data(SMSG_SET_EXTRA_AURA_INFO_OBSOLETE, 22);</SPAN></TD></TR><TR><TH id="L3935"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3935">3935</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data &lt;&lt; pPet-&gt;GetGUID() &lt;&lt; uint8(0) &lt;&lt; uint32(GetProto()-&gt;EffectTriggerSpell[i]) &lt;&lt; uint32(-1) &lt;&lt; uint32(0);</SPAN></TD></TR><TR><TH id="L3936"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3936">3936</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster-&gt;GetSession()-&gt;SendPacket(&amp;data);*/</SPAN></TD></TR><TR><TH id="L3937"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3937">3937</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3938"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3938">3938</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3939"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3939">3939</A></TH><TD></TR><TR><TH id="L3940"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3940">3940</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDispel<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Dispel</SPAN></TD></TR><TR><TH id="L3941"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3941">3941</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3942"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3942">3942</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3943"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3943">3943</A></TH><TD></TR><TR><TH id="L3944"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3944">3944</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Aura <SPAN class="o">*</SPAN>aur<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3945"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3945">3945</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 start<SPAN class="p">,</SPAN>&nbsp;end<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3946"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3946">3946</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>isAttackable<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>unitTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;DISPEL_STEALTH <SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// IsAttackable returns false for stealthed</SPAN></TD></TR><TR><TH id="L3947"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3947">3947</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3948"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3948">3948</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; start <SPAN class="o">=</SPAN>&nbsp;MAX_POSITIVE_AURAS_EXTEDED_START<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3949"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3949">3949</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end <SPAN class="o">=</SPAN>&nbsp;MAX_POSITIVE_AURAS_EXTEDED_END<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3950"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3950">3950</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>SchoolImmunityList<SPAN class="p">[</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>School<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L3951"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3951">3951</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3952"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3952">3952</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3953"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3953">3953</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L3954"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3954">3954</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3955"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3955">3955</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; start <SPAN class="o">=</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_START<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3956"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3956">3956</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end <SPAN class="o">=</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_END<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3957"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3957">3957</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3958"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3958">3958</A></TH><TD></TR><TR><TH id="L3959"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3959">3959</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_SPELLDISPELLOG<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">16</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3960"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3960">3960</A></TH><TD></TR><TR><TH id="L3961"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3961">3961</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;finish <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3962"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3962">3962</A></TH><TD></TR><TR><TH id="L3963"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3963">3963</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 x <SPAN class="o">=</SPAN>&nbsp;start<SPAN class="p">;</SPAN>&nbsp;x<SPAN class="o">&lt;</SPAN>end<SPAN class="p">;</SPAN>&nbsp;x<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3964"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3964">3964</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L3965"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3965">3965</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3966"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3966">3966</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;auraRemoved <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3967"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3967">3967</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aur <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L3968"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3968">3968</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Nothing can dispel resurrection sickness;</SPAN></TD></TR><TR><TH id="L3969"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3969">3969</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>aur<SPAN class="o">-&gt;</SPAN>IsPassive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN><SPAN class="p">(</SPAN>aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Attributes <SPAN class="o">&amp;</SPAN>&nbsp;ATTRIBUTES_IGNORE_INVULNERABILITY<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L3970"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3970">3970</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3971"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3971">3971</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>DispelType <SPAN class="o">==</SPAN>&nbsp;DISPEL_ALL<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3972"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3972">3972</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3973"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3973">3973</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>HandleProc<SPAN class="p">(</SPAN>&nbsp;PROC_ON_PRE_DISPELL_AURA_VICTIM <SPAN class="p">,</SPAN>&nbsp;u_caster <SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3974"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3974">3974</A></TH><TD></TR><TR><TH id="L3975"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3975">3975</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data<SPAN class="p">.</SPAN>clear<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3976"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3976">3976</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3977"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3977">3977</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3978"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3978">3978</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//probably dispel type</SPAN></TD></TR><TR><TH id="L3979"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3979">3979</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3980"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3980">3980</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SendMessageToSet<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3981"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3981">3981</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>RemoveAura<SPAN class="p">(</SPAN>aur<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3982"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3982">3982</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; auraRemoved <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3983"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3983">3983</A></TH><TD></TR><TR><TH id="L3984"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3984">3984</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!--</SPAN>damage<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L3985"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3985">3985</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; finish <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3986"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3986">3986</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L3987"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3987">3987</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>DispelType <SPAN class="o">==</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L3988"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3988">3988</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L3989"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3989">3989</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>HandleProc<SPAN class="p">(</SPAN>&nbsp;PROC_ON_PRE_DISPELL_AURA_VICTIM <SPAN class="p">,</SPAN>&nbsp;u_caster <SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3990"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3990">3990</A></TH><TD></TR><TR><TH id="L3991"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3991">3991</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data<SPAN class="p">.</SPAN>clear<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3992"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3992">3992</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3993"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3993">3993</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3994"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3994">3994</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3995"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3995">3995</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L3996"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3996">3996</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SendMessageToSet<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L3997"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3997">3997</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>RemoveAllAuras<SPAN class="p">(</SPAN>aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>aur<SPAN class="o">-&gt;</SPAN>GetCasterGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L3998"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3998">3998</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; auraRemoved <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L3999"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L3999">3999</A></TH><TD></TR><TR><TH id="L4000"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4000">4000</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!--</SPAN>damage<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4001"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4001">4001</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; finish <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4002"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4002">4002</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4003"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4003">4003</A></TH><TD></TR><TR><TH id="L4004"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4004">4004</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>auraRemoved<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4005"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4005">4005</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4006"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4006">4006</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_UNSTABLE_AFFLICTION <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4007"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4007">4007</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4008"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4008">4008</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>spellInfo <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">31117</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4009"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4009">4009</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;spellInfo <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4010"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4010">4010</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4011"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4011">4011</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>spell <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4012"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4012">4012</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4013"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4013">4013</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4014"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4014">4014</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;spellInfo<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4015"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4015">4015</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>forced_basepoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="mi">9</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//damage effect</SPAN></TD></TR><TR><TH id="L4016"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4016">4016</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>ProcedOnSpell <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4017"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4017">4017</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>pSpellId <SPAN class="o">=</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4018"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4018">4018</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets targets<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4019"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4019">4019</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">.</SPAN>m_unitTarget <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4020"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4020">4020</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>targets<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4021"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4021">4021</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4022"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4022">4022</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4023"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4023">4023</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*else if ( aur-&gt;GetSpellProto()-&gt;NameHash == SPELL_HASH_LIFEBLOOM )</SPAN></TD></TR><TR><TH id="L4024"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4024">4024</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L4025"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4025">4025</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell* spell= new Spell(aur-&gt;GetCaster(), aur-&gt;GetSpellProto(), true, NULL);</SPAN></TD></TR><TR><TH id="L4026"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4026">4026</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell-&gt;SetUnitTarget( unitTarget );</SPAN></TD></TR><TR><TH id="L4027"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4027">4027</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell-&gt;Heal( aur-&gt;mod-&gt;m_amount );</SPAN></TD></TR><TR><TH id="L4028"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4028">4028</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }*/</SPAN></TD></TR><TR><TH id="L4029"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4029">4029</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4030"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4030">4030</A></TH><TD></TR><TR><TH id="L4031"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4031">4031</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4032"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4032">4032</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>finish<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4033"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4033">4033</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4034"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4034">4034</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4035"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4035">4035</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4036"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4036">4036</A></TH><TD></TR><TR><TH id="L4037"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4037">4037</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDualWield<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4038"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4038">4038</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4039"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4039">4039</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;TYPEID_PLAYER<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4040"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4040">4040</A></TH><TD></TR><TR><TH id="L4041"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4041">4041</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Player <SPAN class="o">*</SPAN>pPlayer <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4042"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4042">4042</A></TH><TD></TR><TR><TH id="L4043"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4043">4043</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>pPlayer<SPAN class="o">-&gt;</SPAN>_HasSkillLine<SPAN class="p">(</SPAN>&nbsp;SKILL_DUAL_WIELD <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4044"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4044">4044</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPlayer<SPAN class="o">-&gt;</SPAN>_AddSkillLine<SPAN class="p">(</SPAN>&nbsp;SKILL_DUAL_WIELD<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4045"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4045">4045</A></TH><TD></TR><TR><TH id="L4046"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4046">4046</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Increase it by one</SPAN></TD></TR><TR><TH id="L4047"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4047">4047</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//dual wield is 1/1 , it never increases it's not even displayed in skills tab</SPAN></TD></TR><TR><TH id="L4048"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4048">4048</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4049"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4049">4049</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//note: probably here must be not caster but unitVictim</SPAN></TD></TR><TR><TH id="L4050"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4050">4050</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4051"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4051">4051</A></TH><TD></TR><TR><TH id="L4052"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4052">4052</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonWild<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp; <SPAN class="c">// Summon Wild</SPAN></TD></TR><TR><TH id="L4053"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4053">4053</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4054"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4054">4054</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//these are some cretures that have your faction and do not respawn</SPAN></TD></TR><TR><TH id="L4055"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4055">4055</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//number of creatures is actualy dmg (the usual formula), sometimes =3 sometimes =1</SPAN></TD></TR><TR><TH id="L4056"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4056">4056</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4057"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4057">4057</A></TH><TD></TR><TR><TH id="L4058"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4058">4058</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 cr_entry<SPAN class="o">=</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L4059"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4059">4059</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CreatureProto <SPAN class="o">*</SPAN>&nbsp;proto <SPAN class="o">=</SPAN>&nbsp;CreatureProtoStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>cr_entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4060"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4060">4060</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>&nbsp;info <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>cr_entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4061"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4061">4061</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>proto <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>info<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4062"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4062">4062</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4063"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4063">4063</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sLog<SPAN class="p">.</SPAN>outDetail<SPAN class="p">(</SPAN><SPAN class="s">"Warning : Missing summon creature template %u used by spell %u!"</SPAN><SPAN class="p">,</SPAN>cr_entry<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4064"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4064">4064</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4065"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4065">4065</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4066"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4066">4066</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;x<SPAN class="p">,</SPAN>&nbsp;y<SPAN class="p">,</SPAN>&nbsp;z<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4067"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4067">4067</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_targetMask <SPAN class="o">&amp;</SPAN>&nbsp;TARGET_FLAG_DEST_LOCATION <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destX <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4068"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4068">4068</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4069"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4069">4069</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destX<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4070"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4070">4070</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4071"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4071">4071</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; z <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4072"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4072">4072</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4073"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4073">4073</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4074"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4074">4074</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4075"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4075">4075</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4076"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4076">4076</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4077"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4077">4077</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; z <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4078"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4078">4078</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4079"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4079">4079</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN><SPAN class="kt">int</SPAN>&nbsp;i<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>i<SPAN class="o">&lt;</SPAN>damage<SPAN class="p">;</SPAN>i<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4080"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4080">4080</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4081"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4081">4081</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;m_fallowAngle<SPAN class="o">=-</SPAN><SPAN class="p">((</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>M_PI<SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">)</SPAN><SPAN class="o">*</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4082"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4082">4082</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="p">(</SPAN>cosf<SPAN class="p">(</SPAN>m_fallowAngle<SPAN class="o">+</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">())));</SPAN></TD></TR><TR><TH id="L4083"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4083">4083</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="p">(</SPAN>sinf<SPAN class="p">(</SPAN>m_fallowAngle<SPAN class="o">+</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">())));</SPAN></TD></TR><TR><TH id="L4084"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4084">4084</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>&nbsp;p <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateCreature<SPAN class="p">(</SPAN>cr_entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4085"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4085">4085</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//ASSERT(p);</SPAN></TD></TR><TR><TH id="L4086"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4086">4086</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<SPAN class="o">-&gt;</SPAN>Load<SPAN class="p">(</SPAN>proto<SPAN class="p">,</SPAN>&nbsp;x<SPAN class="p">,</SPAN>&nbsp;y<SPAN class="p">,</SPAN>&nbsp;z<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4087"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4087">4087</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<SPAN class="o">-&gt;</SPAN>SetZoneId<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetZoneId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4088"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4088">4088</A></TH><TD></TR><TR><TH id="L4089"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4089">4089</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;p<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;p<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Faction <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">35</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4090"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4090">4090</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4091"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4091">4091</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_SUMMONEDBY<SPAN class="p">,</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4092"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4092">4092</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_CREATEDBY<SPAN class="p">,</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4093"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4093">4093</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_FACTIONTEMPLATE<SPAN class="p">,</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_FACTIONTEMPLATE <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4094"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4094">4094</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4095"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4095">4095</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4096"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4096">4096</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4097"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4097">4097</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_FACTIONTEMPLATE<SPAN class="p">,</SPAN>&nbsp;proto<SPAN class="o">-&gt;</SPAN>Faction <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4098"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4098">4098</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4099"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4099">4099</A></TH><TD></TR><TR><TH id="L4100"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4100">4100</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<SPAN class="o">-&gt;</SPAN>m_faction <SPAN class="o">=</SPAN>&nbsp;dbcFactionTemplate<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>proto<SPAN class="o">-&gt;</SPAN>Faction<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4101"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4101">4101</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p<SPAN class="o">-&gt;</SPAN>m_faction<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4102"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4102">4102</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<SPAN class="o">-&gt;</SPAN>m_factionDBC <SPAN class="o">=</SPAN>&nbsp;dbcFaction<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>p<SPAN class="o">-&gt;</SPAN>m_faction<SPAN class="o">-&gt;</SPAN>Faction<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4103"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4103">4103</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4104"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4104">4104</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//make sure they will be desumonized (roxor)</SPAN></TD></TR><TR><TH id="L4105"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4105">4105</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>p<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Creature<SPAN class="o">::</SPAN>SummonExpire<SPAN class="p">,</SPAN>&nbsp;EVENT_SUMMON_EXPIRE<SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4106"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4106">4106</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4107"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4107">4107</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4108"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4108">4108</A></TH><TD></TR><TR><TH id="L4109"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4109">4109</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonGuardian<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Summon Guardian</SPAN></TD></TR><TR><TH id="L4110"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4110">4110</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4111"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4111">4111</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GameObject <SPAN class="o">*</SPAN>&nbsp;obj <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//Snake trap part 1</SPAN></TD></TR><TR><TH id="L4112"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4112">4112</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; LocationVector <SPAN class="o">*</SPAN>&nbsp;vec <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4113"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4113">4113</A></TH><TD></TR><TR><TH id="L4114"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4114">4114</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;g_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;g_caster<SPAN class="o">-&gt;</SPAN>m_summoner<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4115"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4115">4115</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4116"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4116">4116</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster <SPAN class="o">=</SPAN>&nbsp;g_caster<SPAN class="o">-&gt;</SPAN>m_summoner<SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//set the caster to the summoner unit</SPAN></TD></TR><TR><TH id="L4117"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4117">4117</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; obj <SPAN class="o">=</SPAN>&nbsp;g_caster<SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//and keep the trap info</SPAN></TD></TR><TR><TH id="L4118"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4118">4118</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4119"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4119">4119</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4120"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4120">4120</A></TH><TD></TR><TR><TH id="L4121"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4121">4121</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 cr_entry <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L4122"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4122">4122</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4123"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4123">4123</A></TH><TD></TR><TR><TH id="L4124"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4124">4124</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>c_is_flags <SPAN class="o">&amp;</SPAN>&nbsp;SPELL_FLAG_IS_INHERITING_LEVEL <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4125"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4125">4125</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; level <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4126"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4126">4126</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*if ( u_caster-&gt;GetTypeId()==TYPEID_PLAYER &amp;&amp; itemTarget )</SPAN></TD></TR><TR><TH id="L4127"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4127">4127</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L4128"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4128">4128</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if (itemTarget-&gt;GetProto() &amp;&amp; itemTarget-&gt;GetProto()-&gt;RequiredSkill == SKILL_ENGINERING)</SPAN></TD></TR><TR><TH id="L4129"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4129">4129</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L4130"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4130">4130</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; uint32 skill202 = static_cast&lt; Player* &gt;( m_caster )-&gt;_GetSkillLineCurrent(SKILL_ENGINERING);</SPAN></TD></TR><TR><TH id="L4131"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4131">4131</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if (skill202&gt;0)</SPAN></TD></TR><TR><TH id="L4132"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4132">4132</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L4133"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4133">4133</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; level = skill202/5;</SPAN></TD></TR><TR><TH id="L4134"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4134">4134</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L4135"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4135">4135</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L4136"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4136">4136</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }*/</SPAN></TD></TR><TR><TH id="L4137"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4137">4137</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_targetMask <SPAN class="o">&amp;</SPAN>&nbsp;TARGET_FLAG_DEST_LOCATION <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destX <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4138"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4138">4138</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4139"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4139">4139</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vec <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">new</SPAN>&nbsp;LocationVector<SPAN class="p">(</SPAN>m_targets<SPAN class="p">.</SPAN>m_destX<SPAN class="p">,</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY<SPAN class="p">,</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4140"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4140">4140</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4141"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4141">4141</A></TH><TD></TR><TR><TH id="L4142"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4142">4142</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;angle_for_each_spawn <SPAN class="o">=</SPAN>&nbsp;<SPAN class="o">-</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>M_PI<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">2</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4143"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4143">4143</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="kt">int</SPAN>&nbsp;i <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;i <SPAN class="o">&lt;</SPAN>&nbsp;damage<SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">++</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4144"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4144">4144</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4145"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4145">4145</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;m_fallowAngle <SPAN class="o">=</SPAN>&nbsp;angle_for_each_spawn <SPAN class="o">*</SPAN>&nbsp;i<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4146"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4146">4146</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>create_guardian<SPAN class="p">(</SPAN>cr_entry<SPAN class="p">,</SPAN>GetDuration<SPAN class="p">(),</SPAN>&nbsp;m_fallowAngle<SPAN class="p">,</SPAN>&nbsp;level<SPAN class="p">,</SPAN>&nbsp;obj<SPAN class="p">,</SPAN>&nbsp;vec <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4147"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4147">4147</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4148"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4148">4148</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>vec<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">delete</SPAN>&nbsp;vec<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4149"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4149">4149</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4150"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4150">4150</A></TH><TD></TR><TR><TH id="L4151"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4151">4151</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSkillStep<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Skill Step</SPAN></TD></TR><TR><TH id="L4152"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4152">4152</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4153"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4153">4153</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Player<SPAN class="o">*</SPAN>target<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4154"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4154">4154</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;TYPEID_PLAYER<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4155"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4155">4155</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4156"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4156">4156</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Check targets</SPAN></TD></TR><TR><TH id="L4157"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4157">4157</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_unitTarget <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4158"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4158">4158</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4159"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4159">4159</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetPlayer<SPAN class="p">((</SPAN>uint32<SPAN class="p">)</SPAN>m_targets<SPAN class="p">.</SPAN>m_unitTarget<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4160"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4160">4160</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>target <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4161"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4161">4161</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4162"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4162">4162</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4163"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4163">4163</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4164"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4164">4164</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4165"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4165">4165</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4166"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4166">4166</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4167"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4167">4167</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4168"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4168">4168</A></TH><TD></TR><TR><TH id="L4169"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4169">4169</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 skill <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L4170"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4170">4170</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;skill <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">242</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4171"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4171">4171</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skill <SPAN class="o">=</SPAN>&nbsp;SKILL_LOCKPICKING<SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// somehow for lockpicking misc is different than the skill :s</SPAN></TD></TR><TR><TH id="L4172"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4172">4172</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4173"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4173">4173</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; skilllineentry<SPAN class="o">*</SPAN>&nbsp;sk <SPAN class="o">=</SPAN>&nbsp;dbcSkillLine<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;skill <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4174"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4174">4174</A></TH><TD></TR><TR><TH id="L4175"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4175">4175</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>sk <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4176"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4176">4176</A></TH><TD></TR><TR><TH id="L4177"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4177">4177</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 max <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4178"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4178">4178</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;sk<SPAN class="o">-&gt;</SPAN>type <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4179"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4179">4179</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4180"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4180">4180</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_TYPE_PROFESSION:</SPAN></TD></TR><TR><TH id="L4181"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4181">4181</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_TYPE_SECONDARY:</SPAN>&nbsp; &nbsp; &nbsp; max <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">75</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4182"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4182">4182</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_TYPE_WEAPON:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">5</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;target<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">();</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4183"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4183">4183</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_TYPE_CLASS:</SPAN></TD></TR><TR><TH id="L4184"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4184">4184</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_TYPE_ARMOR:</SPAN></TD></TR><TR><TH id="L4185"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4185">4185</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;skill <SPAN class="o">==</SPAN>&nbsp;SKILL_LOCKPICKING <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN>&nbsp;max <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">75</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4186"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4186">4186</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="p">{</SPAN>&nbsp;max <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4187"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4187">4187</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4188"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4188">4188</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//u cant learn other types in game</SPAN></TD></TR><TR><TH id="L4189"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4189">4189</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4190"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4190">4190</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">};</SPAN></TD></TR><TR><TH id="L4191"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4191">4191</A></TH><TD></TR><TR><TH id="L4192"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4192">4192</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;target<SPAN class="o">-&gt;</SPAN>_HasSkillLine<SPAN class="p">(</SPAN>&nbsp;skill <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4193"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4193">4193</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4194"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4194">4194</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>_ModifySkillMaximum<SPAN class="p">(</SPAN>&nbsp;skill<SPAN class="p">,</SPAN>&nbsp;max <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4195"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4195">4195</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4196"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4196">4196</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4197"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4197">4197</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4198"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4198">4198</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Don't add skills to players logging in.</SPAN></TD></TR><TR><TH id="L4199"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4199">4199</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*if((GetProto()-&gt;Attributes &amp; 64) &amp;&amp; playerTarget-&gt;m_TeleportState == 1)</SPAN></TD></TR><TR><TH id="L4200"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4200">4200</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;*/</SPAN></TD></TR><TR><TH id="L4201"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4201">4201</A></TH><TD></TR><TR><TH id="L4202"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4202">4202</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;sk<SPAN class="o">-&gt;</SPAN>type <SPAN class="o">==</SPAN>&nbsp;SKILL_TYPE_PROFESSION <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4203"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4203">4203</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>ModUnsigned32Value<SPAN class="p">(</SPAN>&nbsp;PLAYER_CHARACTER_POINTS2<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">-</SPAN><SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4204"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4204">4204</A></TH><TD></TR><TR><TH id="L4205"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4205">4205</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;skill <SPAN class="o">==</SPAN>&nbsp;SKILL_RIDING <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4206"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4206">4206</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>_AddSkillLine<SPAN class="p">(</SPAN>&nbsp;skill<SPAN class="p">,</SPAN>&nbsp;max<SPAN class="p">,</SPAN>&nbsp;max <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4207"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4207">4207</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4208"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4208">4208</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>_AddSkillLine<SPAN class="p">(</SPAN>&nbsp;skill<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;max <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4209"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4209">4209</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4210"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4210">4210</A></TH><TD></TR><TR><TH id="L4211"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4211">4211</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//professions fix, for unknow reason when u learn profession it</SPAN></TD></TR><TR><TH id="L4212"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4212">4212</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//does not teach find herbs for herbalism etc. moreover there is no spell</SPAN></TD></TR><TR><TH id="L4213"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4213">4213</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//in spell.dbc that would teach u this. It means blizz does it in some tricky way too</SPAN></TD></TR><TR><TH id="L4214"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4214">4214</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;skill <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4215"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4215">4215</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4216"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4216">4216</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_ALCHEMY:</SPAN></TD></TR><TR><TH id="L4217"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4217">4217</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2330</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Minor Healing Potion</SPAN></TD></TR><TR><TH id="L4218"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4218">4218</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2329</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Elixir of Lion's Strength</SPAN></TD></TR><TR><TH id="L4219"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4219">4219</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">7183</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Elixir of Minor Defense</SPAN></TD></TR><TR><TH id="L4220"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4220">4220</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4221"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4221">4221</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_ENCHANTING:</SPAN></TD></TR><TR><TH id="L4222"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4222">4222</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">7418</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Enchant Bracer - Minor Health</SPAN></TD></TR><TR><TH id="L4223"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4223">4223</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">7428</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Enchant Bracer - Minor Deflection</SPAN></TD></TR><TR><TH id="L4224"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4224">4224</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">7421</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Runed Copper Rod</SPAN></TD></TR><TR><TH id="L4225"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4225">4225</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">13262</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Disenchant</SPAN></TD></TR><TR><TH id="L4226"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4226">4226</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4227"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4227">4227</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_HERBALISM:</SPAN></TD></TR><TR><TH id="L4228"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4228">4228</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2383</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//find herbs</SPAN></TD></TR><TR><TH id="L4229"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4229">4229</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4230"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4230">4230</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_MINING:</SPAN></TD></TR><TR><TH id="L4231"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4231">4231</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2657</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//smelt copper</SPAN></TD></TR><TR><TH id="L4232"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4232">4232</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2656</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//smelting</SPAN></TD></TR><TR><TH id="L4233"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4233">4233</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2580</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//find minerals</SPAN></TD></TR><TR><TH id="L4234"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4234">4234</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4235"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4235">4235</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_FIRST_AID:</SPAN></TD></TR><TR><TH id="L4236"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4236">4236</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">3275</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Linen Bandage</SPAN></TD></TR><TR><TH id="L4237"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4237">4237</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4238"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4238">4238</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_TAILORING:</SPAN></TD></TR><TR><TH id="L4239"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4239">4239</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2963</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Bolt of Linen Cloth</SPAN></TD></TR><TR><TH id="L4240"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4240">4240</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4241"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4241">4241</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2387</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Linen Cloak</SPAN></TD></TR><TR><TH id="L4242"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4242">4242</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2393</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//White Linen Shirt</SPAN></TD></TR><TR><TH id="L4243"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4243">4243</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">3915</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Brown Linen Shirt</SPAN></TD></TR><TR><TH id="L4244"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4244">4244</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">12044</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Simple Linen Pants</SPAN></TD></TR><TR><TH id="L4245"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4245">4245</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4246"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4246">4246</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_LEATHERWORKING:</SPAN></TD></TR><TR><TH id="L4247"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4247">4247</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2149</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Handstitched Leather Boots</SPAN></TD></TR><TR><TH id="L4248"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4248">4248</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2152</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Light Armor Kit</SPAN></TD></TR><TR><TH id="L4249"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4249">4249</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2881</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Light Leather</SPAN></TD></TR><TR><TH id="L4250"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4250">4250</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">7126</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Handstitched Leather Vest</SPAN></TD></TR><TR><TH id="L4251"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4251">4251</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">9058</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Handstitched Leather Cloak</SPAN></TD></TR><TR><TH id="L4252"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4252">4252</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">9059</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Handstitched Leather Bracers</SPAN></TD></TR><TR><TH id="L4253"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4253">4253</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4254"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4254">4254</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_ENGINERING:</SPAN></TD></TR><TR><TH id="L4255"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4255">4255</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">3918</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Rough Blasting Powder</SPAN></TD></TR><TR><TH id="L4256"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4256">4256</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">3919</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Rough Dynamite</SPAN></TD></TR><TR><TH id="L4257"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4257">4257</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">3920</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Crafted Light Shot</SPAN></TD></TR><TR><TH id="L4258"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4258">4258</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4259"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4259">4259</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_COOKING:</SPAN></TD></TR><TR><TH id="L4260"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4260">4260</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2538</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Charred Wolf Meat</SPAN></TD></TR><TR><TH id="L4261"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4261">4261</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2540</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Roasted Boar Meat</SPAN></TD></TR><TR><TH id="L4262"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4262">4262</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">818</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Basic Campfire</SPAN></TD></TR><TR><TH id="L4263"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4263">4263</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">8604</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Herb Baked Egg</SPAN></TD></TR><TR><TH id="L4264"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4264">4264</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4265"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4265">4265</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_BLACKSMITHING:</SPAN></TD></TR><TR><TH id="L4266"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4266">4266</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2660</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Rough Sharpening Stone</SPAN></TD></TR><TR><TH id="L4267"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4267">4267</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2663</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Copper Bracers</SPAN></TD></TR><TR><TH id="L4268"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4268">4268</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">12260</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Rough Copper Vest</SPAN></TD></TR><TR><TH id="L4269"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4269">4269</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">2662</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Copper Chain Pants</SPAN></TD></TR><TR><TH id="L4270"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4270">4270</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">3115</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">//Rough Weightstone</SPAN></TD></TR><TR><TH id="L4271"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4271">4271</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4272"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4272">4272</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_JEWELCRAFTING:</SPAN></TD></TR><TR><TH id="L4273"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4273">4273</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">25255</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">// Delicate Copper Wire</SPAN></TD></TR><TR><TH id="L4274"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4274">4274</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">25493</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">// Braided Copper Ring</SPAN></TD></TR><TR><TH id="L4275"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4275">4275</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">26925</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">// Woven Copper Ring</SPAN></TD></TR><TR><TH id="L4276"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4276">4276</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">32259</SPAN>&nbsp;<SPAN class="p">);</SPAN><SPAN class="c">// Rough Stone Statue</SPAN></TD></TR><TR><TH id="L4277"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4277">4277</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4278"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4278">4278</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SKILL_INSCRIPTION:</SPAN></TD></TR><TR><TH id="L4279"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4279">4279</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">48114</SPAN>&nbsp;<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// scroll of intellect</SPAN></TD></TR><TR><TH id="L4280"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4280">4280</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">45382</SPAN>&nbsp;<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// scroll of stamina</SPAN></TD></TR><TR><TH id="L4281"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4281">4281</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">48116</SPAN>&nbsp;<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// scroll of spirit</SPAN></TD></TR><TR><TH id="L4282"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4282">4282</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">52738</SPAN>&nbsp;<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Ivory Ink</SPAN></TD></TR><TR><TH id="L4283"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4283">4283</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>addSpell<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">51005</SPAN>&nbsp;<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// Milling</SPAN></TD></TR><TR><TH id="L4284"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4284">4284</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4285"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4285">4285</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">};</SPAN></TD></TR><TR><TH id="L4286"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4286">4286</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4287"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4287">4287</A></TH><TD></TR><TR><TH id="L4288"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4288">4288</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonObject<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4289"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4289">4289</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4290"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4290">4290</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4291"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4291">4291</A></TH><TD></TR><TR><TH id="L4292"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4292">4292</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 entry <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L4293"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4293">4293</A></TH><TD></TR><TR><TH id="L4294"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4294">4294</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 mapid <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4295"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4295">4295</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;px <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4296"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4296">4296</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;py <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4297"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4297">4297</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;pz <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4298"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4298">4298</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;orient <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4299"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4299">4299</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;posx <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>posy <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>posz <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4300"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4300">4300</A></TH><TD></TR><TR><TH id="L4301"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4301">4301</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;entry <SPAN class="o">==</SPAN>&nbsp;GO_FISHING_BOBBER <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4302"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4302">4302</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4303"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4303">4303</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;co <SPAN class="o">=</SPAN>&nbsp;cos<SPAN class="p">(</SPAN>&nbsp;orient <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4304"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4304">4304</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;si <SPAN class="o">=</SPAN>&nbsp;sin<SPAN class="p">(</SPAN>&nbsp;orient <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4305"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4305">4305</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MapMgr <SPAN class="o">*</SPAN>&nbsp;map <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4306"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4306">4306</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>&nbsp;spell <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetCurrentSpell<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4307"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4307">4307</A></TH><TD></TR><TR><TH id="L4308"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4308">4308</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;r<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4309"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4309">4309</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>&nbsp;r <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN>&nbsp;r <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">10</SPAN><SPAN class="p">;</SPAN>&nbsp;r<SPAN class="o">--</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4310"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4310">4310</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4311"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4311">4311</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posx <SPAN class="o">=</SPAN>&nbsp;px <SPAN class="o">+</SPAN>&nbsp;r <SPAN class="o">*</SPAN>&nbsp;co<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4312"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4312">4312</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posy <SPAN class="o">=</SPAN>&nbsp;py <SPAN class="o">+</SPAN>&nbsp;r <SPAN class="o">*</SPAN>&nbsp;si<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4313"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4313">4313</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN><SPAN class="p">(</SPAN>map<SPAN class="o">-&gt;</SPAN>GetWaterType<SPAN class="p">(</SPAN>&nbsp;posx<SPAN class="p">,</SPAN>&nbsp;posy <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN><SPAN class="c">//water</SPAN></TD></TR><TR><TH id="L4314"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4314">4314</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">continue</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4315"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4315">4315</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posz <SPAN class="o">=</SPAN>&nbsp;map<SPAN class="o">-&gt;</SPAN>GetWaterHeight<SPAN class="p">(</SPAN>&nbsp;posx<SPAN class="p">,</SPAN>&nbsp;posy <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4316"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4316">4316</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;posz <SPAN class="o">&gt;</SPAN>&nbsp;map<SPAN class="o">-&gt;</SPAN>GetLandHeight<SPAN class="p">(</SPAN>&nbsp;posx<SPAN class="p">,</SPAN>&nbsp;posy <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN><SPAN class="c">//water</SPAN></TD></TR><TR><TH id="L4317"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4317">4317</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4318"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4318">4318</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4319"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4319">4319</A></TH><TD></TR><TR><TH id="L4320"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4320">4320</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posx <SPAN class="o">=</SPAN>&nbsp;px <SPAN class="o">+</SPAN>&nbsp;r <SPAN class="o">*</SPAN>&nbsp;co<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4321"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4321">4321</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posy <SPAN class="o">=</SPAN>&nbsp;py <SPAN class="o">+</SPAN>&nbsp;r <SPAN class="o">*</SPAN>&nbsp;si<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4322"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4322">4322</A></TH><TD></TR><TR><TH id="L4323"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4323">4323</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Todo / Fix me: This should be loaded / cached</SPAN></TD></TR><TR><TH id="L4324"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4324">4324</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 zone <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetAreaID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4325"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4325">4325</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;zone <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// If the player's area ID is 0, use the zone ID instead</SPAN></TD></TR><TR><TH id="L4326"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4326">4326</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; zone <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetZoneId<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4327"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4327">4327</A></TH><TD></TR><TR><TH id="L4328"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4328">4328</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 minskill<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4329"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4329">4329</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FishingZoneEntry <SPAN class="o">*</SPAN>fishentry <SPAN class="o">=</SPAN>&nbsp;FishingZoneStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;zone <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4330"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4330">4330</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>fishentry <SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Check database if there is fishing area / zone information, if not, return</SPAN></TD></TR><TR><TH id="L4331"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4331">4331</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4332"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4332">4332</A></TH><TD></TR><TR><TH id="L4333"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4333">4333</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Todo / Fix me: Add fishskill to the calculations</SPAN></TD></TR><TR><TH id="L4334"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4334">4334</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; minskill <SPAN class="o">=</SPAN>&nbsp;fishentry<SPAN class="o">-&gt;</SPAN>MinSkill<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4335"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4335">4335</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>SendChannelStart<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">20000</SPAN>&nbsp;<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// 30 seconds</SPAN></TD></TR><TR><TH id="L4336"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4336">4336</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*spell-&gt;SendSpellStart();</SPAN></TD></TR><TR><TH id="L4337"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4337">4337</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell-&gt;SendCastResult(SPELL_CANCAST_OK);</SPAN></TD></TR><TR><TH id="L4338"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4338">4338</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell-&gt;SendSpellGo ();*/</SPAN></TD></TR><TR><TH id="L4339"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4339">4339</A></TH><TD></TR><TR><TH id="L4340"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4340">4340</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GameObject <SPAN class="o">*</SPAN>go <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateGameObject<SPAN class="p">(</SPAN>GO_FISHING_BOBBER<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4341"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4341">4341</A></TH><TD></TR><TR><TH id="L4342"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4342">4342</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>CreateFromProto<SPAN class="p">(</SPAN>&nbsp;GO_FISHING_BOBBER<SPAN class="p">,</SPAN>&nbsp;mapid<SPAN class="p">,</SPAN>&nbsp;posx<SPAN class="p">,</SPAN>&nbsp;posy<SPAN class="p">,</SPAN>&nbsp;posz<SPAN class="p">,</SPAN>&nbsp;orient <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4343"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4343">4343</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>&nbsp;GAMEOBJECT_FLAGS<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4344"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4344">4344</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>SetByte<SPAN class="p">(</SPAN>&nbsp;GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4345"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4345">4345</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_CREATED_BY<SPAN class="p">,</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4346"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4346">4346</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_CHANNEL_OBJECT<SPAN class="p">,</SPAN>&nbsp;go<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4347"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4347">4347</A></TH><TD></TR><TR><TH id="L4348"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4348">4348</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>SetInstanceID<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4349"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4349">4349</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4350"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4350">4350</A></TH><TD></TR><TR><TH id="L4351"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4351">4351</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;lootmgr<SPAN class="p">.</SPAN>IsFishable<SPAN class="p">(</SPAN>&nbsp;zone <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Only set a 'splash' if there is any loot in this area / zone</SPAN></TD></TR><TR><TH id="L4352"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4352">4352</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4353"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4353">4353</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 seconds <SPAN class="o">=</SPAN>&nbsp;RandomUInt<SPAN class="p">(</SPAN><SPAN class="mi">17</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4354"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4354">4354</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>&nbsp;go<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>GameObject<SPAN class="o">::</SPAN>FishHooked<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">),</SPAN>&nbsp;EVENT_GAMEOBJECT_FISH_HOOKED<SPAN class="p">,</SPAN>&nbsp;seconds <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">1000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4355"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4355">4355</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4356"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4356">4356</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>&nbsp;go<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>GameObject<SPAN class="o">::</SPAN>EndFishing<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">),</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;EVENT_GAMEOBJECT_END_FISHING<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">20000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4357"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4357">4357</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetSummonedObject<SPAN class="p">(</SPAN>&nbsp;go <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4358"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4358">4358</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4359"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4359">4359</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4360"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4360">4360</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4361"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4361">4361</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posx<SPAN class="o">=</SPAN>px<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4362"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4362">4362</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posy<SPAN class="o">=</SPAN>py<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4363"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4363">4363</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GameObjectInfo <SPAN class="o">*</SPAN>&nbsp;goI <SPAN class="o">=</SPAN>&nbsp;GameObjectNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4364"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4364">4364</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>goI<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4365"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4365">4365</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4366"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4366">4366</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4367"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4367">4367</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4368"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4368">4368</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sChatHandler<SPAN class="p">.</SPAN>BlueSystemMessage<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="s">"non-existant gameobject %u tried to be created by SpellEffectSummonObject. Report to devs!"</SPAN><SPAN class="p">,</SPAN>&nbsp;entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4369"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4369">4369</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4370"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4370">4370</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4371"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4371">4371</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4372"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4372">4372</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_targetMask <SPAN class="o">&amp;</SPAN>&nbsp;TARGET_FLAG_DEST_LOCATION <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destX <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4373"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4373">4373</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4374"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4374">4374</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posx <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destX<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4375"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4375">4375</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; posy <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4376"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4376">4376</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pz <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4377"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4377">4377</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4378"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4378">4378</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GameObject <SPAN class="o">*</SPAN>go<SPAN class="o">=</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateGameObject<SPAN class="p">(</SPAN>entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4379"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4379">4379</A></TH><TD></TR><TR><TH id="L4380"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4380">4380</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>SetInstanceID<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4381"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4381">4381</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>CreateFromProto<SPAN class="p">(</SPAN>entry<SPAN class="p">,</SPAN>mapid<SPAN class="p">,</SPAN>posx<SPAN class="p">,</SPAN>posy<SPAN class="p">,</SPAN>pz<SPAN class="p">,</SPAN>orient<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4382"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4382">4382</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>SetByte<SPAN class="p">(</SPAN>GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4383"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4383">4383</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>OBJECT_FIELD_CREATED_BY<SPAN class="p">,</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4384"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4384">4384</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4385"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4385">4385</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>go<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>GameObject<SPAN class="o">::</SPAN>ExpireAndDelete<SPAN class="p">,</SPAN>&nbsp;EVENT_GAMEOBJECT_EXPIRE<SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4386"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4386">4386</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;entry <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">17032</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// this is a portal</SPAN></TD></TR><TR><TH id="L4387"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4387">4387</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4388"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4388">4388</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// enable it for party only</SPAN></TD></TR><TR><TH id="L4389"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4389">4389</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>SetByte<SPAN class="p">(</SPAN>&nbsp;GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4390"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4390">4390</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//disable by default</SPAN></TD></TR><TR><TH id="L4391"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4391">4391</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WorldPacket <SPAN class="o">*</SPAN>&nbsp;pkt <SPAN class="o">=</SPAN>&nbsp;go<SPAN class="o">-&gt;</SPAN>BuildFieldUpdatePacket<SPAN class="p">(</SPAN>GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="mi">24</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4392"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4392">4392</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SubGroup <SPAN class="o">*</SPAN>&nbsp;pGroup <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGroup<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGroup<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetSubGroup<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetSubGroup<SPAN class="p">())</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4393"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4393">4393</A></TH><TD></TR><TR><TH id="L4394"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4394">4394</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;pGroup <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4395"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4395">4395</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4396"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4396">4396</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetGroup<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Lock<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4397"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4397">4397</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;GroupMembersSet<SPAN class="o">::</SPAN>iterator itr <SPAN class="o">=</SPAN>&nbsp;pGroup<SPAN class="o">-&gt;</SPAN>GetGroupMembersBegin<SPAN class="p">();</SPAN>&nbsp;itr <SPAN class="o">!=</SPAN>&nbsp;pGroup<SPAN class="o">-&gt;</SPAN>GetGroupMembersEnd<SPAN class="p">();</SPAN>&nbsp;<SPAN class="o">++</SPAN>itr <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4398"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4398">4398</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4399"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4399">4399</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>m_loggedInPlayer <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_caster <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>m_loggedInPlayer <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4400"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4400">4400</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>m_loggedInPlayer<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendPacket<SPAN class="p">(</SPAN>&nbsp;pkt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4401"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4401">4401</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4402"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4402">4402</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetGroup<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Unlock<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4403"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4403">4403</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4404"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4404">4404</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">delete</SPAN>&nbsp;pkt<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4405"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4405">4405</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4406"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4406">4406</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;entry <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">36727</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;entry <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">177193</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Portal of Summoning and portal of doom</SPAN></TD></TR><TR><TH id="L4407"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4407">4407</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4408"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4408">4408</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Player * pTarget = p_caster-&gt;GetMapMgr()-&gt;GetPlayer( p_caster-&gt;GetSelection() );</SPAN></TD></TR><TR><TH id="L4409"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4409">4409</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Player <SPAN class="o">*</SPAN>&nbsp;pTarget <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetPlayer<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetSelection<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4410"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4410">4410</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>pTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>pTarget<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4411"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4411">4411</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4412"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4412">4412</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>m_ritualmembers<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetLowGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4413"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4413">4413</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>m_ritualcaster <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetLowGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4414"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4414">4414</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>m_ritualtarget <SPAN class="o">=</SPAN>&nbsp;pTarget<SPAN class="o">-&gt;</SPAN>GetLowGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4415"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4415">4415</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>m_ritualspell <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4416"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4416">4416</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4417"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4417">4417</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;entry <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">186811</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;entry <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">181622</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// ritual of refreshment, ritual of souls</SPAN></TD></TR><TR><TH id="L4418"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4418">4418</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4419"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4419">4419</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>m_ritualmembers<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetLowGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4420"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4420">4420</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>m_ritualcaster <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetLowGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4421"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4421">4421</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>m_ritualtarget <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4422"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4422">4422</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>m_ritualspell <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4423"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4423">4423</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4424"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4424">4424</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;entry <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">186812</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;entry <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">181621</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Refreshment Table, Soulwell</SPAN></TD></TR><TR><TH id="L4425"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4425">4425</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4426"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4426">4426</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>charges <SPAN class="o">=</SPAN>&nbsp;goI<SPAN class="o">-&gt;</SPAN>sound1<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4427"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4427">4427</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4428"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4428">4428</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN><SPAN class="c">//Lightwell,if there is some other type -- add it</SPAN></TD></TR><TR><TH id="L4429"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4429">4429</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4430"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4430">4430</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go<SPAN class="o">-&gt;</SPAN>charges <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">5</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//Max 5 charges</SPAN></TD></TR><TR><TH id="L4431"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4431">4431</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4432"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4432">4432</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetSummonedObject<SPAN class="p">(</SPAN>go<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4433"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4433">4433</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4434"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4434">4434</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4435"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4435">4435</A></TH><TD></TR><TR><TH id="L4436"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4436">4436</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectEnchantItem<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Enchant Item Permanent</SPAN></TD></TR><TR><TH id="L4437"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4437">4437</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4438"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4438">4438</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>itemTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4439"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4439">4439</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; EnchantEntry <SPAN class="o">*</SPAN>&nbsp;Enchantment <SPAN class="o">=</SPAN>&nbsp;dbcEnchant<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L4440"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4440">4440</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>Enchantment<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4441"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4441">4441</A></TH><TD></TR><TR><TH id="L4442"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4442">4442</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetPermissionCount<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4443"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4443">4443</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sGMLog<SPAN class="p">.</SPAN>writefromsession<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="s">"enchanted item for %s"</SPAN><SPAN class="p">,</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>GetOwner<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetName<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4444"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4444">4444</A></TH><TD></TR><TR><TH id="L4445"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4445">4445</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//remove other perm enchantment that was enchanted by profession</SPAN></TD></TR><TR><TH id="L4446"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4446">4446</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; itemTarget<SPAN class="o">-&gt;</SPAN>RemoveProfessionEnchant<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4447"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4447">4447</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; int32 Slot <SPAN class="o">=</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>AddEnchantment<SPAN class="p">(</SPAN>Enchantment<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4448"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4448">4448</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>Slot <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4449"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4449">4449</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// Apply failed</SPAN></TD></TR><TR><TH id="L4450"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4450">4450</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4451"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4451">4451</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; DetermineSkillUp<SPAN class="p">(</SPAN>SKILL_ENCHANTING<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4452"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4452">4452</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4453"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4453">4453</A></TH><TD></TR><TR><TH id="L4454"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4454">4454</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectEnchantItemTemporary<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp; <SPAN class="c">// Enchant Item Temporary</SPAN></TD></TR><TR><TH id="L4455"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4455">4455</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4456"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4456">4456</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>itemTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4457"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4457">4457</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 Duration <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;damage <SPAN class="o">:</SPAN>&nbsp;<SPAN class="mi">3600</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4458"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4458">4458</A></TH><TD></TR><TR><TH id="L4459"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4459">4459</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// dont allow temporary enchants unless we're the owner of the item</SPAN></TD></TR><TR><TH id="L4460"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4460">4460</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetOwner<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4461"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4461">4461</A></TH><TD></TR><TR><TH id="L4462"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4462">4462</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; EnchantEntry <SPAN class="o">*</SPAN>&nbsp;Enchantment <SPAN class="o">=</SPAN>&nbsp;dbcEnchant<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L4463"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4463">4463</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>Enchantment<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4464"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4464">4464</A></TH><TD></TR><TR><TH id="L4465"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4465">4465</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; itemTarget<SPAN class="o">-&gt;</SPAN>RemoveEnchantment<SPAN class="p">(</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4466"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4466">4466</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; int32 Slot <SPAN class="o">=</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>AddEnchantment<SPAN class="p">(</SPAN>Enchantment<SPAN class="p">,</SPAN>&nbsp;Duration<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4467"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4467">4467</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>Slot <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// Apply failed</SPAN></TD></TR><TR><TH id="L4468"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4468">4468</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4469"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4469">4469</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; skilllinespell<SPAN class="o">*</SPAN>&nbsp;skill <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetSpellSkill<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4470"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4470">4470</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>skill<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4471"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4471">4471</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DetermineSkillUp<SPAN class="p">(</SPAN>skill<SPAN class="o">-&gt;</SPAN>skilline<SPAN class="p">,</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>ItemLevel<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4472"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4472">4472</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4473"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4473">4473</A></TH><TD></TR><TR><TH id="L4474"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4474">4474</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectTameCreature<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4475"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4475">4475</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4476"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4476">4476</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Creature<SPAN class="o">*</SPAN>&nbsp;tame <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_UNIT <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Creature<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4477"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4477">4477</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>tame <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4478"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4478">4478</A></TH><TD></TR><TR><TH id="L4479"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4479">4479</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Remove target</SPAN></TD></TR><TR><TH id="L4480"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4480">4480</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; tame<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>HandleEvent<SPAN class="p">(</SPAN>EVENT_LEAVECOMBAT<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4481"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4481">4481</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>pPet <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>CreatePet<SPAN class="p">(</SPAN>&nbsp;tame<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4482"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4482">4482</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>CreateAsSummon<SPAN class="p">(</SPAN>tame<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">(),</SPAN>&nbsp;tame<SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">(),</SPAN>&nbsp;tame<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4483"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4483">4483</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; tame<SPAN class="o">-&gt;</SPAN>Despawn<SPAN class="p">(</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>tame<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">?</SPAN>&nbsp;tame<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN><SPAN class="nl">RespawnTime:</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4484"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4484">4484</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4485"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4485">4485</A></TH><TD></TR><TR><TH id="L4486"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4486">4486</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonPet<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//summon - pet</SPAN></TD></TR><TR><TH id="L4487"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4487">4487</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4488"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4488">4488</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4489"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4489">4489</A></TH><TD></TR><TR><TH id="L4490"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4490">4490</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">883</SPAN>&nbsp;<SPAN class="p">)</SPAN><SPAN class="c">// "Call Pet" spell</SPAN></TD></TR><TR><TH id="L4491"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4491">4491</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4492"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4492">4492</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetSummon<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4493"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4493">4493</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4494"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4494">4494</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendNotification<SPAN class="p">(</SPAN><SPAN class="s">"You already have a pet summoned."</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4495"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4495">4495</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4496"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4496">4496</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4497"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4497">4497</A></TH><TD></TR><TR><TH id="L4498"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4498">4498</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 petno <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUnstabledPetNumber<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4499"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4499">4499</A></TH><TD></TR><TR><TH id="L4500"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4500">4500</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;petno <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4501"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4501">4501</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4502"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4502">4502</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SpawnPet<SPAN class="p">(</SPAN>petno<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4503"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4503">4503</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4504"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4504">4504</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4505"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4505">4505</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4506"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4506">4506</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_AREA_TRIGGER_MESSAGE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">50</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4507"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4507">4507</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="s">"You do not have any pets to call."</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint8<SPAN class="p">(</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4508"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4508">4508</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendPacket<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4509"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4509">4509</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4510"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4510">4510</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4511"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4511">4511</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4512"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4512">4512</A></TH><TD></TR><TR><TH id="L4513"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4513">4513</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//uint32 entryId = GetProto()-&gt;EffectMiscValue[i];</SPAN></TD></TR><TR><TH id="L4514"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4514">4514</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4515"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4515">4515</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//VoidWalker:torment, sacrifice, suffering, consume shadows</SPAN></TD></TR><TR><TH id="L4516"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4516">4516</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Succubus:lash of pain, soothing kiss, seduce , lesser invisibility</SPAN></TD></TR><TR><TH id="L4517"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4517">4517</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//felhunter:&nbsp; &nbsp; &nbsp;Devour Magic,Paranoia,Spell Lock,&nbsp; &nbsp; &nbsp; Tainted Blood</SPAN></TD></TR><TR><TH id="L4518"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4518">4518</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4519"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4519">4519</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// remove old pet</SPAN></TD></TR><TR><TH id="L4520"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4520">4520</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>old <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>m_caster<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetSummon<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4521"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4521">4521</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>old<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4522"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4522">4522</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; old<SPAN class="o">-&gt;</SPAN>Dismiss<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4523"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4523">4523</A></TH><TD></TR><TR><TH id="L4524"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4524">4524</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4525"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4525">4525</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;ci <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4526"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4526">4526</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4527"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4527">4527</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>getClass<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;WARLOCK<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4528"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4528">4528</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4529"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4529">4529</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//if demonic sacrifice auras are still active, remove them</SPAN></TD></TR><TR><TH id="L4530"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4530">4530</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>RemoveAura<SPAN class="p">(</SPAN><SPAN class="mi">18789</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4531"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4531">4531</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>RemoveAura<SPAN class="p">(</SPAN><SPAN class="mi">18790</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4532"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4532">4532</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>RemoveAura<SPAN class="p">(</SPAN><SPAN class="mi">18791</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4533"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4533">4533</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>RemoveAura<SPAN class="p">(</SPAN><SPAN class="mi">18792</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4534"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4534">4534</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>RemoveAura<SPAN class="p">(</SPAN><SPAN class="mi">35701</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4535"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4535">4535</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4536"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4536">4536</A></TH><TD></TR><TR><TH id="L4537"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4537">4537</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>summon <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>CreatePet<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4538"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4538">4538</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summon<SPAN class="o">-&gt;</SPAN>CreateAsSummon<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;ci<SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4539"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4539">4539</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4540"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4540">4540</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4541"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4541">4541</A></TH><TD></TR><TR><TH id="L4542"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4542">4542</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectWeapondamage<SPAN class="p">(</SPAN>&nbsp;uint32 i <SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Weapon damage +</SPAN></TD></TR><TR><TH id="L4543"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4543">4543</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4544"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4544">4544</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4545"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4545">4545</A></TH><TD></TR><TR><TH id="L4546"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4546">4546</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Hackfix for Mangle</SPAN></TD></TR><TR><TH id="L4547"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4547">4547</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_MANGLE___CAT <SPAN class="o">&amp;&amp;</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4548"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4548">4548</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;u_caster <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>AddComboPoints<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4549"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4549">4549</A></TH><TD></TR><TR><TH id="L4550"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4550">4550</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Hacky fix for druid spells where it would "double attack".</SPAN></TD></TR><TR><TH id="L4551"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4551">4551</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_WEAPON_PERCENT_DAMAGE <SPAN class="o">||</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_WEAPON_PERCENT_DAMAGE <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4552"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4552">4552</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4553"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4553">4553</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add_damage <SPAN class="o">+=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4554"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4554">4554</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4555"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4555">4555</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4556"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4556">4556</A></TH><TD></TR><TR><TH id="L4557"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4557">4557</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 _type<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4558"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4558">4558</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_DMG_TYPE_RANGED <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4559"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4559">4559</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp;RANGED<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4560"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4560">4560</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4561"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4561">4561</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4562"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4562">4562</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttributesExC <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mh">0x1000000</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4563"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4563">4563</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp; OFFHAND<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4564"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4564">4564</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4565"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4565">4565</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp;MELEE<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4566"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4566">4566</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4567"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4567">4567</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Strike<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;_type<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;damage<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4568"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4568">4568</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4569"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4569">4569</A></TH><TD></TR><TR><TH id="L4570"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4570">4570</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectPowerBurn<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// power burn</SPAN></TD></TR><TR><TH id="L4571"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4571">4571</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4572"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4572">4572</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPowerType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;POWER_TYPE_MANA<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4573"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4573">4573</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4574"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4574">4574</A></TH><TD></TR><TR><TH id="L4575"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4575">4575</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4576"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4576">4576</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4577"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4577">4577</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Player<SPAN class="o">*</SPAN>&nbsp;mPlayer <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4578"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4578">4578</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;mPlayer<SPAN class="o">-&gt;</SPAN>IsInFeralForm<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4579"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4579">4579</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4580"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4580">4580</A></TH><TD></TR><TR><TH id="L4581"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4581">4581</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Resilience - reduces the effect of mana drains by (CalcRating*2)%.</SPAN></TD></TR><TR><TH id="L4582"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4582">4582</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; damage <SPAN class="o">*=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>CalcRating<SPAN class="p">(</SPAN>&nbsp;PLAYER_RATING_MODIFIER_SPELL_CRIT_RESILIENCE <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">2</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mf">100.0f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4583"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4583">4583</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4584"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4584">4584</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="k">this</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4585"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4585">4585</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 mult <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4586"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4586">4586</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; damage <SPAN class="o">=</SPAN>&nbsp;mult <SPAN class="o">*</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4587"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4587">4587</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>IsUnit<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4588"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4588">4588</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Unit<SPAN class="o">*</SPAN>&nbsp;caster <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Unit<SPAN class="o">*&gt;</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="k">this</SPAN><SPAN class="o">-&gt;</SPAN>m_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4589"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4589">4589</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>&nbsp;damage <SPAN class="o">&gt;</SPAN>&nbsp;caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN>mult<SPAN class="o">*</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;</TD></TR><TR><TH id="L4590"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4590">4590</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; damage <SPAN class="o">=</SPAN>&nbsp;caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN>mult<SPAN class="o">*</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4591"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4591">4591</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4592"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4592">4592</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4593"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4593">4593</A></TH><TD></TR><TR><TH id="L4594"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4594">4594</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; int32 mana <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>int32<SPAN class="p">)</SPAN>min<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>int32<SPAN class="p">)</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_POWER1 <SPAN class="p">),</SPAN>&nbsp;damage <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4595"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4595">4595</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>ModUnsigned32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER1<SPAN class="p">,</SPAN><SPAN class="o">-</SPAN>mana<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4596"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4596">4596</A></TH><TD></TR><TR><TH id="L4597"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4597">4597</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SpellNonMeleeDamageLog<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)(</SPAN>mana <SPAN class="o">*</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effectunknown<SPAN class="p">[</SPAN>i<SPAN class="p">]),</SPAN>&nbsp;pSpellId <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4598"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4598">4598</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4599"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4599">4599</A></TH><TD></TR><TR><TH id="L4600"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4600">4600</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectThreat<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Threat</SPAN></TD></TR><TR><TH id="L4601"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4601">4601</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4602"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4602">4602</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsCreature<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4603"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4603">4603</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4604"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4604">4604</A></TH><TD></TR><TR><TH id="L4605"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4605">4605</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; int32 amount <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L4606"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4606">4606</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4607"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4607">4607</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SM_FIValue<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>SM_FMiscEffect<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>amount<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4608"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4608">4608</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SM_PIValue<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>SM_PMiscEffect<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>amount<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4609"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4609">4609</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4610"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4610">4610</A></TH><TD></TR><TR><TH id="L4611"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4611">4611</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;chck <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modThreatByPtr<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;amount<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4612"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4612">4612</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>chck<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4613"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4613">4613</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttackReaction<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4614"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4614">4614</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4615"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4615">4615</A></TH><TD></TR><TR><TH id="L4616"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4616">4616</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectTriggerSpell<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Trigger Spell</SPAN></TD></TR><TR><TH id="L4617"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4617">4617</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4618"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4618">4618</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>entry <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectTriggerSpell<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L4619"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4619">4619</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>entry<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4620"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4620">4620</A></TH><TD></TR><TR><TH id="L4621"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4621">4621</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets targets <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4622"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4622">4622</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4623"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4623">4623</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4624"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4624">4624</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4625"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4625">4625</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>m_caster<SPAN class="p">,</SPAN>entry<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4626"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4626">4626</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>targets<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4627"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4627">4627</A></TH><TD></TR><TR><TH id="L4628"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4628">4628</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4629"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4629">4629</A></TH><TD></TR><TR><TH id="L4630"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4630">4630</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectPowerFunnel<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Power Funnel</SPAN></TD></TR><TR><TH id="L4631"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4631">4631</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4632"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4632">4632</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L4633"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4633">4633</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4634"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4634">4634</A></TH><TD></TR><TR><TH id="L4635"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4635">4635</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//does not exist</SPAN></TD></TR><TR><TH id="L4636"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4636">4636</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4637"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4637">4637</A></TH><TD></TR><TR><TH id="L4638"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4638">4638</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectHealMaxHealth<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp; &nbsp;<SPAN class="c">// Heal Max Health</SPAN></TD></TR><TR><TH id="L4639"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4639">4639</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4640"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4640">4640</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4641"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4641">4641</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4642"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4642">4642</A></TH><TD></TR><TR><TH id="L4643"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4643">4643</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 dif <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_MAXHEALTH <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_HEALTH <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4644"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4644">4644</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>dif <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4645"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4645">4645</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4646"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4646">4646</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>&nbsp;SPELL_FAILED_ALREADY_AT_FULL_HEALTH <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4647"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4647">4647</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4648"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4648">4648</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4649"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4649">4649</A></TH><TD></TR><TR><TH id="L4650"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4650">4650</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_PLAYER<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4651"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4651">4651</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4652"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4652">4652</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendHealSpellOnPlayer<SPAN class="p">(</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">),</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">),</SPAN>&nbsp;dif<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4653"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4653">4653</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4654"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4654">4654</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>ModUnsigned32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_HEALTH<SPAN class="p">,</SPAN>&nbsp;dif <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4655"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4655">4655</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4656"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4656">4656</A></TH><TD></TR><TR><TH id="L4657"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4657">4657</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectInterruptCast<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Interrupt Cast</SPAN></TD></TR><TR><TH id="L4658"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4658">4658</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4659"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4659">4659</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4660"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4660">4660</A></TH><TD></TR><TR><TH id="L4661"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4661">4661</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4662"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4662">4662</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4663"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4663">4663</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>u_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="p">(</SPAN>u_caster <SPAN class="o">!=</SPAN>&nbsp;unitTarget<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L4664"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4664">4664</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4665"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4665">4665</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttackReaction<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;m_spellInfo<SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4666"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4666">4666</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>c <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4667"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4667">4667</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c <SPAN class="o">&amp;&amp;</SPAN>&nbsp;c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4668"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4668">4668</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4669"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4669">4669</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>c<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modImmunities <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mi">32768</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4670"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4670">4670</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4671"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4671">4671</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4672"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4672">4672</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4673"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4673">4673</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4674"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4674">4674</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// FIXME:This thing prevent target from spell casting too but cant find.</SPAN></TD></TR><TR><TH id="L4675"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4675">4675</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; uint32 school <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4676"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4676">4676</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetCurrentSpell<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L4677"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4677">4677</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4678"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4678">4678</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; school<SPAN class="o">=</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetCurrentSpell<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>School<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4679"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4679">4679</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>GetCurrentSpell<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>cancel<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4680"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4680">4680</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4681"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4681">4681</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>school<SPAN class="p">)</SPAN><SPAN class="c">//prevent from casts in this school</SPAN></TD></TR><TR><TH id="L4682"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4682">4682</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4683"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4683">4683</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 duration <SPAN class="o">=</SPAN>&nbsp;GetDuration<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4684"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4684">4684</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()){</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// Check for interruption reducing talents</SPAN></TD></TR><TR><TH id="L4685"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4685">4685</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 DurationModifier <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>MechanicDurationPctMod<SPAN class="p">[</SPAN>MECHANIC_INTERRUPTED<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L4686"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4686">4686</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>DurationModifier <SPAN class="o">&gt;=</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4687"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4687">4687</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; duration <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>duration <SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="mi">100</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;DurationModifier<SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4688"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4688">4688</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4689"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4689">4689</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SchoolCastPrevent<SPAN class="p">[</SPAN>school<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;duration <SPAN class="o">+</SPAN>&nbsp;getMSTime<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4690"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4690">4690</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// TODO: visual!</SPAN></TD></TR><TR><TH id="L4691"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4691">4691</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4692"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4692">4692</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4693"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4693">4693</A></TH><TD></TR><TR><TH id="L4694"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4694">4694</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDistract<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Distract</SPAN></TD></TR><TR><TH id="L4695"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4695">4695</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4696"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4696">4696</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//spellId 1725 Distract:Throws a distraction attracting the all monsters for ten sec's</SPAN></TD></TR><TR><TH id="L4697"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4697">4697</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L4698"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4698">4698</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4699"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4699">4699</A></TH><TD></TR><TR><TH id="L4700"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4700">4700</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>m_targets<SPAN class="p">.</SPAN>m_destX <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4701"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4701">4701</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4702"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4702">4702</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget-&gt;GetAIInterface()-&gt;MoveTo(m_targets.m_destX, m_targets.m_destY, m_targets.m_destZ, 0);</SPAN></TD></TR><TR><TH id="L4703"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4703">4703</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 Stare_duration <SPAN class="o">=</SPAN>&nbsp;GetDuration<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4704"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4704">4704</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>Stare_duration <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">30</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">60</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">1000</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4705"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4705">4705</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Stare_duration <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">10000</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//if we try to stare for more then a half an hour then better not stare at all :P (bug)</SPAN></TD></TR><TR><TH id="L4706"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4706">4706</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;newo <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>calcRadAngle<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destX<SPAN class="p">,</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4707"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4707">4707</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>StopMovement<SPAN class="p">(</SPAN>Stare_duration<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4708"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4708">4708</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetFacing<SPAN class="p">(</SPAN>newo<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4709"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4709">4709</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4710"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4710">4710</A></TH><TD></TR><TR><TH id="L4711"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4711">4711</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Smoke Emitter 164870</SPAN></TD></TR><TR><TH id="L4712"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4712">4712</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Smoke Emitter Big 179066</SPAN></TD></TR><TR><TH id="L4713"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4713">4713</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Unit Field Target of</SPAN></TD></TR><TR><TH id="L4714"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4714">4714</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4715"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4715">4715</A></TH><TD></TR><TR><TH id="L4716"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4716">4716</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectPickpocket<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// pickpocket</SPAN></TD></TR><TR><TH id="L4717"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4717">4717</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4718"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4718">4718</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Show random loot based on roll,</SPAN></TD></TR><TR><TH id="L4719"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4719">4719</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;TYPEID_UNIT<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4720"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4720">4720</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4721"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4721">4721</A></TH><TD></TR><TR><TH id="L4722"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4722">4722</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>target <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4723"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4723">4723</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>target<SPAN class="o">-&gt;</SPAN>IsPickPocketed<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="p">(</SPAN>target<SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;target<SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Type <SPAN class="o">!=</SPAN>&nbsp;HUMANOID<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L4724"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4724">4724</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4725"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4725">4725</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_TARGET_NO_POCKETS<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4726"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4726">4726</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4727"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4727">4727</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4728"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4728">4728</A></TH><TD></TR><TR><TH id="L4729"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4729">4729</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillPickpocketingLoot<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">,</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4730"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4730">4730</A></TH><TD></TR><TR><TH id="L4731"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4731">4731</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 _rank <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Rank <SPAN class="o">:</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4732"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4732">4732</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>gold <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">((</SPAN>_rank<SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN>RandomUInt<SPAN class="p">(</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;sWorld<SPAN class="p">.</SPAN>getRate<SPAN class="p">(</SPAN>RATE_MONEY<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L4733"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4733">4733</A></TH><TD></TR><TR><TH id="L4734"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4734">4734</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SendLoot<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;LOOT_PICKPOCKETING <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4735"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4735">4735</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; target<SPAN class="o">-&gt;</SPAN>SetPickPocketed<SPAN class="p">(</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4736"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4736">4736</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4737"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4737">4737</A></TH><TD></TR><TR><TH id="L4738"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4738">4738</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectAddFarsight<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Add Farsight</SPAN></TD></TR><TR><TH id="L4739"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4739">4739</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4740"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4740">4740</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4741"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4741">4741</A></TH><TD></TR><TR><TH id="L4742"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4742">4742</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;x <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destX<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4743"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4743">4743</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;y <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4744"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4744">4744</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;z <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4745"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4745">4745</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>x <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN>&nbsp;x <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_srcX<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4746"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4746">4746</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>y <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN>&nbsp;y <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_srcY<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4747"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4747">4747</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>z <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN>&nbsp;z <SPAN class="o">=</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_srcZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4748"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4748">4748</A></TH><TD></TR><TR><TH id="L4749"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4749">4749</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; DynamicObject <SPAN class="o">*</SPAN>&nbsp;dynObj <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateDynamicObject<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L4750"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4750">4750</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>Create<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">,</SPAN>&nbsp;x<SPAN class="p">,</SPAN>&nbsp;y<SPAN class="p">,</SPAN>&nbsp;z<SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">(),</SPAN>&nbsp;GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L4751"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4751">4751</A></TH><TD></TR><TR><TH id="L4752"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4752">4752</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; ASSERT<SPAN class="p">(</SPAN>dynObj<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4753"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4753">4753</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L4754"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4754">4754</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if( dynObj == NULL ) //i &lt;3 burlex :P</SPAN></TD></TR><TR><TH id="L4755"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4755">4755</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L4756"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4756">4756</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; delete dynObj;</SPAN></TD></TR><TR><TH id="L4757"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4757">4757</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; return;</SPAN></TD></TR><TR><TH id="L4758"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4758">4758</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L4759"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4759">4759</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L4760"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4760">4760</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>OBJECT_FIELD_TYPE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">65</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4761"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4761">4761</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>DYNAMICOBJECT_BYTES<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mh">0x80000002</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4762"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4762">4762</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; dynObj<SPAN class="o">-&gt;</SPAN>SetInstanceID<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4763"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4763">4763</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>PLAYER_FARSIGHT<SPAN class="p">,</SPAN>&nbsp;dynObj<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4764"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4764">4764</A></TH><TD></TR><TR><TH id="L4765"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4765">4765</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>ChangeFarsightLocation<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;dynObj<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4766"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4766">4766</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4767"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4767">4767</A></TH><TD></TR><TR><TH id="L4768"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4768">4768</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonPossessed<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// eye of kilrog</SPAN></TD></TR><TR><TH id="L4769"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4769">4769</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4770"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4770">4770</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L4771"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4771">4771</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; m_target-&gt;DisableAI();</SPAN></TD></TR><TR><TH id="L4772"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4772">4772</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; pCaster-&gt;SetUInt64Value(UNIT_FIELD_SUMMON, 0);</SPAN></TD></TR><TR><TH id="L4773"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4773">4773</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; m_target-&gt;SetUInt64Value(UNIT_FIELD_SUMMONEDBY, 0);</SPAN></TD></TR><TR><TH id="L4774"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4774">4774</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; pCaster-&gt;SetUInt64Value(UNIT_FIELD_CHARM, m_target-&gt;GetGUID());</SPAN></TD></TR><TR><TH id="L4775"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4775">4775</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; m_target-&gt;SetUInt64Value(UNIT_FIELD_CHARMEDBY, pCaster-&gt;GetGUID());</SPAN></TD></TR><TR><TH id="L4776"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4776">4776</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; pCaster-&gt;SetUInt64Value(PLAYER_FARSIGHT, m_target-&gt;GetGUID());</SPAN></TD></TR><TR><TH id="L4777"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4777">4777</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; pCaster-&gt;m_CurrentCharm = ((Creature*)m_target);</SPAN></TD></TR><TR><TH id="L4778"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4778">4778</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; m_target-&gt;SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_PLAYER_CONTROLLED_CREATURE);</SPAN></TD></TR><TR><TH id="L4779"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4779">4779</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; pCaster-&gt;m_noInterrupt = 1;</SPAN></TD></TR><TR><TH id="L4780"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4780">4780</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; pCaster-&gt;SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_LOCK_PLAYER);</SPAN></TD></TR><TR><TH id="L4781"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4781">4781</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4782"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4782">4782</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data(SMSG_CLIENT_CONTROL_UPDATE);</SPAN></TD></TR><TR><TH id="L4783"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4783">4783</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; data &lt;&lt; m_target-&gt;GetNewGUID() &lt;&lt; uint8(1);</SPAN></TD></TR><TR><TH id="L4784"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4784">4784</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; pCaster-&gt;GetSession()-&gt;SendPacket(&amp;data);</SPAN></TD></TR><TR><TH id="L4785"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4785">4785</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L4786"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4786">4786</A></TH><TD></TR><TR><TH id="L4787"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4787">4787</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L4788"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4788">4788</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo *ci = CreatureNameStorage.LookupEntry(GetProto()-&gt;EffectMiscValue[i]);</SPAN></TD></TR><TR><TH id="L4789"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4789">4789</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if( ci)</SPAN></TD></TR><TR><TH id="L4790"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4790">4790</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L4791"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4791">4791</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; Creature* NewSummon = m_caster-&gt;GetMapMgr()-&gt;CreateCreature();</SPAN></TD></TR><TR><TH id="L4792"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4792">4792</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; // Create</SPAN></TD></TR><TR><TH id="L4793"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4793">4793</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetInstanceID(m_caster-&gt;GetInstanceID());</SPAN></TD></TR><TR><TH id="L4794"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4794">4794</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;Create( ci-&gt;Name, m_caster-&gt;GetMapId(),</SPAN></TD></TR><TR><TH id="L4795"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4795">4795</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; m_caster-&gt;GetPositionX()+(3*(cos((float(M_PI)/2)+m_caster-&gt;GetOrientation()))), m_caster-&gt;GetPositionY()+(3*(cos((float(M_PI)/2)+m_caster-&gt;GetOrientation()))), m_caster-&gt;GetPositionZ(), m_caster-&gt;GetOrientation());</SPAN></TD></TR><TR><TH id="L4796"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4796">4796</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4797"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4797">4797</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; // Fields</SPAN></TD></TR><TR><TH id="L4798"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4798">4798</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetUInt32Value(UNIT_FIELD_LEVEL,m_caster-&gt;GetUInt32Value(UNIT_FIELD_LEVEL));</SPAN></TD></TR><TR><TH id="L4799"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4799">4799</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetUInt32Value(UNIT_FIELD_DISPLAYID,&nbsp; ci-&gt;Male_DisplayID);</SPAN></TD></TR><TR><TH id="L4800"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4800">4800</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetUInt32Value(UNIT_FIELD_NATIVEDISPLAYID, ci-&gt;Male_DisplayID);</SPAN></TD></TR><TR><TH id="L4801"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4801">4801</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetUInt64Value(UNIT_FIELD_SUMMONEDBY, m_caster-&gt;GetGUID());</SPAN></TD></TR><TR><TH id="L4802"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4802">4802</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetUInt64Value(UNIT_FIELD_CREATEDBY, m_caster-&gt;GetGUID());</SPAN></TD></TR><TR><TH id="L4803"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4803">4803</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetUInt32Value(UNIT_FIELD_HEALTH , 100);</SPAN></TD></TR><TR><TH id="L4804"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4804">4804</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetUInt32Value(UNIT_FIELD_MAXHEALTH , 100);</SPAN></TD></TR><TR><TH id="L4805"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4805">4805</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetUInt32Value(UNIT_FIELD_FACTIONTEMPLATE, 35);</SPAN></TD></TR><TR><TH id="L4806"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4806">4806</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetFloatValue(OBJECT_FIELD_SCALE_X,1.0f);</SPAN></TD></TR><TR><TH id="L4807"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4807">4807</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;SetUInt32Value(UNIT_FIELD_FLAGS, UNIT_FLAG_NOT_ATTACKABLE_9 | UNIT_FLAG_PLAYER_CONTROLLED_CREATURE);</SPAN></TD></TR><TR><TH id="L4808"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4808">4808</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4809"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4809">4809</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; //Setting faction</SPAN></TD></TR><TR><TH id="L4810"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4810">4810</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;_setFaction();</SPAN></TD></TR><TR><TH id="L4811"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4811">4811</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;m_temp_summon=true;</SPAN></TD></TR><TR><TH id="L4812"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4812">4812</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4813"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4813">4813</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; // Add To World</SPAN></TD></TR><TR><TH id="L4814"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4814">4814</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; NewSummon-&gt;PushToWorld(m_caster-&gt;GetMapMgr());</SPAN></TD></TR><TR><TH id="L4815"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4815">4815</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4816"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4816">4816</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; // Force an update on the player to create this guid.</SPAN></TD></TR><TR><TH id="L4817"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4817">4817</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; p_caster-&gt;ProcessPendingUpdates();</SPAN></TD></TR><TR><TH id="L4818"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4818">4818</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4819"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4819">4819</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; //p_caster-&gt;SetUInt64Value(UNIT_FIELD_SUMMON, NewSummon-&gt;GetGUID());</SPAN></TD></TR><TR><TH id="L4820"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4820">4820</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; //p_caster-&gt;SetUInt64Value(PLAYER_FARSIGHT, NewSummon-&gt;GetGUID());</SPAN></TD></TR><TR><TH id="L4821"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4821">4821</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; //p_caster-&gt;SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_LOCK_PLAYER);</SPAN></TD></TR><TR><TH id="L4822"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4822">4822</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; p_caster-&gt;Possess(NewSummon);</SPAN></TD></TR><TR><TH id="L4823"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4823">4823</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }*/</SPAN></TD></TR><TR><TH id="L4824"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4824">4824</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4825"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4825">4825</A></TH><TD></TR><TR><TH id="L4826"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4826">4826</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectUseGlyph<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4827"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4827">4827</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4828"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4828">4828</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4829"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4829">4829</A></TH><TD></TR><TR><TH id="L4830"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4830">4830</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 g_new <SPAN class="o">=</SPAN>&nbsp;m_spellInfo<SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L4831"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4831">4831</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GlyphPropertyEntry <SPAN class="o">*</SPAN>&nbsp;gp_new <SPAN class="o">=</SPAN>&nbsp;dbcGlyphProperty<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;g_new <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4832"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4832">4832</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>gp_new <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4833"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4833">4833</A></TH><TD></TR><TR><TH id="L4834"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4834">4834</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;PLAYER_GLYPHS_ENABLED <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;m_glyphslot <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4835"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4835">4835</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4836"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4836">4836</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>&nbsp;SPELL_FAILED_GLYPH_SOCKET_LOCKED <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4837"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4837">4837</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4838"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4838">4838</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4839"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4839">4839</A></TH><TD></TR><TR><TH id="L4840"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4840">4840</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 g_old <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;PLAYER_FIELD_GLYPHS_1 <SPAN class="o">+</SPAN>&nbsp;m_glyphslot <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4841"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4841">4841</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;g_old <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4842"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4842">4842</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4843"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4843">4843</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;g_old <SPAN class="o">==</SPAN>&nbsp;g_new <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4844"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4844">4844</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4845"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4845">4845</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L4846"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4846">4846</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4847"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4847">4847</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GlyphPropertyEntry <SPAN class="o">*</SPAN>&nbsp;gp_old <SPAN class="o">=</SPAN>&nbsp;dbcGlyphProperty<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;g_old <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4848"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4848">4848</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gp_old <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4849"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4849">4849</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>RemoveAura<SPAN class="p">(</SPAN>&nbsp;gp_old<SPAN class="o">-&gt;</SPAN>SpellID <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4850"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4850">4850</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>&nbsp;PLAYER_FIELD_GLYPHS_1 <SPAN class="o">+</SPAN>&nbsp;m_glyphslot<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4851"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4851">4851</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4852"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4852">4852</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4853"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4853">4853</A></TH><TD></TR><TR><TH id="L4854"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4854">4854</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GlyphSlotEntry <SPAN class="o">*</SPAN>&nbsp;gs <SPAN class="o">=</SPAN>&nbsp;dbcGlyphSlot<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;PLAYER_FIELD_GLYPH_SLOTS_1 <SPAN class="o">+</SPAN>&nbsp;m_glyphslot <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4855"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4855">4855</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gs <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4856"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4856">4856</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4857"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4857">4857</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;gs<SPAN class="o">-&gt;</SPAN>Type <SPAN class="o">!=</SPAN>&nbsp;gp_new<SPAN class="o">-&gt;</SPAN>Type <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4858"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4858">4858</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4859"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4859">4859</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>&nbsp;SPELL_FAILED_INVALID_GLYPH <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4860"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4860">4860</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4861"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4861">4861</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4862"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4862">4862</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>&nbsp;PLAYER_FIELD_GLYPHS_1 <SPAN class="o">+</SPAN>&nbsp;m_glyphslot<SPAN class="p">,</SPAN>&nbsp;g_new <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4863"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4863">4863</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;gp_new<SPAN class="o">-&gt;</SPAN>SpellID<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4864"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4864">4864</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4865"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4865">4865</A></TH><TD></TR><TR><TH id="L4866"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4866">4866</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4867"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4867">4867</A></TH><TD></TR><TR><TH id="L4868"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4868">4868</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectCreateSummonTotem<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4869"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4869">4869</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4870"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4870">4870</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Atalai Skeleton Totem</SPAN></TD></TR><TR><TH id="L4871"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4871">4871</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4872"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4872">4872</A></TH><TD></TR><TR><TH id="L4873"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4873">4873</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectHealMechanical<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4874"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4874">4874</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4875"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4875">4875</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;TYPEID_UNIT <SPAN class="o">||</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Type <SPAN class="o">!=</SPAN>&nbsp;MECHANICAL<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4876"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4876">4876</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4877"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4877">4877</A></TH><TD></TR><TR><TH id="L4878"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4878">4878</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Heal<SPAN class="p">((</SPAN>int32<SPAN class="p">)</SPAN>damage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4879"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4879">4879</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4880"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4880">4880</A></TH><TD></TR><TR><TH id="L4881"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4881">4881</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonObjectWild<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4882"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4882">4882</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4883"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4883">4883</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4884"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4884">4884</A></TH><TD></TR><TR><TH id="L4885"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4885">4885</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// spawn a new one</SPAN></TD></TR><TR><TH id="L4886"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4886">4886</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; GameObject <SPAN class="o">*</SPAN>GoSummon <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateGameObject<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L4887"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4887">4887</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>GoSummon<SPAN class="o">-&gt;</SPAN>CreateFromProto<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN></TD></TR><TR><TH id="L4888"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4888">4888</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L4889"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4889">4889</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4890"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4890">4890</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">delete</SPAN>&nbsp;GoSummon<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4891"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4891">4891</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4892"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4892">4892</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4893"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4893">4893</A></TH><TD></TR><TR><TH id="L4894"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4894">4894</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>SetInstanceID<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4895"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4895">4895</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>GAMEOBJECT_LEVEL<SPAN class="p">,</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4896"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4896">4896</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>OBJECT_FIELD_CREATED_BY<SPAN class="p">,</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4897"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4897">4897</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>SetByte<SPAN class="p">(</SPAN>GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4898"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4898">4898</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L4899"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4899">4899</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>SetSummoned<SPAN class="p">(</SPAN>u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4900"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4900">4900</A></TH><TD></TR><TR><TH id="L4901"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4901">4901</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>GoSummon<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>GameObject<SPAN class="o">::</SPAN>ExpireAndDelete<SPAN class="p">,</SPAN>&nbsp;EVENT_GAMEOBJECT_EXPIRE<SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4902"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4902">4902</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4903"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4903">4903</A></TH><TD></TR><TR><TH id="L4904"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4904">4904</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectScriptEffect<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Script Effect</SPAN></TD></TR><TR><TH id="L4905"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4905">4905</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4906"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4906">4906</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 spellId <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4907"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4907">4907</A></TH><TD></TR><TR><TH id="L4908"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4908">4908</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Try a dummy SpellHandler</SPAN></TD></TR><TR><TH id="L4909"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4909">4909</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>sScriptMgr<SPAN class="p">.</SPAN>CallScriptedDummySpell<SPAN class="p">(</SPAN>spellId<SPAN class="p">,</SPAN>&nbsp;i<SPAN class="p">,</SPAN>&nbsp;<SPAN class="k">this</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L4910"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4910">4910</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4911"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4911">4911</A></TH><TD></TR><TR><TH id="L4912"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4912">4912</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>spellId<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L4913"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4913">4913</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4914"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4914">4914</A></TH><TD></TR><TR><TH id="L4915"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4915">4915</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Arcane Missiles</SPAN></TD></TR><TR><TH id="L4916"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4916">4916</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L4917"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4917">4917</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 5143://Rank 1</SPAN></TD></TR><TR><TH id="L4918"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4918">4918</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 5144://Rank 2</SPAN></TD></TR><TR><TH id="L4919"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4919">4919</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 5145://Rank 3</SPAN></TD></TR><TR><TH id="L4920"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4920">4920</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 8416://Rank 4</SPAN></TD></TR><TR><TH id="L4921"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4921">4921</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 8417://Rank 5</SPAN></TD></TR><TR><TH id="L4922"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4922">4922</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 10211://Rank 6</SPAN></TD></TR><TR><TH id="L4923"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4923">4923</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 10212://Rank 7</SPAN></TD></TR><TR><TH id="L4924"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4924">4924</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 25345://Rank 8</SPAN></TD></TR><TR><TH id="L4925"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4925">4925</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L4926"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4926">4926</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(m_tmpAffect == 0)</SPAN></TD></TR><TR><TH id="L4927"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4927">4927</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L4928"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4928">4928</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Affect* aff = new Affect(GetProto(),GetDuration(sSpellDuration.LookupEntry(GetProto()-&gt;DurationIndex)),m_GetGUID(),m_caster);</SPAN></TD></TR><TR><TH id="L4929"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4929">4929</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_tmpAffect = aff;</SPAN></TD></TR><TR><TH id="L4930"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4930">4930</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L4931"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4931">4931</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(GetProto()-&gt;EffectBasePoints[0] &lt; 0)</SPAN></TD></TR><TR><TH id="L4932"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4932">4932</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_tmpAffect-&gt;SetNegative();</SPAN></TD></TR><TR><TH id="L4933"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4933">4933</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L4934"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4934">4934</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_tmpAffect-&gt;SetPeriodicTriggerSpell(GetProto()-&gt;EffectTriggerSpell[0],GetProto()-&gt;EffectAmplitude[0],damage);</SPAN></TD></TR><TR><TH id="L4935"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4935">4935</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }break;</SPAN></TD></TR><TR><TH id="L4936"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4936">4936</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L4937"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4937">4937</A></TH><TD></TR><TR><TH id="L4938"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4938">4938</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Warlock Healthstones, just how much health does a lock need?</SPAN></TD></TR><TR><TH id="L4939"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4939">4939</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">6201</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Minor Healthstone</SPAN></TD></TR><TR><TH id="L4940"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4940">4940</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18692</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L4941"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4941">4941</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4942"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4942">4942</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19004</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4943"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4943">4943</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4944"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4944">4944</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4945"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4945">4945</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18693</SPAN><SPAN class="p">))</SPAN></TD></TR><TR><TH id="L4946"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4946">4946</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4947"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4947">4947</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19005</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4948"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4948">4948</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4949"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4949">4949</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4950"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4950">4950</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">5512</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4951"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4951">4951</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4952"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4952">4952</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">6202</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Lesser Healthstone</SPAN></TD></TR><TR><TH id="L4953"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4953">4953</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18693</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (2)</SPAN></TD></TR><TR><TH id="L4954"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4954">4954</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4955"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4955">4955</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19007</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4956"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4956">4956</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4957"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4957">4957</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4958"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4958">4958</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18692</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (1)</SPAN></TD></TR><TR><TH id="L4959"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4959">4959</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4960"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4960">4960</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19006</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4961"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4961">4961</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4962"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4962">4962</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4963"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4963">4963</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">5511</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4964"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4964">4964</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4965"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4965">4965</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">5699</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Healthstone</SPAN></TD></TR><TR><TH id="L4966"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4966">4966</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18693</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (2)</SPAN></TD></TR><TR><TH id="L4967"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4967">4967</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4968"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4968">4968</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19009</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4969"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4969">4969</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4970"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4970">4970</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4971"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4971">4971</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18692</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (1)</SPAN></TD></TR><TR><TH id="L4972"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4972">4972</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4973"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4973">4973</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19008</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4974"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4974">4974</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4975"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4975">4975</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4976"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4976">4976</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">5509</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4977"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4977">4977</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4978"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4978">4978</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11729</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// Greater Healthstone</SPAN></TD></TR><TR><TH id="L4979"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4979">4979</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18693</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (2)</SPAN></TD></TR><TR><TH id="L4980"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4980">4980</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4981"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4981">4981</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19011</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4982"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4982">4982</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4983"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4983">4983</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4984"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4984">4984</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18692</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (1)</SPAN></TD></TR><TR><TH id="L4985"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4985">4985</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4986"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4986">4986</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19010</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4987"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4987">4987</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4988"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4988">4988</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4989"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4989">4989</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">5510</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4990"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4990">4990</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4991"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4991">4991</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11730</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// Major Healthstone</SPAN></TD></TR><TR><TH id="L4992"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4992">4992</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18693</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (2)</SPAN></TD></TR><TR><TH id="L4993"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4993">4993</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4994"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4994">4994</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19013</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L4995"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4995">4995</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L4996"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4996">4996</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L4997"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4997">4997</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18692</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (1)</SPAN></TD></TR><TR><TH id="L4998"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4998">4998</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L4999"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L4999">4999</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">19012</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5000"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5000">5000</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5001"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5001">5001</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5002"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5002">5002</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">9421</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5003"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5003">5003</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5004"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5004">5004</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27230</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// Master Healthstone</SPAN></TD></TR><TR><TH id="L5005"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5005">5005</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18693</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (2)</SPAN></TD></TR><TR><TH id="L5006"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5006">5006</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5007"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5007">5007</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">22105</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5008"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5008">5008</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5009"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5009">5009</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5010"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5010">5010</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18692</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (1)</SPAN></TD></TR><TR><TH id="L5011"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5011">5011</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5012"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5012">5012</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">22104</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5013"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5013">5013</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5014"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5014">5014</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5015"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5015">5015</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">22103</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5016"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5016">5016</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5017"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5017">5017</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">47871</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// Demonic Healthstone</SPAN></TD></TR><TR><TH id="L5018"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5018">5018</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18693</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (2)</SPAN></TD></TR><TR><TH id="L5019"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5019">5019</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5020"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5020">5020</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">36891</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5021"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5021">5021</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5022"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5022">5022</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5023"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5023">5023</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18692</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (1)</SPAN></TD></TR><TR><TH id="L5024"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5024">5024</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5025"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5025">5025</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">36890</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5026"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5026">5026</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5027"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5027">5027</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5028"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5028">5028</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">36889</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5029"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5029">5029</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5030"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5030">5030</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">47878</SPAN><SPAN class="o">:</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// Fel Healthstone</SPAN></TD></TR><TR><TH id="L5031"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5031">5031</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18693</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (2)</SPAN></TD></TR><TR><TH id="L5032"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5032">5032</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5033"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5033">5033</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">36894</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5034"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5034">5034</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5035"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5035">5035</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5036"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5036">5036</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>HasSpell<SPAN class="p">(</SPAN><SPAN class="mi">18692</SPAN><SPAN class="p">))</SPAN>&nbsp; <SPAN class="c">// Improved Healthstone (1)</SPAN></TD></TR><TR><TH id="L5037"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5037">5037</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5038"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5038">5038</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">36893</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5039"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5039">5039</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5040"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5040">5040</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5041"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5041">5041</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreateItem<SPAN class="p">(</SPAN><SPAN class="mi">36892</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5042"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5042">5042</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5043"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5043">5043</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Holy Light</SPAN></TD></TR><TR><TH id="L5044"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5044">5044</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">635</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5045"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5045">5045</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">639</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5046"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5046">5046</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">647</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5047"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5047">5047</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">1026</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5048"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5048">5048</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">1042</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5049"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5049">5049</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">3472</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5050"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5050">5050</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">10328</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5051"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5051">5051</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">10329</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5052"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5052">5052</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">25292</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5053"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5053">5053</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27135</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5054"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5054">5054</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27136</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5055"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5055">5055</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48781</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5056"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5056">5056</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48782</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5057"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5057">5057</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Flash of light</SPAN></TD></TR><TR><TH id="L5058"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5058">5058</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">19750</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5059"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5059">5059</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">19939</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5060"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5060">5060</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">19940</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5061"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5061">5061</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">19941</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5062"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5062">5062</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">19942</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5063"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5063">5063</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">19943</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5064"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5064">5064</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27137</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5065"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5065">5065</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48784</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5066"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5066">5066</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48785</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5067"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5067">5067</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>HasAura<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">20216</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5068"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5068">5068</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Heal<SPAN class="p">((</SPAN>int32<SPAN class="p">)</SPAN>damage<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5069"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5069">5069</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L5070"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5070">5070</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Heal<SPAN class="p">((</SPAN>int32<SPAN class="p">)</SPAN>damage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5071"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5071">5071</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5072"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5072">5072</A></TH><TD></TR><TR><TH id="L5073"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5073">5073</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Judgement</SPAN></TD></TR><TR><TH id="L5074"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5074">5074</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20271</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Light</SPAN></TD></TR><TR><TH id="L5075"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5075">5075</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">53407</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Justice</SPAN></TD></TR><TR><TH id="L5076"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5076">5076</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">53408</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Wisdom</SPAN></TD></TR><TR><TH id="L5077"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5077">5077</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5078"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5078">5078</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5079"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5079">5079</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5080"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5080">5080</A></TH><TD></TR><TR><TH id="L5081"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5081">5081</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>judgespell <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5082"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5082">5082</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5083"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5083">5083</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>en <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>judgespell <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5084"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5084">5084</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5085"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5085">5085</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5086"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5086">5086</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5087"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5087">5087</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>en<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5088"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5088">5088</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5089"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5089">5089</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tgt<SPAN class="p">.</SPAN>m_unitTarget <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5090"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5090">5090</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tgt<SPAN class="p">.</SPAN>m_targetMask <SPAN class="o">=</SPAN>&nbsp;TARGET_FLAG_UNIT<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5091"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5091">5091</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>judgement <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5092"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5092">5092</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5093"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5093">5093</A></TH><TD></TR><TR><TH id="L5094"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5094">5094</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5095"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5095">5095</A></TH><TD></TR><TR><TH id="L5096"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5096">5096</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 judge_extra <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5097"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5097">5097</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// This is for handling specific Judgement's debuff application spells</SPAN></TD></TR><TR><TH id="L5098"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5098">5098</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5099"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5099">5099</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5100"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5100">5100</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20271</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5101"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5101">5101</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; judge_extra <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20185</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5102"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5102">5102</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5103"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5103">5103</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">53407</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5104"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5104">5104</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; judge_extra <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20184</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5105"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5105">5105</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5106"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5106">5106</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">53408</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5107"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5107">5107</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; judge_extra <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20186</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5108"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5108">5108</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5109"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5109">5109</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5110"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5110">5110</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>CastSpell<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;judge_extra<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5111"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5111">5111</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5112"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5112">5112</A></TH><TD></TR><TR><TH id="L5113"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5113">5113</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//warlock - Master Demonologist</SPAN></TD></TR><TR><TH id="L5114"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5114">5114</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23784</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5115"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5115">5115</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5116"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5116">5116</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5117"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5117">5117</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//can't imagine how this talent got to anybody else then a player casted on pet</SPAN></TD></TR><TR><TH id="L5118"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5118">5118</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5119"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5119">5119</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5120"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5120">5120</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5121"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5121">5121</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">416</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//in case it is imp</SPAN></TD></TR><TR><TH id="L5122"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5122">5122</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23759</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5123"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5123">5123</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1860</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//VoidWalker</SPAN></TD></TR><TR><TH id="L5124"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5124">5124</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23760</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5125"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5125">5125</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1863</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Succubus</SPAN></TD></TR><TR><TH id="L5126"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5126">5126</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23761</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5127"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5127">5127</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">417</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felhunter</SPAN></TD></TR><TR><TH id="L5128"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5128">5128</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5129"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5129">5129</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5130"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5130">5130</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23762</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5131"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5131">5131</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5132"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5132">5132</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5133"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5133">5133</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">17252</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felguard</SPAN></TD></TR><TR><TH id="L5134"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5134">5134</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5135"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5135">5135</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">35702</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5136"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5136">5136</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23762</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5137"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5137">5137</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">10</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5138"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5138">5138</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5139"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5139">5139</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5140"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5140">5140</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5141"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5141">5141</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5142"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5142">5142</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5143"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5143">5143</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5144"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5144">5144</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5145"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5145">5145</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5146"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5146">5146</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5147"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5147">5147</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5148"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5148">5148</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5149"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5149">5149</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5150"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5150">5150</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5151"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5151">5151</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5152"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5152">5152</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5153"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5153">5153</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5154"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5154">5154</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5155"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5155">5155</A></TH><TD></TR><TR><TH id="L5156"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5156">5156</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5157"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5157">5157</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5158"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5158">5158</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5159"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5159">5159</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5160"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5160">5160</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5161"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5161">5161</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5162"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5162">5162</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5163"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5163">5163</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5164"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5164">5164</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5165"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5165">5165</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5166"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5166">5166</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5167"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5167">5167</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5168"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5168">5168</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5169"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5169">5169</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5170"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5170">5170</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5171"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5171">5171</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5172"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5172">5172</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5173"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5173">5173</A></TH><TD></TR><TR><TH id="L5174"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5174">5174</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5175"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5175">5175</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5176"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5176">5176</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23830</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5177"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5177">5177</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5178"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5178">5178</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster&nbsp; <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5179"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5179">5179</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//can't imagine how this talent got to anybody else then a player casted on pet</SPAN></TD></TR><TR><TH id="L5180"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5180">5180</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5181"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5181">5181</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5182"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5182">5182</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5183"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5183">5183</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">416</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//in case it is imp</SPAN></TD></TR><TR><TH id="L5184"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5184">5184</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23826</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5185"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5185">5185</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1860</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//VoidWalker</SPAN></TD></TR><TR><TH id="L5186"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5186">5186</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23841</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5187"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5187">5187</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1863</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Succubus</SPAN></TD></TR><TR><TH id="L5188"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5188">5188</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23833</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5189"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5189">5189</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">417</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felhunter</SPAN></TD></TR><TR><TH id="L5190"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5190">5190</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5191"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5191">5191</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5192"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5192">5192</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23837</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5193"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5193">5193</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">40</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5194"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5194">5194</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5195"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5195">5195</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">17252</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felguard</SPAN></TD></TR><TR><TH id="L5196"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5196">5196</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5197"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5197">5197</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">35703</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5198"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5198">5198</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23837</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5199"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5199">5199</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5200"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5200">5200</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5201"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5201">5201</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5202"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5202">5202</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5203"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5203">5203</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5204"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5204">5204</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5205"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5205">5205</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5206"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5206">5206</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5207"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5207">5207</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5208"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5208">5208</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5209"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5209">5209</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5210"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5210">5210</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5211"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5211">5211</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5212"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5212">5212</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5213"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5213">5213</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5214"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5214">5214</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5215"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5215">5215</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5216"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5216">5216</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5217"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5217">5217</A></TH><TD></TR><TR><TH id="L5218"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5218">5218</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5219"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5219">5219</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5220"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5220">5220</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5221"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5221">5221</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5222"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5222">5222</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5223"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5223">5223</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5224"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5224">5224</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5225"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5225">5225</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5226"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5226">5226</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5227"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5227">5227</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5228"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5228">5228</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5229"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5229">5229</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5230"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5230">5230</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5231"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5231">5231</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5232"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5232">5232</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5233"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5233">5233</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5234"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5234">5234</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5235"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5235">5235</A></TH><TD></TR><TR><TH id="L5236"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5236">5236</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5237"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5237">5237</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5238"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5238">5238</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23831</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5239"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5239">5239</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5240"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5240">5240</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5241"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5241">5241</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//can't imagine how this talent got to anybody else then a player casted on pet</SPAN></TD></TR><TR><TH id="L5242"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5242">5242</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5243"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5243">5243</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5244"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5244">5244</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5245"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5245">5245</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">416</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//in case it is imp</SPAN></TD></TR><TR><TH id="L5246"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5246">5246</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23827</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5247"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5247">5247</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1860</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//VoidWalker</SPAN></TD></TR><TR><TH id="L5248"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5248">5248</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23842</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5249"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5249">5249</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1863</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Succubus</SPAN></TD></TR><TR><TH id="L5250"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5250">5250</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23834</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5251"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5251">5251</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">417</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felhunter</SPAN></TD></TR><TR><TH id="L5252"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5252">5252</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5253"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5253">5253</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5254"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5254">5254</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23838</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5255"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5255">5255</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">60</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5256"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5256">5256</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5257"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5257">5257</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">17252</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felguard</SPAN></TD></TR><TR><TH id="L5258"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5258">5258</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5259"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5259">5259</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">35704</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5260"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5260">5260</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23838</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5261"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5261">5261</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">30</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5262"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5262">5262</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5263"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5263">5263</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5264"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5264">5264</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5265"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5265">5265</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5266"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5266">5266</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5267"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5267">5267</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5268"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5268">5268</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5269"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5269">5269</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5270"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5270">5270</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5271"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5271">5271</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5272"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5272">5272</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5273"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5273">5273</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5274"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5274">5274</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5275"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5275">5275</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5276"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5276">5276</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5277"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5277">5277</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5278"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5278">5278</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5279"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5279">5279</A></TH><TD></TR><TR><TH id="L5280"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5280">5280</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5281"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5281">5281</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5282"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5282">5282</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5283"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5283">5283</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5284"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5284">5284</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5285"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5285">5285</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5286"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5286">5286</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5287"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5287">5287</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5288"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5288">5288</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5289"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5289">5289</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5290"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5290">5290</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5291"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5291">5291</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5292"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5292">5292</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5293"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5293">5293</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5294"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5294">5294</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5295"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5295">5295</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5296"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5296">5296</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5297"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5297">5297</A></TH><TD></TR><TR><TH id="L5298"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5298">5298</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5299"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5299">5299</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5300"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5300">5300</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">23832</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5301"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5301">5301</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5302"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5302">5302</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5303"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5303">5303</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//can't imagine how this talent got to anybody else then a player casted on pet</SPAN></TD></TR><TR><TH id="L5304"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5304">5304</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5305"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5305">5305</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5306"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5306">5306</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5307"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5307">5307</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">416</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//in case it is imp</SPAN></TD></TR><TR><TH id="L5308"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5308">5308</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23828</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5309"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5309">5309</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1860</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//VoidWalker</SPAN></TD></TR><TR><TH id="L5310"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5310">5310</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23843</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5311"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5311">5311</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1863</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Succubus</SPAN></TD></TR><TR><TH id="L5312"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5312">5312</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23835</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5313"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5313">5313</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">417</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felhunter</SPAN></TD></TR><TR><TH id="L5314"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5314">5314</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5315"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5315">5315</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5316"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5316">5316</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23839</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5317"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5317">5317</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">80</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5318"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5318">5318</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5319"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5319">5319</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">17252</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felguard</SPAN></TD></TR><TR><TH id="L5320"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5320">5320</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5321"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5321">5321</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">35705</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5322"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5322">5322</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23839</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5323"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5323">5323</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">40</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5324"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5324">5324</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5325"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5325">5325</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5326"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5326">5326</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5327"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5327">5327</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5328"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5328">5328</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5329"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5329">5329</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5330"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5330">5330</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5331"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5331">5331</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5332"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5332">5332</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5333"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5333">5333</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5334"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5334">5334</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5335"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5335">5335</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5336"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5336">5336</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5337"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5337">5337</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5338"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5338">5338</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp; unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5339"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5339">5339</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5340"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5340">5340</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5341"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5341">5341</A></TH><TD></TR><TR><TH id="L5342"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5342">5342</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5343"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5343">5343</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5344"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5344">5344</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5345"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5345">5345</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5346"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5346">5346</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5347"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5347">5347</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5348"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5348">5348</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5349"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5349">5349</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5350"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5350">5350</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5351"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5351">5351</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5352"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5352">5352</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5353"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5353">5353</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5354"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5354">5354</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5355"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5355">5355</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5356"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5356">5356</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5357"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5357">5357</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5358"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5358">5358</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5359"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5359">5359</A></TH><TD></TR><TR><TH id="L5360"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5360">5360</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5361"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5361">5361</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5362"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5362">5362</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">34026</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Hunter: Kill Command</SPAN></TD></TR><TR><TH id="L5363"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5363">5363</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5364"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5364">5364</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* Disabled - Spell changed in patch 3.0.2</SPAN></TD></TR><TR><TH id="L5365"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5365">5365</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // in this case unitTarget == pet</SPAN></TD></TR><TR><TH id="L5366"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5366">5366</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( p_caster == NULL || unitTarget == NULL || unitTarget-&gt;getDeathState() != ALIVE )</SPAN></TD></TR><TR><TH id="L5367"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5367">5367</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</SPAN></TD></TR><TR><TH id="L5368"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5368">5368</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L5369"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5369">5369</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AI_Spell* Sp = static_cast&lt; Pet* &gt;( unitTarget )-&gt;CreateAISpell( dbcSpell.LookupEntry( 34027 ) );</SPAN></TD></TR><TR><TH id="L5370"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5370">5370</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L5371"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5371">5371</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Unit* tgt = p_caster-&gt;GetMapMgr()-&gt;GetUnit( p_caster-&gt;GetSelection() );</SPAN></TD></TR><TR><TH id="L5372"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5372">5372</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L5373"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5373">5373</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( tgt != NULL &amp;&amp; isAttackable( p_caster, tgt ) )</SPAN></TD></TR><TR><TH id="L5374"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5374">5374</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L5375"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5375">5375</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget-&gt;GetAIInterface()-&gt;AttackReaction( tgt, 1 );</SPAN></TD></TR><TR><TH id="L5376"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5376">5376</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget-&gt;GetAIInterface()-&gt;SetNextTarget( tgt );</SPAN></TD></TR><TR><TH id="L5377"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5377">5377</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L5378"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5378">5378</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if( unitTarget-&gt;CombatStatus.GetPrimaryAttackTarget() == 0 )</SPAN></TD></TR><TR><TH id="L5379"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5379">5379</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</SPAN></TD></TR><TR><TH id="L5380"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5380">5380</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget-&gt;GetAIInterface()-&gt;SetNextSpell( Sp );</SPAN></TD></TR><TR><TH id="L5381"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5381">5381</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //TODO: Kill Command - return to previous pet target after cast*/</SPAN></TD></TR><TR><TH id="L5382"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5382">5382</A></TH><TD></TR><TR><TH id="L5383"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5383">5383</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5384"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5384">5384</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">35708</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5385"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5385">5385</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5386"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5386">5386</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5387"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5387">5387</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//can't imagine how this talent got to anybody else then a player casted on pet</SPAN></TD></TR><TR><TH id="L5388"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5388">5388</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5389"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5389">5389</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5390"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5390">5390</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5391"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5391">5391</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">416</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//in case it is imp</SPAN></TD></TR><TR><TH id="L5392"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5392">5392</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23829</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5393"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5393">5393</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1860</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//VoidWalker</SPAN></TD></TR><TR><TH id="L5394"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5394">5394</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23844</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5395"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5395">5395</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1863</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Succubus</SPAN></TD></TR><TR><TH id="L5396"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5396">5396</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23836</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5397"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5397">5397</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">417</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felhunter</SPAN></TD></TR><TR><TH id="L5398"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5398">5398</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5399"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5399">5399</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5400"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5400">5400</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23840</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5401"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5401">5401</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">100</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5402"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5402">5402</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5403"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5403">5403</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;OBJECT_FIELD_ENTRY <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">17252</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Felguard</SPAN></TD></TR><TR><TH id="L5404"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5404">5404</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5405"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5405">5405</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; casted_spell_id <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">35706</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5406"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5406">5406</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level_spell <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">23840</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5407"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5407">5407</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc_resist_by_level <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">50</SPAN>&nbsp;<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5408"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5408">5408</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5409"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5409">5409</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5410"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5410">5410</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5411"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5411">5411</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5412"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5412">5412</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5413"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5413">5413</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5414"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5414">5414</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5415"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5415">5415</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5416"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5416">5416</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5417"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5417">5417</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5418"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5418">5418</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5419"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5419">5419</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5420"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5420">5420</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5421"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5421">5421</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5422"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5422">5422</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;casted_spell_id <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5423"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5423">5423</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5424"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5424">5424</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5425"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5425">5425</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5426"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5426">5426</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5427"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5427">5427</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5428"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5428">5428</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for self</SPAN></TD></TR><TR><TH id="L5429"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5429">5429</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5430"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5430">5430</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5431"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5431">5431</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5432"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5432">5432</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5433"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5433">5433</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5434"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5434">5434</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5435"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5435">5435</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//for pet</SPAN></TD></TR><TR><TH id="L5436"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5436">5436</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5437"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5437">5437</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;inc_resist_by_level_spell <SPAN class="p">),</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5438"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5438">5438</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt1<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5439"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5439">5439</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>tgt1 <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5440"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5440">5440</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5441"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5441">5441</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5442"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5442">5442</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5443"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5443">5443</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5444"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5444">5444</A></TH><TD></TR><TR><TH id="L5445"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5445">5445</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSanctuary<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Stop all attacks made to you</SPAN></TD></TR><TR><TH id="L5446"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5446">5446</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5447"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5447">5447</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5448"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5448">5448</A></TH><TD></TR><TR><TH id="L5449"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5449">5449</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//warning this causes crashes !</SPAN></TD></TR><TR><TH id="L5450"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5450">5450</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; Object::InRangeSet::iterator itr = u_caster-&gt;GetInRangeOppFactsSetBegin();</SPAN></TD></TR><TR><TH id="L5451"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5451">5451</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; Object::InRangeSet::iterator itr_end = u_caster-&gt;GetInRangeOppFactsSetEnd();</SPAN></TD></TR><TR><TH id="L5452"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5452">5452</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//use these instead</SPAN></TD></TR><TR><TH id="L5453"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5453">5453</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; Object<SPAN class="o">::</SPAN>InRangeSet<SPAN class="o">::</SPAN>iterator itr <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetInRangeSetBegin<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5454"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5454">5454</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Object<SPAN class="o">::</SPAN>InRangeSet<SPAN class="o">::</SPAN>iterator itr_end <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetInRangeSetEnd<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5455"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5455">5455</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Unit <SPAN class="o">*</SPAN>&nbsp;pUnit<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5456"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5456">5456</A></TH><TD></TR><TR><TH id="L5457"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5457">5457</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L5458"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5458">5458</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>RemoveAllAuraType<SPAN class="p">(</SPAN>&nbsp;SPELL_AURA_MOD_ROOT <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5459"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5459">5459</A></TH><TD></TR><TR><TH id="L5460"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5460">5460</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">;</SPAN>&nbsp;itr <SPAN class="o">!=</SPAN>&nbsp;itr_end<SPAN class="p">;</SPAN>&nbsp;<SPAN class="o">++</SPAN>itr <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5461"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5461">5461</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>IsUnit<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5462"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5462">5462</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5463"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5463">5463</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pUnit <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Unit<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN><SPAN class="o">*</SPAN>itr<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5464"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5464">5464</A></TH><TD></TR><TR><TH id="L5465"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5465">5465</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;pUnit <SPAN class="o">&amp;&amp;</SPAN>&nbsp;pUnit<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_UNIT <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5466"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5466">5466</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pUnit<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>RemoveThreatByPtr<SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5467"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5467">5467</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5468"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5468">5468</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5469"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5469">5469</A></TH><TD></TR><TR><TH id="L5470"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5470">5470</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectAddComboPoints<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Add Combo Points</SPAN></TD></TR><TR><TH id="L5471"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5471">5471</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5472"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5472">5472</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5473"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5473">5473</A></TH><TD></TR><TR><TH id="L5474"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5474">5474</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//if this is a procspell Ruthlessness (maybe others later)</SPAN></TD></TR><TR><TH id="L5475"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5475">5475</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>pSpellId <SPAN class="o">&amp;&amp;</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="o">==</SPAN><SPAN class="mi">14157</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5476"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5476">5476</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5477"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5477">5477</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//it seems this combo adding procspell is going to change combopoint count before they will get reseted. We add it after the reset</SPAN></TD></TR><TR><TH id="L5478"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5478">5478</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* burlex - this is wrong, and exploitable.. :/ if someone uses this they will have unlimited combo points */</SPAN></TD></TR><TR><TH id="L5479"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5479">5479</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//re-enabled this by Zack. Explained why it is used + recheked to make sure initialization is good ...</SPAN></TD></TR><TR><TH id="L5480"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5480">5480</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// while casting a spell talent will trigger uppon the spell prepare faze</SPAN></TD></TR><TR><TH id="L5481"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5481">5481</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// the effect of the talent is to add 1 combo point but when triggering spell finishes it will clear the extra combo point</SPAN></TD></TR><TR><TH id="L5482"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5482">5482</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>m_spellcomboPoints <SPAN class="o">+=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5483"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5483">5483</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5484"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5484">5484</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5485"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5485">5485</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>AddComboPoints<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetSelection<SPAN class="p">(),</SPAN>&nbsp;damage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5486"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5486">5486</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5487"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5487">5487</A></TH><TD></TR><TR><TH id="L5488"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5488">5488</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectCreateHouse<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Create House</SPAN></TD></TR><TR><TH id="L5489"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5489">5489</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5490"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5490">5490</A></TH><TD></TR><TR><TH id="L5491"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5491">5491</A></TH><TD></TR><TR><TH id="L5492"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5492">5492</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5493"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5493">5493</A></TH><TD></TR><TR><TH id="L5494"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5494">5494</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDuel<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Duel</SPAN></TD></TR><TR><TH id="L5495"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5495">5495</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5496"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5496">5496</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L5497"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5497">5497</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5498"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5498">5498</A></TH><TD></TR><TR><TH id="L5499"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5499">5499</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>IsStealth<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L5500"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5500">5500</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5501"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5501">5501</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_CANT_DUEL_WHILE_STEALTHED<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5502"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5502">5502</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// Player is stealth</SPAN></TD></TR><TR><TH id="L5503"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5503">5503</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5504"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5504">5504</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget <SPAN class="o">||</SPAN>&nbsp;playerTarget <SPAN class="o">==</SPAN>&nbsp;p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5505"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5505">5505</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5506"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5506">5506</A></TH><TD></TR><TR><TH id="L5507"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5507">5507</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* not implemented yet</SPAN></TD></TR><TR><TH id="L5508"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5508">5508</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; TODO: dueling zones ? ( SPELL_FAILED_NO_DUELING )</SPAN></TD></TR><TR><TH id="L5509"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5509">5509</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if (player-&gt;IsInvisible())</SPAN></TD></TR><TR><TH id="L5510"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5510">5510</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L5511"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5511">5511</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; SendCastResult(SPELL_FAILED_CANT_DUEL_WHILE_INVISIBLE);</SPAN></TD></TR><TR><TH id="L5512"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5512">5512</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; return;</SPAN></TD></TR><TR><TH id="L5513"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5513">5513</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L5514"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5514">5514</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L5515"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5515">5515</A></TH><TD></TR><TR><TH id="L5516"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5516">5516</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Player *pTarget = sObjHolder.GetObject&lt;Player&gt;(player-&gt;GetSelection());&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; hacky.. and will screw up if plr is deselected..</SPAN></TD></TR><TR><TH id="L5517"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5517">5517</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5518"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5518">5518</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5519"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5519">5519</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_BAD_TARGETS<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5520"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5520">5520</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// invalid Target</SPAN></TD></TR><TR><TH id="L5521"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5521">5521</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5522"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5522">5522</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L5523"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5523">5523</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5524"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5524">5524</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_TARGETS_DEAD<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5525"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5525">5525</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// Target not alive</SPAN></TD></TR><TR><TH id="L5526"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5526">5526</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5527"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5527">5527</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>hasStateFlag<SPAN class="p">(</SPAN>UF_ATTACKING<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L5528"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5528">5528</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5529"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5529">5529</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_TARGET_IN_COMBAT<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5530"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5530">5530</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// Target in combat with another unit</SPAN></TD></TR><TR><TH id="L5531"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5531">5531</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5532"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5532">5532</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>DuelingWith<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5533"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5533">5533</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5534"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5534">5534</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_TARGET_DUELING<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5535"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5535">5535</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// Already Dueling</SPAN></TD></TR><TR><TH id="L5536"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5536">5536</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5537"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5537">5537</A></TH><TD></TR><TR><TH id="L5538"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5538">5538</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>RequestDuel<SPAN class="p">(</SPAN>playerTarget<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5539"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5539">5539</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5540"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5540">5540</A></TH><TD></TR><TR><TH id="L5541"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5541">5541</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectStuck<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5542"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5542">5542</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5543"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5543">5543</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget <SPAN class="o">||</SPAN>&nbsp;playerTarget <SPAN class="o">!=</SPAN>&nbsp;p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5544"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5544">5544</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5545"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5545">5545</A></TH><TD></TR><TR><TH id="L5546"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5546">5546</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>playerTarget<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>Player<SPAN class="o">::</SPAN>EventTeleport<SPAN class="p">,</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>GetBindMapId<SPAN class="p">(),</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>GetBindPositionX<SPAN class="p">(),</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>GetBindPositionY<SPAN class="p">(),</SPAN></TD></TR><TR><TH id="L5547"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5547">5547</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>GetBindPositionZ<SPAN class="p">(),</SPAN>EVENT_PLAYER_TELEPORT<SPAN class="p">,</SPAN><SPAN class="mi">50</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>EVENT_FLAG_DO_NOT_EXECUTE_IN_WORLD_CONTEXT<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5548"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5548">5548</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*</SPAN></TD></TR><TR><TH id="L5549"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5549">5549</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; playerTarget-&gt;SafeTeleport(playerTarget-&gt;GetBindMapId(), 0, playerTarget-&gt;GetBindPositionX(), playerTarget-&gt;GetBindPositionY(), playerTarget-&gt;GetBindPositionZ(), 3.14f);*/</SPAN></TD></TR><TR><TH id="L5550"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5550">5550</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5551"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5551">5551</A></TH><TD></TR><TR><TH id="L5552"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5552">5552</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonPlayer<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5553"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5553">5553</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5554"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5554">5554</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5555"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5555">5555</A></TH><TD></TR><TR><TH id="L5556"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5556">5556</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// vojta: from 2.4 players can be summoned on another map</SPAN></TD></TR><TR><TH id="L5557"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5557">5557</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//if( m_caster-&gt;GetMapMgr()-&gt;GetMapInfo() &amp;&amp; m_caster-&gt;GetMapMgr()-&gt;GetMapInfo()-&gt;type != INSTANCE_NULL &amp;&amp; m_caster-&gt;GetMapId() != playerTarget-&gt;GetMapId())</SPAN></TD></TR><TR><TH id="L5558"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5558">5558</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; return;</SPAN></TD></TR><TR><TH id="L5559"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5559">5559</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetMapInfo<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&lt;</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetMapInfo<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>minlevel <SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// we need some blizzlike message that player needs level xx - feel free to add it ;)</SPAN></TD></TR><TR><TH id="L5560"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5560">5560</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5561"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5561">5561</A></TH><TD></TR><TR><TH id="L5562"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5562">5562</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>SummonRequest<SPAN class="p">(</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetLowGUID<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetZoneId<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPosition<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5563"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5563">5563</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5564"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5564">5564</A></TH><TD></TR><TR><TH id="L5565"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5565">5565</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectActivateObject<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Activate Object</SPAN></TD></TR><TR><TH id="L5566"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5566">5566</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5567"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5567">5567</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*if(!p_caster)</SPAN></TD></TR><TR><TH id="L5568"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5568">5568</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; return;</SPAN></TD></TR><TR><TH id="L5569"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5569">5569</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L5570"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5570">5570</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if(!gameObjTarget)</SPAN></TD></TR><TR><TH id="L5571"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5571">5571</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; return;</SPAN></TD></TR><TR><TH id="L5572"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5572">5572</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L5573"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5573">5573</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; gameObjTarget-&gt;SetUInt32Value(GAMEOBJECT_DYNAMIC, 1);</SPAN></TD></TR><TR><TH id="L5574"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5574">5574</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L5575"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5575">5575</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; sEventMgr.AddEvent(gameObjTarget, &amp;GameObject::Deactivate, EVENT_GAMEOBJECT_DEACTIVATE, GetDuration(), 1);*/</SPAN></TD></TR><TR><TH id="L5576"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5576">5576</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5577"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5577">5577</A></TH><TD></TR><TR><TH id="L5578"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5578">5578</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonTotem<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Summon Totem</SPAN></TD></TR><TR><TH id="L5579"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5579">5579</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5580"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5580">5580</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5581"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5581">5581</A></TH><TD></TR><TR><TH id="L5582"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5582">5582</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 slot <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">10</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5583"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5583">5583</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;x <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5584"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5584">5584</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;y <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5585"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5585">5585</A></TH><TD></TR><TR><TH id="L5586"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5586">5586</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>EffectMiscValueB<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L5587"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5587">5587</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5588"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5588">5588</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">63</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire</SPAN></TD></TR><TR><TH id="L5589"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5589">5589</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slot <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">2</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5590"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5590">5590</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">-=</SPAN>&nbsp;<SPAN class="mf">1.5f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5591"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5591">5591</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">-=</SPAN>&nbsp;<SPAN class="mf">1.5f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5592"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5592">5592</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5593"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5593">5593</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">81</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Earth</SPAN></TD></TR><TR><TH id="L5594"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5594">5594</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slot <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5595"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5595">5595</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">-=</SPAN>&nbsp;<SPAN class="mf">1.5f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5596"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5596">5596</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mf">1.5f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5597"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5597">5597</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5598"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5598">5598</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">82</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Water</SPAN></TD></TR><TR><TH id="L5599"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5599">5599</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slot <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5600"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5600">5600</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mf">1.5f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5601"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5601">5601</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">-=</SPAN>&nbsp;<SPAN class="mf">1.5f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5602"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5602">5602</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5603"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5603">5603</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">83</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Air</SPAN></TD></TR><TR><TH id="L5604"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5604">5604</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slot <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5605"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5605">5605</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mf">1.5f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5606"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5606">5606</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mf">1.5f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5607"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5607">5607</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5608"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5608">5608</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5609"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5609">5609</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5610"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5610">5610</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5611"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5611">5611</A></TH><TD></TR><TR><TH id="L5612"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5612">5612</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>slot <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5613"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5613">5613</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5614"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5614">5614</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sLog<SPAN class="p">.</SPAN>outDebug<SPAN class="p">(</SPAN><SPAN class="s">"Totem slot is : %u and max shoud be 3, i = %u , target = %u </SPAN><SPAN class="se">\n</SPAN><SPAN class="s">"</SPAN><SPAN class="p">,</SPAN>slot<SPAN class="p">,</SPAN>i<SPAN class="p">,</SPAN>m_spellInfo<SPAN class="o">-&gt;</SPAN>EffectImplicitTargetA<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L5615"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5615">5615</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// Just 4 totems</SPAN></TD></TR><TR><TH id="L5616"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5616">5616</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5617"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5617">5617</A></TH><TD></TR><TR><TH id="L5618"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5618">5618</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 entry <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L5619"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5619">5619</A></TH><TD></TR><TR><TH id="L5620"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5620">5620</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo<SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5621"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5621">5621</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>ci<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5622"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5622">5622</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5623"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5623">5623</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sLog<SPAN class="p">.</SPAN>outDebug<SPAN class="p">(</SPAN><SPAN class="s">"Missing totem creature entry : %u </SPAN><SPAN class="se">\n</SPAN><SPAN class="s">"</SPAN><SPAN class="p">,</SPAN>entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5624"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5624">5624</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5625"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5625">5625</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5626"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5626">5626</A></TH><TD></TR><TR><TH id="L5627"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5627">5627</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>&nbsp;pTotem <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateCreature<SPAN class="p">(</SPAN>entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5628"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5628">5628</A></TH><TD></TR><TR><TH id="L5629"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5629">5629</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// send the packet for the totem timer</SPAN></TD></TR><TR><TH id="L5630"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5630">5630</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_TOTEM_CREATED<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">17</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5631"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5631">5631</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint8<SPAN class="p">(</SPAN>slot<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5632"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5632">5632</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint64<SPAN class="p">(</SPAN>pTotem<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5633"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5633">5633</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>GetDuration<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5634"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5634">5634</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5635"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5635">5635</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendPacket<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5636"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5636">5636</A></TH><TD></TR><TR><TH id="L5637"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5637">5637</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN>slot<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5638"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5638">5638</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN>slot<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>TotemExpire<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5639"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5639">5639</A></TH><TD></TR><TR><TH id="L5640"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5640">5640</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN>slot<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;pTotem<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5641"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5641">5641</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetTotemOwner<SPAN class="p">(</SPAN>p_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5642"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5642">5642</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetTotemSlot<SPAN class="p">(</SPAN>slot<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5643"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5643">5643</A></TH><TD></TR><TR><TH id="L5644"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5644">5644</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;landh <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetLandHeight<SPAN class="p">(</SPAN>x<SPAN class="p">,</SPAN>y<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5645"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5645">5645</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;landdiff <SPAN class="o">=</SPAN>&nbsp;landh <SPAN class="o">-</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5646"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5646">5646</A></TH><TD></TR><TR><TH id="L5647"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5647">5647</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>fabs<SPAN class="p">(</SPAN>landdiff<SPAN class="p">)</SPAN><SPAN class="o">&gt;</SPAN><SPAN class="mi">15</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5648"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5648">5648</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>Create<SPAN class="p">(</SPAN>ci<SPAN class="o">-&gt;</SPAN>Name<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">(),</SPAN>&nbsp;x<SPAN class="p">,</SPAN>&nbsp;y<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">(),</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5649"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5649">5649</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L5650"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5650">5650</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>Create<SPAN class="p">(</SPAN>ci<SPAN class="o">-&gt;</SPAN>Name<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">(),</SPAN>&nbsp;x<SPAN class="p">,</SPAN>&nbsp;y<SPAN class="p">,</SPAN>&nbsp;landh<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5651"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5651">5651</A></TH><TD></TR><TR><TH id="L5652"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5652">5652</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 displayID <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5653"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5653">5653</A></TH><TD></TR><TR><TH id="L5654"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5654">5654</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetTeamInitial<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5655"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5655">5655</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5656"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5656">5656</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Female_DisplayID <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5657"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5657">5657</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5658"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5658">5658</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayID <SPAN class="o">=</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Female_DisplayID<SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//this is the nice solution provided by emsy</SPAN></TD></TR><TR><TH id="L5659"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5659">5659</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5660"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5660">5660</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="c">//this is the case when you are using a blizzlike db</SPAN></TD></TR><TR><TH id="L5661"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5661">5661</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5662"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5662">5662</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">4587</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5663"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5663">5663</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayID <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">19075</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5664"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5664">5664</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">4588</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5665"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5665">5665</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayID <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">19073</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5666"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5666">5666</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">4589</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5667"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5667">5667</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayID <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">19074</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5668"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5668">5668</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">4590</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5669"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5669">5669</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayID <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">19071</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5670"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5670">5670</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">4683</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5671"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5671">5671</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayID <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">19074</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5672"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5672">5672</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L5673"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5673">5673</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayID <SPAN class="o">=</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5674"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5674">5674</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5675"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5675">5675</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5676"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5676">5676</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L5677"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5677">5677</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5678"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5678">5678</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayID <SPAN class="o">=</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5679"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5679">5679</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5680"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5680">5680</A></TH><TD></TR><TR><TH id="L5681"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5681">5681</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Set up the creature.</SPAN></TD></TR><TR><TH id="L5682"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5682">5682</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>OBJECT_FIELD_ENTRY<SPAN class="p">,</SPAN>&nbsp;entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5683"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5683">5683</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>OBJECT_FIELD_SCALE_X<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5684"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5684">5684</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>UNIT_FIELD_CREATEDBY<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5685"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5685">5685</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_HEALTH<SPAN class="p">,</SPAN>&nbsp;damage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5686"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5686">5686</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">,</SPAN>&nbsp;damage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5687"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5687">5687</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER3<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">30</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5688"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5688">5688</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER3<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">30</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5689"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5689">5689</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_LEVEL<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5690"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5690">5690</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_FACTIONTEMPLATE<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_FACTIONTEMPLATE<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L5691"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5691">5691</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_BYTES_0<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="mi">8</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">|</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="mi">2</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="mi">16</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">|</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="mi">24</SPAN><SPAN class="p">));</SPAN></TD></TR><TR><TH id="L5692"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5692">5692</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_FLAGS<SPAN class="p">,</SPAN>&nbsp;UNIT_FLAG_PLAYER_CONTROLLED <SPAN class="o">|</SPAN>&nbsp;UNIT_FLAG_SELF_RES<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5693"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5693">5693</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_BASEATTACKTIME<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">2000</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5694"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5694">5694</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_BASEATTACKTIME_01<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">2000</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5695"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5695">5695</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_BOUNDINGRADIUS<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5696"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5696">5696</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_COMBATREACH<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5697"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5697">5697</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_DISPLAYID<SPAN class="p">,</SPAN>&nbsp;displayID<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5698"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5698">5698</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_NATIVEDISPLAYID<SPAN class="p">,</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID<SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">//blizzlike :P</SPAN></TD></TR><TR><TH id="L5699"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5699">5699</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetFloatValue<SPAN class="p">(</SPAN>UNIT_MOD_CAST_SPEED<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5700"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5700">5700</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_CREATED_BY_SPELL<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5701"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5701">5701</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_BYTES_2<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="o">|</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="mh">0x28</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="mi">8</SPAN><SPAN class="p">));</SPAN></TD></TR><TR><TH id="L5702"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5702">5702</A></TH><TD></TR><TR><TH id="L5703"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5703">5703</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Initialize faction stuff.</SPAN></TD></TR><TR><TH id="L5704"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5704">5704</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>m_faction <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_faction<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5705"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5705">5705</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>m_factionDBC <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_factionDBC<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5706"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5706">5706</A></TH><TD></TR><TR><TH id="L5707"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5707">5707</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>ci<SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">3968</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Exclude the sentry totem, it does not cast</SPAN></TD></TR><TR><TH id="L5708"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5708">5708</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5709"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5709">5709</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Obtain the spell we will be casting.</SPAN></TD></TR><TR><TH id="L5710"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5710">5710</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>&nbsp;TotemSpell <SPAN class="o">=</SPAN>&nbsp;ObjectMgr<SPAN class="o">::</SPAN>getSingleton<SPAN class="p">().</SPAN>GetTotemSpell<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5711"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5711">5711</A></TH><TD></TR><TR><TH id="L5712"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5712">5712</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>TotemSpell <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5713"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5713">5713</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5714"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5714">5714</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sLog<SPAN class="p">.</SPAN>outDebug<SPAN class="p">(</SPAN><SPAN class="s">"Totem %u does not have any spells to cast, exiting</SPAN><SPAN class="se">\n</SPAN><SPAN class="s">"</SPAN><SPAN class="p">,</SPAN>entry<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5715"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5715">5715</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5716"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5716">5716</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5717"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5717">5717</A></TH><TD></TR><TR><TH id="L5718"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5718">5718</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//added by Zack : Some shaman talents are casted on player but it should be inherited or something by totems</SPAN></TD></TR><TR><TH id="L5719"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5719">5719</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>InheritSMMods<SPAN class="p">(</SPAN>p_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5720"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5720">5720</A></TH><TD></TR><TR><TH id="L5721"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5721">5721</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Totems get spell damage and healing bonus from the Shaman</SPAN></TD></TR><TR><TH id="L5722"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5722">5722</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN><SPAN class="kt">int</SPAN>&nbsp;school <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;school<SPAN class="o">&lt;</SPAN><SPAN class="mi">7</SPAN><SPAN class="p">;</SPAN>&nbsp;school<SPAN class="o">++</SPAN><SPAN class="p">){</SPAN></TD></TR><TR><TH id="L5723"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5723">5723</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>ModDamageDone<SPAN class="p">[</SPAN>school<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>int32<SPAN class="p">)(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;PLAYER_FIELD_MOD_DAMAGE_DONE_POS <SPAN class="o">+</SPAN>&nbsp;school <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;<SPAN class="p">(</SPAN>int32<SPAN class="p">)</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>&nbsp;PLAYER_FIELD_MOD_DAMAGE_DONE_NEG <SPAN class="o">+</SPAN>&nbsp;school <SPAN class="p">));</SPAN></TD></TR><TR><TH id="L5724"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5724">5724</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>HealDoneMod<SPAN class="p">[</SPAN>school<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>HealDoneMod<SPAN class="p">[</SPAN>school<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L5725"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5725">5725</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5726"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5726">5726</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Set up AI, depending on our spells.</SPAN></TD></TR><TR><TH id="L5727"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5727">5727</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 j<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5728"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5728">5728</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>&nbsp;j <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;j <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="o">++</SPAN>j <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5729"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5729">5729</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5730"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5730">5730</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;TotemSpell<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>j<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_APPLY_AREA_AURA <SPAN class="o">||</SPAN></TD></TR><TR><TH id="L5731"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5731">5731</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TotemSpell<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>j<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_APPLY_AREA_AURA2 <SPAN class="o">||</SPAN></TD></TR><TR><TH id="L5732"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5732">5732</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TotemSpell<SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>j<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_PERSISTENT_AREA_AURA <SPAN class="o">||</SPAN></TD></TR><TR><TH id="L5733"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5733">5733</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TotemSpell<SPAN class="o">-&gt;</SPAN>EffectApplyAuraName<SPAN class="p">[</SPAN>j<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_AURA_PERIODIC_TRIGGER_SPELL <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5734"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5734">5734</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5735"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5735">5735</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5736"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5736">5736</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5737"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5737">5737</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5738"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5738">5738</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Setup complete. Add us to the world.</SPAN></TD></TR><TR><TH id="L5739"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5739">5739</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5740"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5740">5740</A></TH><TD></TR><TR><TH id="L5741"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5741">5741</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>j <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5742"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5742">5742</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5743"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5743">5743</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// We're an area aura. Simple. Disable AI and cast the spell.</SPAN></TD></TR><TR><TH id="L5744"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5744">5744</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>DisableAI<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5745"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5745">5745</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>totemspell <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5746"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5746">5746</A></TH><TD></TR><TR><TH id="L5747"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5747">5747</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>&nbsp;pSpell <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5748"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5748">5748</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>pSpell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5749"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5749">5749</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5750"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5750">5750</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pSpell<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>pTotem<SPAN class="p">,</SPAN>&nbsp;TotemSpell<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5751"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5751">5751</A></TH><TD></TR><TR><TH id="L5752"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5752">5752</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets targets<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5753"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5753">5753</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">.</SPAN>m_destX <SPAN class="o">=</SPAN>&nbsp;pTotem<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5754"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5754">5754</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">.</SPAN>m_destY <SPAN class="o">=</SPAN>&nbsp;pTotem<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5755"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5755">5755</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">.</SPAN>m_destZ <SPAN class="o">=</SPAN>&nbsp;pTotem<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5756"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5756">5756</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; targets<SPAN class="p">.</SPAN>m_targetMask <SPAN class="o">=</SPAN>&nbsp;TARGET_FLAG_DEST_LOCATION<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5757"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5757">5757</A></TH><TD></TR><TR><TH id="L5758"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5758">5758</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pSpell<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>targets<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5759"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5759">5759</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5760"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5760">5760</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L5761"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5761">5761</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5762"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5762">5762</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// We're a casting totem. Switch AI on, and tell it to cast this spell.</SPAN></TD></TR><TR><TH id="L5763"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5763">5763</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>EnableAI<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5764"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5764">5764</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>pTotem<SPAN class="p">,</SPAN>&nbsp;AITYPE_TOTEM<SPAN class="p">,</SPAN>&nbsp;MOVEMENTTYPE_NONE<SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5765"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5765">5765</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>totemspell <SPAN class="o">=</SPAN>&nbsp;TotemSpell<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5766"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5766">5766</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 totemspelltimer <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">3000</SPAN><SPAN class="p">,</SPAN>&nbsp;totemspelltime <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">3000</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; <SPAN class="c">// need a proper resource for this.</SPAN></TD></TR><TR><TH id="L5767"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5767">5767</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L5768"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5768">5768</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>TotemSpell<SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5769"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5769">5769</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5770"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5770">5770</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8167</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Poison Cleansing Totem</SPAN></TD></TR><TR><TH id="L5771"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5771">5771</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8172</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Disease Cleansing Totem</SPAN></TD></TR><TR><TH id="L5772"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5772">5772</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5773"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5773">5773</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>TotemSpell<SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">8167</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5774"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5774">5774</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TotemSpell <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">8168</SPAN>&nbsp;<SPAN class="p">);</SPAN>&nbsp; &nbsp; &nbsp; <SPAN class="c">// Better to use this spell</SPAN></TD></TR><TR><TH id="L5775"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5775">5775</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L5776"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5776">5776</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TotemSpell <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">8171</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5777"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5777">5777</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>totemspell <SPAN class="o">=</SPAN>&nbsp;TotemSpell<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5778"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5778">5778</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; totemspelltime <SPAN class="o">=</SPAN>&nbsp; <SPAN class="mi">5000</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5779"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5779">5779</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; totemspelltimer <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//First tick done immediately</SPAN></TD></TR><TR><TH id="L5780"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5780">5780</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5781"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5781">5781</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5782"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5782">5782</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8146</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Tremor Totem</SPAN></TD></TR><TR><TH id="L5783"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5783">5783</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5784"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5784">5784</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; totemspelltime <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1000</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5785"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5785">5785</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; totemspelltimer <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//First tick done immediately</SPAN></TD></TR><TR><TH id="L5786"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5786">5786</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5787"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5787">5787</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5788"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5788">5788</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8178</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Grounding Totem</SPAN></TD></TR><TR><TH id="L5789"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5789">5789</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">3600</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Earthbind Totem</SPAN></TD></TR><TR><TH id="L5790"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5790">5790</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5791"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5791">5791</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; totemspelltimer <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//First tick done immediately</SPAN></TD></TR><TR><TH id="L5792"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5792">5792</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5793"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5793">5793</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5794"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5794">5794</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8349</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire Nova Totem 1</SPAN></TD></TR><TR><TH id="L5795"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5795">5795</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8502</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire Nova Totem 2</SPAN></TD></TR><TR><TH id="L5796"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5796">5796</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8503</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire Nova Totem 3</SPAN></TD></TR><TR><TH id="L5797"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5797">5797</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11306</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire Nova Totem 4</SPAN></TD></TR><TR><TH id="L5798"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5798">5798</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11307</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire Nova Totem 5</SPAN></TD></TR><TR><TH id="L5799"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5799">5799</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">25535</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire Nova Totem 6</SPAN></TD></TR><TR><TH id="L5800"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5800">5800</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">25537</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire Nova Totem 7</SPAN></TD></TR><TR><TH id="L5801"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5801">5801</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">61650</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire Nova Totem 8</SPAN></TD></TR><TR><TH id="L5802"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5802">5802</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">61654</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Fire Nova Totem 9</SPAN></TD></TR><TR><TH id="L5803"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5803">5803</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5804"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5804">5804</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; totemspelltimer <SPAN class="o">=</SPAN>&nbsp; <SPAN class="mi">4000</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5805"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5805">5805</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Improved Fire Totems</SPAN></TD></TR><TR><TH id="L5806"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5806">5806</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SM_FIValue<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>SM_FDur<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>totemspelltimer<SPAN class="p">,</SPAN>&nbsp;TotemSpell<SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5807"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5807">5807</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; totemspelltime <SPAN class="o">=</SPAN>&nbsp;totemspelltimer<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5808"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5808">5808</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5809"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5809">5809</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5810"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5810">5810</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5811"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5811">5811</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5812"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5812">5812</A></TH><TD></TR><TR><TH id="L5813"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5813">5813</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>m_totemspelltimer <SPAN class="o">=</SPAN>&nbsp;totemspelltimer<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5814"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5814">5814</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>m_totemspelltime <SPAN class="o">=</SPAN>&nbsp;totemspelltime<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5815"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5815">5815</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5816"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5816">5816</A></TH><TD></TR><TR><TH id="L5817"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5817">5817</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//in case these are our elemental totems then we should set them up</SPAN></TD></TR><TR><TH id="L5818"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5818">5818</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="o">==</SPAN><SPAN class="mi">2062</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5819"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5819">5819</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Event_Summon_EE_totem<SPAN class="p">(</SPAN>GetDuration<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5820"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5820">5820</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="o">==</SPAN><SPAN class="mi">2894</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5821"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5821">5821</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Event_Summon_FE_totem<SPAN class="p">(</SPAN>GetDuration<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5822"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5822">5822</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5823"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5823">5823</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L5824"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5824">5824</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5825"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5825">5825</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pTotem<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN>&nbsp;<SPAN class="c">//Push the sentry totem...</SPAN></TD></TR><TR><TH id="L5826"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5826">5826</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//p_caster-&gt;SetUInt64Value(PLAYER_FARSIGHT, pTotem-&gt;GetGUID()); //works but farsight bugs it</SPAN></TD></TR><TR><TH id="L5827"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5827">5827</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5828"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5828">5828</A></TH><TD></TR><TR><TH id="L5829"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5829">5829</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Set up the deletion event. The totem needs to expire after a certain time, or upon its death.</SPAN></TD></TR><TR><TH id="L5830"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5830">5830</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>pTotem<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Creature<SPAN class="o">::</SPAN>TotemExpire<SPAN class="p">,</SPAN>&nbsp;EVENT_TOTEM_EXPIRE<SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5831"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5831">5831</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5832"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5832">5832</A></TH><TD></TR><TR><TH id="L5833"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5833">5833</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSelfResurrect<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5834"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5834">5834</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5835"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5835">5835</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5836"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5836">5836</A></TH><TD></TR><TR><TH id="L5837"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5837">5837</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 mana<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5838"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5838">5838</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 health<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5839"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5839">5839</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 class_<SPAN class="o">=</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>getClass<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5840"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5840">5840</A></TH><TD></TR><TR><TH id="L5841"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5841">5841</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5842"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5842">5842</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5843"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5843">5843</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">3026</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5844"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5844">5844</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20758</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5845"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5845">5845</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20759</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5846"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5846">5846</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20760</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5847"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5847">5847</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">20761</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5848"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5848">5848</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27240</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5849"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5849">5849</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5850"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5850">5850</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; health <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L5851"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5851">5851</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mana <SPAN class="o">=</SPAN>&nbsp;<SPAN class="o">-</SPAN>damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5852"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5852">5852</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5853"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5853">5853</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">21169</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">//Reincarnation. Ressurect with 20% health and mana</SPAN></TD></TR><TR><TH id="L5854"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5854">5854</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5855"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5855">5855</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int32 amt <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5856"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5856">5856</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5857"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5857">5857</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5858"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5858">5858</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SM_FIValue<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>SM_FMiscEffect<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>amt<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5859"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5859">5859</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SM_PIValue<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>SM_PMiscEffect<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>amt<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5860"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5860">5860</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5861"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5861">5861</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; health <SPAN class="o">=</SPAN>&nbsp;uint32<SPAN class="p">((</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;amt<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5862"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5862">5862</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mana <SPAN class="o">=</SPAN>&nbsp;uint32<SPAN class="p">((</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;amt<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5863"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5863">5863</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5864"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5864">5864</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5865"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5865">5865</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">default</SPAN><SPAN class="o">:</SPAN></TD></TR><TR><TH id="L5866"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5866">5866</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5867"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5867">5867</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>damage <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5868"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5868">5868</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; health <SPAN class="o">=</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;damage <SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5869"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5869">5869</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mana <SPAN class="o">=</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;damage <SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5870"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5870">5870</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5871"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5871">5871</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5872"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5872">5872</A></TH><TD></TR><TR><TH id="L5873"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5873">5873</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>class_ <SPAN class="o">==</SPAN>&nbsp;WARRIOR <SPAN class="o">||</SPAN>&nbsp;class_ <SPAN class="o">==</SPAN>&nbsp;ROGUE<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5874"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5874">5874</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mana<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5875"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5875">5875</A></TH><TD></TR><TR><TH id="L5876"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5876">5876</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>m_resurrectHealth <SPAN class="o">=</SPAN>&nbsp;health<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5877"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5877">5877</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>m_resurrectMana <SPAN class="o">=</SPAN>&nbsp;mana<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5878"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5878">5878</A></TH><TD></TR><TR><TH id="L5879"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5879">5879</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>ResurrectPlayer<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5880"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5880">5880</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>SetMovement<SPAN class="p">(</SPAN>MOVE_UNROOT<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5881"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5881">5881</A></TH><TD></TR><TR><TH id="L5882"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5882">5882</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>PLAYER_SELF_RES_SPELL<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5883"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5883">5883</A></TH><TD></TR><TR><TH id="L5884"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5884">5884</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="o">==</SPAN><SPAN class="mi">21169</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5885"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5885">5885</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddCooldown<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5886"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5886">5886</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5887"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5887">5887</A></TH><TD></TR><TR><TH id="L5888"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5888">5888</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSkinning<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5889"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5889">5889</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5890"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5890">5890</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5891"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5891">5891</A></TH><TD></TR><TR><TH id="L5892"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5892">5892</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 sk <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>_GetSkillLineCurrent<SPAN class="p">(</SPAN>&nbsp;SKILL_SKINNING <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5893"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5893">5893</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 lvl <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5894"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5894">5894</A></TH><TD></TR><TR><TH id="L5895"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5895">5895</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;sk <SPAN class="o">&gt;=</SPAN>&nbsp;lvl <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">5</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;sk <SPAN class="o">+</SPAN>&nbsp;<SPAN class="mi">100</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">&gt;=</SPAN>&nbsp;lvl <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">10</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5896"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5896">5896</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5897"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5897">5897</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Fill loot for Skinning</SPAN></TD></TR><TR><TH id="L5898"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5898">5898</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillSkinningLoot<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">,</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L5899"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5899">5899</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>SendLoot<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;LOOT_SKINNING <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5900"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5900">5900</A></TH><TD></TR><TR><TH id="L5901"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5901">5901</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Not skinable again</SPAN></TD></TR><TR><TH id="L5902"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5902">5902</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>BuildFieldUpdatePacket<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;UNIT_FIELD_FLAGS<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5903"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5903">5903</A></TH><TD></TR><TR><TH id="L5904"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5904">5904</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//still lootable</SPAN></TD></TR><TR><TH id="L5905"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5905">5905</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//pkt=unitTarget-&gt;BuildFieldUpdatePacket(UNIT_DYNAMIC_FLAGS,U_DYN_FLAG_LOOTABLE);</SPAN></TD></TR><TR><TH id="L5906"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5906">5906</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//static_cast&lt; Player* &gt;( m_caster )-&gt;GetSession()-&gt;SendPacket(pkt);</SPAN></TD></TR><TR><TH id="L5907"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5907">5907</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// pkt;</SPAN></TD></TR><TR><TH id="L5908"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5908">5908</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>Skinned<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5909"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5909">5909</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DetermineSkillUp<SPAN class="p">(</SPAN>SKILL_SKINNING<SPAN class="p">,</SPAN>sk<SPAN class="o">&lt;</SPAN>lvl<SPAN class="o">*</SPAN><SPAN class="mi">5</SPAN><SPAN class="o">?</SPAN>sk<SPAN class="o">/</SPAN><SPAN class="mi">5</SPAN><SPAN class="o">:</SPAN>lvl<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5910"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5910">5910</A></TH><TD></TR><TR><TH id="L5911"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5911">5911</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>Skinned <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5912"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5912">5912</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5913"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5913">5913</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L5914"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5914">5914</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5915"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5915">5915</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_TARGET_UNSKINNABLE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5916"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5916">5916</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5917"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5917">5917</A></TH><TD></TR><TR><TH id="L5918"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5918">5918</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; DetermineSkillUp(SKILL_SKINNING,unitTarget-&gt;getLevel());</SPAN></TD></TR><TR><TH id="L5919"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5919">5919</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5920"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5920">5920</A></TH><TD></TR><TR><TH id="L5921"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5921">5921</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectCharge<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5922"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5922">5922</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5923"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5923">5923</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5924"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5924">5924</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>IsStunned<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>m_rooted <SPAN class="o">||</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>IsPacified<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>IsFeared<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L5925"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5925">5925</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5926"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5926">5926</A></TH><TD></TR><TR><TH id="L5927"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5927">5927</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;x<SPAN class="p">,</SPAN>&nbsp;y<SPAN class="p">,</SPAN>&nbsp;z<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5928"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5928">5928</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;dx<SPAN class="p">,</SPAN>dy<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5929"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5929">5929</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//if(unitTarget-&gt;GetTypeId() == TYPEID_UNIT)</SPAN></TD></TR><TR><TH id="L5930"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5930">5930</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; if(unitTarget-&gt;GetAIInterface())</SPAN></TD></TR><TR><TH id="L5931"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5931">5931</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget-&gt;GetAIInterface()-&gt;StopMovement(5000);</SPAN></TD></TR><TR><TH id="L5932"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5932">5932</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5933"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5933">5933</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5934"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5934">5934</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; dx<SPAN class="o">=</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">()</SPAN><SPAN class="o">-</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5935"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5935">5935</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; dy<SPAN class="o">=</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN><SPAN class="o">-</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5936"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5936">5936</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>dx <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;dy <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5937"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5937">5937</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5938"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5938">5938</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;d <SPAN class="o">=</SPAN>&nbsp;sqrt<SPAN class="p">(</SPAN>dx<SPAN class="o">*</SPAN>dx<SPAN class="o">+</SPAN>dy<SPAN class="o">*</SPAN>dy<SPAN class="p">)</SPAN><SPAN class="o">-</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_BOUNDINGRADIUS<SPAN class="p">)</SPAN><SPAN class="o">-</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>UNIT_FIELD_BOUNDINGRADIUS<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5939"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5939">5939</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;alpha <SPAN class="o">=</SPAN>&nbsp;atanf<SPAN class="p">(</SPAN>dy<SPAN class="o">/</SPAN>dx<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5940"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5940">5940</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>dx<SPAN class="o">&lt;</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5941"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5941">5941</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alpha <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>M_PI<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5942"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5942">5942</A></TH><TD></TR><TR><TH id="L5943"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5943">5943</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; x <SPAN class="o">=</SPAN>&nbsp;d <SPAN class="o">*</SPAN>&nbsp;cosf<SPAN class="p">(</SPAN>alpha<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5944"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5944">5944</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; y <SPAN class="o">=</SPAN>&nbsp;d <SPAN class="o">*</SPAN>&nbsp;sinf<SPAN class="p">(</SPAN>alpha<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5945"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5945">5945</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; z <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5946"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5946">5946</A></TH><TD></TR><TR><TH id="L5947"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5947">5947</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 time <SPAN class="o">=</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>CalcDistance<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="p">((</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>m_runSpeed <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">3.5</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">0.001f</SPAN><SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="mf">0.5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5948"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5948">5948</A></TH><TD></TR><TR><TH id="L5949"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5949">5949</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_MONSTER_MOVE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">50</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5950"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5950">5950</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5951"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5951">5951</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5952"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5952">5952</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5953"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5953">5953</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5954"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5954">5954</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;getMSTime<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5955"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5955">5955</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint8<SPAN class="p">(</SPAN><SPAN class="mh">0x00</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5956"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5956">5956</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN><SPAN class="mh">0x00000100</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5957"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5957">5957</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;time<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5958"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5958">5958</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5959"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5959">5959</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;x <SPAN class="o">&lt;&lt;</SPAN>&nbsp;y <SPAN class="o">&lt;&lt;</SPAN>&nbsp;z<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5960"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5960">5960</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_UNIT<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5961"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5961">5961</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>StopMovement<SPAN class="p">(</SPAN><SPAN class="mi">2000</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5962"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5962">5962</A></TH><TD></TR><TR><TH id="L5963"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5963">5963</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>SendMessageToSet<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5964"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5964">5964</A></TH><TD></TR><TR><TH id="L5965"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5965">5965</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>SetPosition<SPAN class="p">(</SPAN>x<SPAN class="p">,</SPAN>y<SPAN class="p">,</SPAN>z<SPAN class="p">,</SPAN>alpha<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5966"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5966">5966</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>addStateFlag<SPAN class="p">(</SPAN>UF_ATTACKING<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5967"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5967">5967</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster <SPAN class="o">-&gt;</SPAN>smsg_AttackStart<SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5968"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5968">5968</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>setAttackTimer<SPAN class="p">(</SPAN>time<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5969"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5969">5969</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>setAttackTimer<SPAN class="p">(</SPAN>time<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5970"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5970">5970</A></TH><TD></TR><TR><TH id="L5971"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5971">5971</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// trigger an event to reset speedhack detection</SPAN></TD></TR><TR><TH id="L5972"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5972">5972</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5973"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5973">5973</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5974"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5974">5974</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>EventAttackStart<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5975"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5975">5975</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SpeedCheatDelay<SPAN class="p">(</SPAN>&nbsp;time <SPAN class="o">+</SPAN>&nbsp;<SPAN class="mi">1000</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5976"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5976">5976</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>z_axisposition <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5977"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5977">5977</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5978"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5978">5978</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L5979"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5979">5979</A></TH><TD></TR><TR><TH id="L5980"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5980">5980</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectPlayerPull<SPAN class="p">(</SPAN>&nbsp;uint32 i <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5981"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5981">5981</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L5982"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5982">5982</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L5983"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5983">5983</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5984"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5984">5984</A></TH><TD></TR><TR><TH id="L5985"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5985">5985</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Player<SPAN class="o">*</SPAN>&nbsp;p_target <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>&nbsp;unitTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5986"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5986">5986</A></TH><TD></TR><TR><TH id="L5987"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5987">5987</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// calculate destination</SPAN></TD></TR><TR><TH id="L5988"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5988">5988</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;pullD <SPAN class="o">=</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>CalcDistance<SPAN class="p">(</SPAN>&nbsp;m_caster <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_BOUNDINGRADIUS <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetFloatValue<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_BOUNDINGRADIUS <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5989"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5989">5989</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;pullO <SPAN class="o">=</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>calcRadAngle<SPAN class="p">(</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5990"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5990">5990</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;pullX <SPAN class="o">=</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;pullD <SPAN class="o">*</SPAN>&nbsp;cosf<SPAN class="p">(</SPAN>&nbsp;pullO <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5991"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5991">5991</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;pullY <SPAN class="o">=</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;pullD <SPAN class="o">*</SPAN>&nbsp;sinf<SPAN class="p">(</SPAN>&nbsp;pullO <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5992"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5992">5992</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;pullZ <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">+</SPAN>&nbsp;<SPAN class="mf">0.3f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L5993"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5993">5993</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 time <SPAN class="o">=</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;pullD <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">42.0f</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5994"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5994">5994</A></TH><TD></TR><TR><TH id="L5995"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5995">5995</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_target<SPAN class="o">-&gt;</SPAN>SetOrientation<SPAN class="p">(</SPAN>&nbsp;pullO <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5996"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5996">5996</A></TH><TD></TR><TR><TH id="L5997"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5997">5997</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>&nbsp;SMSG_MONSTER_MOVE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">60</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L5998"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5998">5998</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L5999"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L5999">5999</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&lt;&lt;</SPAN>&nbsp;p_target<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6000"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6000">6000</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;getMSTime<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6001"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6001">6001</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint8<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">4</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6002"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6002">6002</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;pullO<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6003"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6003">6003</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mh">0x00000100</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6004"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6004">6004</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;time<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6005"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6005">6005</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6006"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6006">6006</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;pullX <SPAN class="o">&lt;&lt;</SPAN>&nbsp;pullY <SPAN class="o">&lt;&lt;</SPAN>&nbsp;pullZ<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6007"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6007">6007</A></TH><TD></TR><TR><TH id="L6008"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6008">6008</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_target<SPAN class="o">-&gt;</SPAN>SendMessageToSet<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>data<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6009"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6009">6009</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6010"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6010">6010</A></TH><TD></TR><TR><TH id="L6011"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6011">6011</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonCritter<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6012"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6012">6012</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6013"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6013">6013</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6014"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6014">6014</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6015"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6015">6015</A></TH><TD></TR><TR><TH id="L6016"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6016">6016</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 SummonCritterID <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6017"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6017">6017</A></TH><TD></TR><TR><TH id="L6018"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6018">6018</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// GetProto()-&gt;EffectDieSides[i] has something to do with dismissing our critter</SPAN></TD></TR><TR><TH id="L6019"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6019">6019</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// when it is 1, it means to just dismiss it if we already have it</SPAN></TD></TR><TR><TH id="L6020"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6020">6020</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// when it is 0, it could mean to always summon a new critter, but there seems to be exceptions</SPAN></TD></TR><TR><TH id="L6021"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6021">6021</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6022"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6022">6022</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>critterPet<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6023"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6023">6023</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6024"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6024">6024</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// if we already have this critter, we will just dismiss it and return</SPAN></TD></TR><TR><TH id="L6025"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6025">6025</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>critterPet<SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>critterPet<SPAN class="o">-&gt;</SPAN>GetCreatureInfo<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;SummonCritterID<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6026"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6026">6026</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6027"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6027">6027</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>critterPet<SPAN class="o">-&gt;</SPAN>RemoveFromWorld<SPAN class="p">(</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6028"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6028">6028</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">delete</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>critterPet<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6029"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6029">6029</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>critterPet <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6030"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6030">6030</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6031"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6031">6031</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6032"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6032">6032</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// this is a different critter, so we will dismiss our current critter and then go on to summon the new one</SPAN></TD></TR><TR><TH id="L6033"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6033">6033</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6034"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6034">6034</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6035"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6035">6035</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>critterPet<SPAN class="o">-&gt;</SPAN>RemoveFromWorld<SPAN class="p">(</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6036"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6036">6036</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">delete</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>critterPet<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6037"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6037">6037</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>critterPet <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6038"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6038">6038</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6039"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6039">6039</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6040"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6040">6040</A></TH><TD></TR><TR><TH id="L6041"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6041">6041</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>SummonCritterID<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6042"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6042">6042</A></TH><TD></TR><TR><TH id="L6043"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6043">6043</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>SummonCritterID<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6044"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6044">6044</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CreatureProto <SPAN class="o">*</SPAN>&nbsp;cp <SPAN class="o">=</SPAN>&nbsp;CreatureProtoStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>SummonCritterID<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6045"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6045">6045</A></TH><TD></TR><TR><TH id="L6046"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6046">6046</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>ci <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>cp<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6047"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6047">6047</A></TH><TD></TR><TR><TH id="L6048"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6048">6048</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Creature <SPAN class="o">*</SPAN>&nbsp;pCreature <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateCreature<SPAN class="p">(</SPAN>SummonCritterID<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6049"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6049">6049</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetInstanceID<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6050"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6050">6050</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>Load<SPAN class="p">(</SPAN>cp<SPAN class="p">,</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6051"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6051">6051</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_FACTIONTEMPLATE<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">35</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6052"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6052">6052</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>_setFaction<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6053"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6053">6053</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_LEVEL<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6054"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6054">6054</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>pCreature<SPAN class="p">,</SPAN>AITYPE_PET<SPAN class="p">,</SPAN>MOVEMENTTYPE_NONE<SPAN class="p">,</SPAN>u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6055"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6055">6055</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetUnitToFollow<SPAN class="p">(</SPAN>u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6056"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6056">6056</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetUnitToFollowAngle<SPAN class="p">(</SPAN><SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN><SPAN class="o">-</SPAN><SPAN class="p">(</SPAN>M_PI<SPAN class="o">/</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">)));</SPAN></TD></TR><TR><TH id="L6057"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6057">6057</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SetFollowDistance<SPAN class="p">(</SPAN>GetRadius<SPAN class="p">(</SPAN>i<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L6058"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6058">6058</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>disable_melee <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6059"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6059">6059</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>bInvincible <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6060"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6060">6060</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pCreature<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6061"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6061">6061</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>critterPet <SPAN class="o">=</SPAN>&nbsp;pCreature<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6062"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6062">6062</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6063"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6063">6063</A></TH><TD></TR><TR><TH id="L6064"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6064">6064</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectKnockBack<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6065"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6065">6065</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6066"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6066">6066</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>m_caster <SPAN class="o">||</SPAN>&nbsp;m_caster <SPAN class="o">==</SPAN>&nbsp;playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6067"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6067">6067</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6068"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6068">6068</A></TH><TD></TR><TR><TH id="L6069"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6069">6069</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;dx<SPAN class="p">,</SPAN>&nbsp;dy<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6070"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6070">6070</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;value1 <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6071"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6071">6071</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;value2 <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L6072"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6072">6072</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;proportion<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6073"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6073">6073</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; value2 <SPAN class="o">?</SPAN>&nbsp;proportion <SPAN class="o">=</SPAN>&nbsp;value1<SPAN class="o">/</SPAN>value2 <SPAN class="o">:</SPAN>&nbsp;proportion <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6074"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6074">6074</A></TH><TD></TR><TR><TH id="L6075"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6075">6075</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>proportion<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6076"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6076">6076</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6077"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6077">6077</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value1 <SPAN class="o">=</SPAN>&nbsp;value1 <SPAN class="o">/</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="mi">10</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;proportion<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6078"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6078">6078</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value2 <SPAN class="o">=</SPAN>&nbsp;value2 <SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">10</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;proportion<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6079"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6079">6079</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6080"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6080">6080</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6081"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6081">6081</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6082"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6082">6082</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value2 <SPAN class="o">=</SPAN>&nbsp;value1 <SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">10</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6083"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6083">6083</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value1 <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mf">0.1f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6084"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6084">6084</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6085"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6085">6085</A></TH><TD></TR><TR><TH id="L6086"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6086">6086</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; dx <SPAN class="o">=</SPAN>&nbsp;sinf<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6087"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6087">6087</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; dy <SPAN class="o">=</SPAN>&nbsp;cosf<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6088"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6088">6088</A></TH><TD></TR><TR><TH id="L6089"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6089">6089</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_MOVE_KNOCK_BACK<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">50</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6090"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6090">6090</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6091"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6091">6091</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;getMSTime<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6092"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6092">6092</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;dy <SPAN class="o">&lt;&lt;</SPAN>&nbsp;dx<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6093"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6093">6093</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;value1<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6094"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6094">6094</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="o">-</SPAN>value2<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6095"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6095">6095</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendPacket<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6096"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6096">6096</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>blinked <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6097"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6097">6097</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>SpeedCheatDelay<SPAN class="p">(</SPAN><SPAN class="mi">10000</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6098"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6098">6098</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6099"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6099">6099</A></TH><TD></TR><TR><TH id="L6100"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6100">6100</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDisenchant<SPAN class="p">(</SPAN>&nbsp;uint32 i <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6101"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6101">6101</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6102"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6102">6102</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6103"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6103">6103</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6104"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6104">6104</A></TH><TD></TR><TR><TH id="L6105"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6105">6105</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Item<SPAN class="o">*</SPAN>&nbsp;it <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetItemByGUID<SPAN class="p">(</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_itemTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6106"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6106">6106</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>it <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6107"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6107">6107</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6108"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6108">6108</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>&nbsp;SPELL_FAILED_CANT_BE_DISENCHANTED <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6109"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6109">6109</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6110"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6110">6110</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6111"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6111">6111</A></TH><TD></TR><TR><TH id="L6112"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6112">6112</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Fill disenchanting loot</SPAN></TD></TR><TR><TH id="L6113"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6113">6113</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetLootGUID<SPAN class="p">(</SPAN>&nbsp;it<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6114"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6114">6114</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>it<SPAN class="o">-&gt;</SPAN>loot <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6115"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6115">6115</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6116"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6116">6116</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; it<SPAN class="o">-&gt;</SPAN>loot <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">new</SPAN>&nbsp;Loot<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6117"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6117">6117</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillDisenchantingLoot<SPAN class="p">(</SPAN>&nbsp;it<SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">,</SPAN>&nbsp;it<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6118"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6118">6118</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6119"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6119">6119</A></TH><TD></TR><TR><TH id="L6120"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6120">6120</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Log<SPAN class="p">.</SPAN>Debug<SPAN class="p">(</SPAN>&nbsp;<SPAN class="s">"SpellEffect"</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="s">"Succesfully disenchanted item %d"</SPAN><SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6121"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6121">6121</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SendLoot<SPAN class="p">(</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;LOOT_DISENCHANTING <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6122"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6122">6122</A></TH><TD></TR><TR><TH id="L6123"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6123">6123</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//We can increase Enchanting skill up to 60</SPAN></TD></TR><TR><TH id="L6124"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6124">6124</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; uint32 skill <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>_GetSkillLineCurrent<SPAN class="p">(</SPAN>&nbsp;SKILL_ENCHANTING <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6125"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6125">6125</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;skill <SPAN class="o">&amp;&amp;</SPAN>&nbsp;skill <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">60</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6126"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6126">6126</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6127"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6127">6127</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;Rand<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mf">100.0f</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>&nbsp;skill <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;<SPAN class="mf">0.75f</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6128"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6128">6128</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6129"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6129">6129</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 SkillUp <SPAN class="o">=</SPAN>&nbsp;float2int32<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mf">1.0f</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;sWorld<SPAN class="p">.</SPAN>getRate<SPAN class="p">(</SPAN>&nbsp;RATE_SKILLRATE <SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6130"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6130">6130</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;skill <SPAN class="o">+</SPAN>&nbsp;SkillUp <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">60</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6131"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6131">6131</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SkillUp <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">60</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;skill<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6132"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6132">6132</A></TH><TD></TR><TR><TH id="L6133"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6133">6133</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>_AdvanceSkillLine<SPAN class="p">(</SPAN>&nbsp;SKILL_ENCHANTING<SPAN class="p">,</SPAN>&nbsp;SkillUp <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6134"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6134">6134</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6135"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6135">6135</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6136"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6136">6136</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;it <SPAN class="o">==</SPAN>&nbsp;i_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6137"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6137">6137</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i_caster <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6138"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6138">6138</A></TH><TD></TR><TR><TH id="L6139"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6139">6139</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6140"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6140">6140</A></TH><TD></TR><TR><TH id="L6141"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6141">6141</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectInebriate<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// lets get drunk!</SPAN></TD></TR><TR><TH id="L6142"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6142">6142</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6143"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6143">6143</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6144"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6144">6144</A></TH><TD></TR><TR><TH id="L6145"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6145">6145</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Drunkee!</SPAN></TD></TR><TR><TH id="L6146"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6146">6146</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; uint8 b2 <SPAN class="o">=</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetByte<SPAN class="p">(</SPAN>PLAYER_BYTES_3<SPAN class="p">,</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6147"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6147">6147</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; b2 <SPAN class="o">+=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN>&nbsp; &nbsp;<SPAN class="c">// 10 beers will get you smassssshed!</SPAN></TD></TR><TR><TH id="L6148"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6148">6148</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6149"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6149">6149</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SetByte<SPAN class="p">(</SPAN>PLAYER_BYTES_3<SPAN class="p">,</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>b2<SPAN class="o">&gt;</SPAN><SPAN class="mi">90</SPAN><SPAN class="o">?</SPAN><SPAN class="mi">90</SPAN><SPAN class="o">:</SPAN>b2<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6150"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6150">6150</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;EVENT_PLAYER_REDUCEDRUNK<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6151"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6151">6151</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>p_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>Player<SPAN class="o">::</SPAN>EventReduceDrunk<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;EVENT_PLAYER_REDUCEDRUNK<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">300000</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>EVENT_FLAG_DO_NOT_EXECUTE_IN_WORLD_CONTEXT<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6152"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6152">6152</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6153"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6153">6153</A></TH><TD></TR><TR><TH id="L6154"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6154">6154</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectFeedPet<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp; <SPAN class="c">// Feed Pet</SPAN></TD></TR><TR><TH id="L6155"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6155">6155</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6156"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6156">6156</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// food flags and food level are checked in Spell::CanCast()</SPAN></TD></TR><TR><TH id="L6157"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6157">6157</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>itemTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6158"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6158">6158</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6159"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6159">6159</A></TH><TD></TR><TR><TH id="L6160"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6160">6160</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>pPet <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetSummon<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6161"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6161">6161</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>pPet<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6162"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6162">6162</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6163"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6163">6163</A></TH><TD></TR><TR><TH id="L6164"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6164">6164</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/**&nbsp; &nbsp; &nbsp;Cast feed pet effect</SPAN></TD></TR><TR><TH id="L6165"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6165">6165</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; - effect is item level and pet level dependent, aura ticks are 35, 17, 8 (*1000) happiness</SPAN></TD></TR><TR><TH id="L6166"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6166">6166</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; - http://petopia.brashendeavors.net/html/articles/basics_feeding.shtml */</SPAN></TD></TR><TR><TH id="L6167"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6167">6167</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; int8 deltaLvl <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>int8<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>pPet<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>ItemLevel<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6168"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6168">6168</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; damage <SPAN class="o">/=</SPAN>&nbsp;<SPAN class="mi">1000</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//damage of Feed pet spell is 35000</SPAN></TD></TR><TR><TH id="L6169"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6169">6169</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>deltaLvl <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">10</SPAN><SPAN class="p">)</SPAN>&nbsp;damage <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">&gt;&gt;</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN><SPAN class="c">//divide by 2</SPAN></TD></TR><TR><TH id="L6170"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6170">6170</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>deltaLvl <SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">20</SPAN><SPAN class="p">)</SPAN>&nbsp;damage <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">&gt;&gt;</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6171"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6171">6171</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; damage <SPAN class="o">*=</SPAN>&nbsp;<SPAN class="mi">1000</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6172"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6172">6172</A></TH><TD></TR><TR><TH id="L6173"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6173">6173</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>spellInfo <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectTriggerSpell<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L6174"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6174">6174</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6175"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6175">6175</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6176"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6176">6176</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6177"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6177">6177</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Object<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="p">),</SPAN>spellInfo<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6178"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6178">6178</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>forced_basepoints<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6179"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6179">6179</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6180"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6180">6180</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; tgt<SPAN class="p">.</SPAN>m_unitTarget<SPAN class="o">=</SPAN>pPet<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6181"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6181">6181</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>tgt<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6182"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6182">6182</A></TH><TD></TR><TR><TH id="L6183"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6183">6183</A></TH><TD></TR><TR><TH id="L6184"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6184">6184</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>ITEM_FIELD_STACK_COUNT<SPAN class="p">)</SPAN><SPAN class="o">&gt;</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6185"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6185">6185</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6186"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6186">6186</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; itemTarget<SPAN class="o">-&gt;</SPAN>ModUnsigned32Value<SPAN class="p">(</SPAN>ITEM_FIELD_STACK_COUNT<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">-</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6187"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6187">6187</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; itemTarget<SPAN class="o">-&gt;</SPAN>m_isDirty<SPAN class="o">=</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6188"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6188">6188</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6189"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6189">6189</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6190"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6190">6190</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6191"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6191">6191</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SafeFullRemoveItemByGuid<SPAN class="p">(</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6192"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6192">6192</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; itemTarget<SPAN class="o">=</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6193"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6193">6193</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6194"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6194">6194</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6195"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6195">6195</A></TH><TD></TR><TR><TH id="L6196"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6196">6196</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectRedirectThreat<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6197"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6197">6197</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6198"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6198">6198</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6199"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6199">6199</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6200"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6200">6200</A></TH><TD></TR><TR><TH id="L6201"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6201">6201</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">((</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_PLAYER <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetGroup<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Player <SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>GetGroup<SPAN class="p">())</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;TYPEID_UNIT <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">()))</SPAN></TD></TR><TR><TH id="L6202"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6202">6202</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6203"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6203">6203</A></TH><TD></TR><TR><TH id="L6204"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6204">6204</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetMisdirectionTarget<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6205"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6205">6205</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6206"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6206">6206</A></TH><TD></TR><TR><TH id="L6207"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6207">6207</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectReduceThreatPercent<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6208"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6208">6208</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6209"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6209">6209</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsCreature<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>getThreatByPtr<SPAN class="p">(</SPAN>u_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6210"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6210">6210</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6211"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6211">6211</A></TH><TD></TR><TR><TH id="L6212"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6212">6212</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>modThreatByPtr<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>int32<SPAN class="p">)</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>getThreatByPtr<SPAN class="p">(</SPAN>u_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;damage <SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6213"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6213">6213</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6214"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6214">6214</A></TH><TD></TR><TR><TH id="L6215"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6215">6215</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectReputation<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6216"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6216">6216</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6217"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6217">6217</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6218"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6218">6218</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6219"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6219">6219</A></TH><TD></TR><TR><TH id="L6220"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6220">6220</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//playerTarget-&gt;modReputation(GetProto()-&gt;EffectMiscValue[i], damage, true);</SPAN></TD></TR><TR><TH id="L6221"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6221">6221</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>ModStanding<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;damage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6222"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6222">6222</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6223"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6223">6223</A></TH><TD></TR><TR><TH id="L6224"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6224">6224</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonObjectSlot<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6225"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6225">6225</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6226"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6226">6226</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6227"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6227">6227</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6228"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6228">6228</A></TH><TD></TR><TR><TH id="L6229"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6229">6229</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GameObject <SPAN class="o">*</SPAN>GoSummon <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6230"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6230">6230</A></TH><TD></TR><TR><TH id="L6231"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6231">6231</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 slot<SPAN class="o">=</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">-</SPAN>&nbsp;SPELL_EFFECT_SUMMON_OBJECT_SLOT1<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6232"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6232">6232</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>m_ObjectSlots<SPAN class="p">[</SPAN>slot<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetGameObject<SPAN class="p">(</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>m_ObjectSlots<SPAN class="p">[</SPAN>slot<SPAN class="p">])</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6233"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6233">6233</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>m_ObjectSlots<SPAN class="p">[</SPAN>slot<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6234"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6234">6234</A></TH><TD></TR><TR><TH id="L6235"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6235">6235</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GoSummon <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6236"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6236">6236</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6237"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6237">6237</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GoSummon<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6238"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6238">6238</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>ExpireAndDelete<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6239"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6239">6239</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6240"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6240">6240</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6241"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6241">6241</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GoSummon<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6242"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6242">6242</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>RemoveFromWorld<SPAN class="p">(</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6243"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6243">6243</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">delete</SPAN>&nbsp;GoSummon<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6244"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6244">6244</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6245"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6245">6245</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6246"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6246">6246</A></TH><TD></TR><TR><TH id="L6247"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6247">6247</A></TH><TD></TR><TR><TH id="L6248"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6248">6248</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// spawn a new one</SPAN></TD></TR><TR><TH id="L6249"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6249">6249</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon <SPAN class="o">=</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>CreateGameObject<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L6250"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6250">6250</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>&nbsp;GoSummon<SPAN class="o">-&gt;</SPAN>CreateFromProto<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionX<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionY<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetPositionZ<SPAN class="p">(),</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetOrientation<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L6251"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6251">6251</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6252"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6252">6252</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">delete</SPAN>&nbsp;GoSummon<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6253"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6253">6253</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6254"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6254">6254</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6255"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6255">6255</A></TH><TD></TR><TR><TH id="L6256"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6256">6256</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>GAMEOBJECT_LEVEL<SPAN class="p">,</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>getLevel<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6257"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6257">6257</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>OBJECT_FIELD_CREATED_BY<SPAN class="p">,</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6258"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6258">6258</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>SetInstanceID<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6259"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6259">6259</A></TH><TD></TR><TR><TH id="L6260"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6260">6260</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GoSummon<SPAN class="o">-&gt;</SPAN>GetByte<SPAN class="p">(</SPAN>GAMEOBJECT_BYTES_1<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;GAMEOBJECT_TYPE_TRAP<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6261"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6261">6261</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6262"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6262">6262</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>invisible <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6263"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6263">6263</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>invisibilityFlag <SPAN class="o">=</SPAN>&nbsp;INVIS_FLAG_TRAP<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6264"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6264">6264</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>charges <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6265"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6265">6265</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>checkrate <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6266"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6266">6266</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>GoSummon<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>GameObject<SPAN class="o">::</SPAN>TrapSearchTarget<SPAN class="p">,</SPAN>&nbsp;EVENT_GAMEOBJECT_TRAP_SEARCH_TARGET<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6267"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6267">6267</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6268"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6268">6268</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6269"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6269">6269</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6270"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6270">6270</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>AddEvent<SPAN class="p">(</SPAN>GoSummon<SPAN class="p">,</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>GameObject<SPAN class="o">::</SPAN>ExpireAndDelete<SPAN class="p">,</SPAN>&nbsp;EVENT_GAMEOBJECT_EXPIRE<SPAN class="p">,</SPAN>&nbsp;GetDuration<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6271"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6271">6271</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6272"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6272">6272</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>PushToWorld<SPAN class="p">(</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6273"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6273">6273</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; GoSummon<SPAN class="o">-&gt;</SPAN>SetSummoned<SPAN class="p">(</SPAN>u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6274"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6274">6274</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>m_ObjectSlots<SPAN class="p">[</SPAN>slot<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;GoSummon<SPAN class="o">-&gt;</SPAN>GetUIdFromGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6275"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6275">6275</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6276"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6276">6276</A></TH><TD></TR><TR><TH id="L6277"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6277">6277</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDispelMechanic<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6278"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6278">6278</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6279"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6279">6279</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6280"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6280">6280</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6281"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6281">6281</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* this was already working before...</SPAN></TD></TR><TR><TH id="L6282"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6282">6282</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; uint32 sMisc = GetProto()-&gt;EffectMiscValue[i];</SPAN></TD></TR><TR><TH id="L6283"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6283">6283</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6284"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6284">6284</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; for( uint32 x = 0 ; x&lt;MAX_AURAS ; x++ )</SPAN></TD></TR><TR><TH id="L6285"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6285">6285</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L6286"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6286">6286</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if( unitTarget-&gt;m_auras[x] &amp;&amp; !unitTarget-&gt;m_auras[x]-&gt;IsPositive())</SPAN></TD></TR><TR><TH id="L6287"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6287">6287</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L6288"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6288">6288</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if( unitTarget-&gt;m_auras[x]-&gt;GetSpellProto()-&gt;MechanicsType == sMisc )</SPAN></TD></TR><TR><TH id="L6289"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6289">6289</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; unitTarget-&gt;m_auras[x]-&gt;Remove();</SPAN></TD></TR><TR><TH id="L6290"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6290">6290</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L6291"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6291">6291</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L6292"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6292">6292</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L6293"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6293">6293</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>RemoveAllAurasByMechanic<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6294"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6294">6294</A></TH><TD></TR><TR><TH id="L6295"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6295">6295</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*Shady: if it's about Daze spell - dismount should be done by RemoveAllAurasByMechanic.</SPAN></TD></TR><TR><TH id="L6296"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6296">6296</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; We don't need useless code or hackfixes here, so commented.*/</SPAN></TD></TR><TR><TH id="L6297"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6297">6297</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//if( playerTarget &amp;&amp; GetProto()-&gt;NameHash == SPELL_HASH_DAZED &amp;&amp; playerTarget-&gt;IsMounted() )</SPAN></TD></TR><TR><TH id="L6298"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6298">6298</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; playerTarget-&gt;RemoveAura(playerTarget-&gt;m_MountSpellId);</SPAN></TD></TR><TR><TH id="L6299"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6299">6299</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6300"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6300">6300</A></TH><TD></TR><TR><TH id="L6301"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6301">6301</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonDeadPet<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6302"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6302">6302</A></TH><TD><SPAN class="p">{</SPAN><SPAN class="c">//this is pet resurrect</SPAN></TD></TR><TR><TH id="L6303"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6303">6303</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6304"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6304">6304</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6305"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6305">6305</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>pPet <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetSummon<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6306"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6306">6306</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>pPet<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6307"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6307">6307</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6308"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6308">6308</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6309"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6309">6309</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6310"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6310">6310</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SM_FIValue<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>SM_FMiscEffect<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>damage<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6311"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6311">6311</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SM_PIValue<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>SM_PMiscEffect<SPAN class="p">,</SPAN><SPAN class="o">&amp;</SPAN>damage<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SpellGroupType<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6312"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6312">6312</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6313"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6313">6313</A></TH><TD></TR><TR><TH id="L6314"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6314">6314</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_DYNAMIC_FLAGS<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6315"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6315">6315</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>&nbsp;UNIT_FIELD_HEALTH<SPAN class="p">,</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;uint32 <SPAN class="p">)(</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;pPet<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;damage <SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN>&nbsp;<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L6316"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6316">6316</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>setDeathState<SPAN class="p">(</SPAN>&nbsp;ALIVE <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6317"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6317">6317</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>HandleEvent<SPAN class="p">(</SPAN>&nbsp;EVENT_FOLLOWOWNER<SPAN class="p">,</SPAN>&nbsp;pPet<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6318"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6318">6318</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>&nbsp;pPet<SPAN class="p">,</SPAN>&nbsp;EVENT_PET_DELAYED_REMOVE <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6319"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6319">6319</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>SendSpellsToOwner<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6320"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6320">6320</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6321"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6321">6321</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6322"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6322">6322</A></TH><TD></TR><TR><TH id="L6323"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6323">6323</A></TH><TD><SPAN class="c">/* This effect has 2 functions</SPAN></TD></TR><TR><TH id="L6324"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6324">6324</A></TH><TD><SPAN class="c">* 1. It delete's all current totems from the player</SPAN></TD></TR><TR><TH id="L6325"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6325">6325</A></TH><TD><SPAN class="c">* 2. It returns a percentage of the mana back to the player</SPAN></TD></TR><TR><TH id="L6326"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6326">6326</A></TH><TD><SPAN class="c">*</SPAN></TD></TR><TR><TH id="L6327"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6327">6327</A></TH><TD><SPAN class="c">* Bur kick my ass if this is not safe:P</SPAN></TD></TR><TR><TH id="L6328"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6328">6328</A></TH><TD><SPAN class="c">*/</SPAN></TD></TR><TR><TH id="L6329"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6329">6329</A></TH><TD></TR><TR><TH id="L6330"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6330">6330</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDestroyAllTotems<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6331"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6331">6331</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6332"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6332">6332</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">())</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6333"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6333">6333</A></TH><TD></TR><TR><TH id="L6334"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6334">6334</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;RetreivedMana <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mf">0.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6335"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6335">6335</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 x<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>x<SPAN class="o">&lt;</SPAN><SPAN class="mi">4</SPAN><SPAN class="p">;</SPAN>x<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6336"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6336">6336</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6337"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6337">6337</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// atm totems are considert creature's</SPAN></TD></TR><TR><TH id="L6338"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6338">6338</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN>x<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L6339"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6339">6339</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6340"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6340">6340</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 SpellID <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_CREATED_BY_SPELL<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6341"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6341">6341</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>&nbsp;sp <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>SpellID<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6342"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6342">6342</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6343"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6343">6343</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">continue</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6344"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6344">6344</A></TH><TD></TR><TR><TH id="L6345"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6345">6345</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">float</SPAN>&nbsp;pts <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN>&nbsp;<SPAN class="mf">100.0f</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6346"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6346">6346</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RetreivedMana <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="kt">float</SPAN><SPAN class="p">(</SPAN>sp<SPAN class="o">-&gt;</SPAN>manaCost<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">*</SPAN>&nbsp;pts<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6347"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6347">6347</A></TH><TD></TR><TR><TH id="L6348"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6348">6348</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>m_TotemSlots<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>TotemExpire<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6349"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6349">6349</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6350"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6350">6350</A></TH><TD></TR><TR><TH id="L6351"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6351">6351</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>m_ObjectSlots<SPAN class="p">[</SPAN>x<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L6352"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6352">6352</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6353"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6353">6353</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GameObject <SPAN class="o">*</SPAN>&nbsp;obj <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapMgr<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetGameObject<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>m_ObjectSlots<SPAN class="p">[</SPAN>x<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L6354"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6354">6354</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>obj<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6355"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6355">6355</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6356"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6356">6356</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; obj<SPAN class="o">-&gt;</SPAN>ExpireAndDelete<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6357"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6357">6357</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6358"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6358">6358</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>m_ObjectSlots<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6359"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6359">6359</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6360"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6360">6360</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6361"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6361">6361</A></TH><TD></TR><TR><TH id="L6362"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6362">6362</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>Energize<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;RetreivedMana <SPAN class="p">),</SPAN>&nbsp;POWER_TYPE_MANA <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6363"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6363">6363</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6364"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6364">6364</A></TH><TD></TR><TR><TH id="L6365"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6365">6365</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonDemon<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6366"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6366">6366</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6367"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6367">6367</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="c">/* ||&nbsp; p_caster-&gt;getClass() != WARLOCK */</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//summoning a demon shouldn't be warlock only, see spells 25005, 24934, 24810 etc etc</SPAN></TD></TR><TR><TH id="L6368"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6368">6368</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6369"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6369">6369</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>pPet <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetSummon<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6370"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6370">6370</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>pPet<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6371"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6371">6371</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6372"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6372">6372</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>Dismiss<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6373"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6373">6373</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6374"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6374">6374</A></TH><TD></TR><TR><TH id="L6375"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6375">6375</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo <SPAN class="o">*</SPAN>ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L6376"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6376">6376</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>ci<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6377"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6377">6377</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6378"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6378">6378</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LocationVector <SPAN class="o">*</SPAN>vec <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6379"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6379">6379</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_targetMask <SPAN class="o">&amp;</SPAN>&nbsp;TARGET_FLAG_DEST_LOCATION <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destX <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY <SPAN class="o">&amp;&amp;</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6380"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6380">6380</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6381"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6381">6381</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vec <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">new</SPAN>&nbsp;LocationVector<SPAN class="p">(</SPAN>m_targets<SPAN class="p">.</SPAN>m_destX<SPAN class="p">,</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destY<SPAN class="p">,</SPAN>&nbsp;m_targets<SPAN class="p">.</SPAN>m_destZ<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6382"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6382">6382</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6383"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6383">6383</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPet <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>CreatePet<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6384"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6384">6384</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>CreateAsSummon<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;ci<SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">300000</SPAN><SPAN class="p">,</SPAN>&nbsp;vec<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6385"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6385">6385</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>vec<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">delete</SPAN>&nbsp;vec<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6386"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6386">6386</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6387"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6387">6387</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Create Enslave Aura if its inferno spell</SPAN></TD></TR><TR><TH id="L6388"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6388">6388</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="o">==</SPAN>&nbsp;<SPAN class="mi">1122</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6389"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6389">6389</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6390"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6390">6390</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>spellInfo <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">11726</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6391"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6391">6391</A></TH><TD></TR><TR><TH id="L6392"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6392">6392</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6393"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6393">6393</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6394"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6394">6394</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6395"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6395">6395</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Object<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>pPet<SPAN class="p">),</SPAN>spellInfo<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6396"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6396">6396</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6397"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6397">6397</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tgt<SPAN class="p">.</SPAN>m_unitTarget<SPAN class="o">=</SPAN>pPet<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6398"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6398">6398</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>tgt<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6399"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6399">6399</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6400"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6400">6400</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6401"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6401">6401</A></TH><TD></TR><TR><TH id="L6402"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6402">6402</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectResurrect<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Resurrect (Flat)</SPAN></TD></TR><TR><TH id="L6403"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6403">6403</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6404"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6404">6404</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6405"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6405">6405</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6406"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6406">6406</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>corpseTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6407"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6407">6407</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6408"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6408">6408</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unit resurrection handler</SPAN></TD></TR><TR><TH id="L6409"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6409">6409</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6410"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6410">6410</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6411"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6411">6411</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN><SPAN class="o">==</SPAN>TYPEID_UNIT <SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsDead<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6412"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6412">6412</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6413"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6413">6413</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 hlth <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">((</SPAN>uint32<SPAN class="p">)</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6414"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6414">6414</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 mana <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">((</SPAN>uint32<SPAN class="p">)</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6415"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6415">6415</A></TH><TD></TR><TR><TH id="L6416"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6416">6416</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6417"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6417">6417</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6418"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6418">6418</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;EVENT_CREATURE_REMOVE_CORPSE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6419"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6419">6419</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6420"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6420">6420</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6421"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6421">6421</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6422"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6422">6422</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;EVENT_PET_DELAYED_REMOVE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6423"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6423">6423</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;EVENT_CREATURE_REMOVE_CORPSE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6424"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6424">6424</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6425"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6425">6425</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_HEALTH<SPAN class="p">,</SPAN>&nbsp;hlth<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6426"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6426">6426</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER1<SPAN class="p">,</SPAN>&nbsp;mana<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6427"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6427">6427</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_DYNAMIC_FLAGS<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6428"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6428">6428</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>setDeathState<SPAN class="p">(</SPAN>ALIVE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6429"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6429">6429</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>Tagged<SPAN class="o">=</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6430"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6430">6430</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>TaggerGuid<SPAN class="o">=</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6431"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6431">6431</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>gold<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6432"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6432">6432</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>looters<SPAN class="p">.</SPAN>clear<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6433"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6433">6433</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>items<SPAN class="p">.</SPAN>clear<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6434"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6434">6434</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6435"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6435">6435</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6436"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6436">6436</A></TH><TD></TR><TR><TH id="L6437"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6437">6437</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6438"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6438">6438</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6439"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6439">6439</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetPlayer<SPAN class="p">(</SPAN>corpseTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>CORPSE_FIELD_OWNER<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L6440"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6440">6440</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6441"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6441">6441</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6442"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6442">6442</A></TH><TD></TR><TR><TH id="L6443"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6443">6443</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6444"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6444">6444</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6445"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6445">6445</A></TH><TD></TR><TR><TH id="L6446"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6446">6446</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 health <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6447"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6447">6447</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 mana <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6448"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6448">6448</A></TH><TD></TR><TR><TH id="L6449"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6449">6449</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>m_resurrectHealth <SPAN class="o">=</SPAN>&nbsp;health<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6450"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6450">6450</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>m_resurrectMana <SPAN class="o">=</SPAN>&nbsp;mana<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6451"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6451">6451</A></TH><TD></TR><TR><TH id="L6452"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6452">6452</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SendResurrectRequest<SPAN class="p">(</SPAN>playerTarget<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6453"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6453">6453</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>SetMovement<SPAN class="p">(</SPAN>MOVE_UNROOT<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6454"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6454">6454</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6455"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6455">6455</A></TH><TD></TR><TR><TH id="L6456"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6456">6456</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectAttackMe<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6457"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6457">6457</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6458"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6458">6458</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6459"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6459">6459</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6460"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6460">6460</A></TH><TD></TR><TR><TH id="L6461"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6461">6461</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttackReaction<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6462"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6462">6462</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6463"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6463">6463</A></TH><TD></TR><TR><TH id="L6464"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6464">6464</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSkinPlayerCorpse<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6465"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6465">6465</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6466"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6466">6466</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Corpse <SPAN class="o">*</SPAN>&nbsp;corpse <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6467"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6467">6467</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6468"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6468">6468</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6469"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6469">6469</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// means we're "skinning" a corpse</SPAN></TD></TR><TR><TH id="L6470"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6470">6470</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corpse <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetCorpse<SPAN class="p">((</SPAN>uint32<SPAN class="p">)</SPAN>m_targets<SPAN class="p">.</SPAN>m_unitTarget<SPAN class="p">);</SPAN>&nbsp; <SPAN class="c">// hacky</SPAN></TD></TR><TR><TH id="L6471"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6471">6471</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6472"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6472">6472</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>getDeathState<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;CORPSE<SPAN class="p">)</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// repopped while we were casting</SPAN></TD></TR><TR><TH id="L6473"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6473">6473</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6474"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6474">6474</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corpse <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetCorpse<SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>GetLowGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6475"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6475">6475</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6476"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6476">6476</A></TH><TD></TR><TR><TH id="L6477"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6477">6477</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>m_caster<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6478"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6478">6478</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6479"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6479">6479</A></TH><TD></TR><TR><TH id="L6480"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6480">6480</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget <SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>corpse<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6481"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6481">6481</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6482"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6482">6482</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>m_bg <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>IsDead<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6483"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6483">6483</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6484"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6484">6484</A></TH><TD></TR><TR><TH id="L6485"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6485">6485</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Set all the lootable stuff on the player. If he repops before we've looted, we'll set the flags</SPAN></TD></TR><TR><TH id="L6486"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6486">6486</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// on corpse then :p</SPAN></TD></TR><TR><TH id="L6487"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6487">6487</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6488"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6488">6488</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>bShouldHaveLootableOnCorpse <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6489"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6489">6489</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>RemoveFlag<SPAN class="p">(</SPAN>UNIT_FIELD_FLAGS<SPAN class="p">,</SPAN>&nbsp;UNIT_FLAG_SKINNABLE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6490"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6490">6490</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>SetFlag<SPAN class="p">(</SPAN>UNIT_DYNAMIC_FLAGS<SPAN class="p">,</SPAN>&nbsp;U_DYN_FLAG_LOOTABLE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6491"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6491">6491</A></TH><TD></TR><TR><TH id="L6492"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6492">6492</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Send the loot.</SPAN></TD></TR><TR><TH id="L6493"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6493">6493</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SendLoot<SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;LOOT_SKINNING<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6494"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6494">6494</A></TH><TD></TR><TR><TH id="L6495"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6495">6495</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Send a message to the died player, telling him he has to resurrect at the graveyard.</SPAN></TD></TR><TR><TH id="L6496"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6496">6496</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Send an empty corpse location too, :P</SPAN></TD></TR><TR><TH id="L6497"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6497">6497</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6498"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6498">6498</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>OutPacket<SPAN class="p">(</SPAN>SMSG_PLAYER_SKINNED<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="s">"</SPAN><SPAN class="se">\x00</SPAN><SPAN class="s">"</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6499"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6499">6499</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>OutPacket<SPAN class="p">(</SPAN>MSG_CORPSE_QUERY<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="s">"</SPAN><SPAN class="se">\x00</SPAN><SPAN class="s">"</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6500"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6500">6500</A></TH><TD></TR><TR><TH id="L6501"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6501">6501</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// don't allow him to spawn a corpse</SPAN></TD></TR><TR><TH id="L6502"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6502">6502</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>bCorpseCreateable <SPAN class="o">=</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6503"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6503">6503</A></TH><TD></TR><TR><TH id="L6504"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6504">6504</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// and.. force him to the graveyard and repop him.</SPAN></TD></TR><TR><TH id="L6505"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6505">6505</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>RepopRequestedPlayer<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6506"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6506">6506</A></TH><TD></TR><TR><TH id="L6507"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6507">6507</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN><SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>corpse<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6508"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6508">6508</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6509"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6509">6509</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// find the corpses' owner</SPAN></TD></TR><TR><TH id="L6510"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6510">6510</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Player <SPAN class="o">*</SPAN>&nbsp;owner <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetPlayer<SPAN class="p">(</SPAN>corpse<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>CORPSE_FIELD_OWNER<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L6511"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6511">6511</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>owner<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6512"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6512">6512</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6513"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6513">6513</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>owner<SPAN class="o">-&gt;</SPAN>m_bg<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6514"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6514">6514</A></TH><TD></TR><TR><TH id="L6515"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6515">6515</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; owner<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>OutPacket<SPAN class="p">(</SPAN>SMSG_PLAYER_SKINNED<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="s">"</SPAN><SPAN class="se">\x00</SPAN><SPAN class="s">"</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6516"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6516">6516</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; owner<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>OutPacket<SPAN class="p">(</SPAN>MSG_CORPSE_QUERY<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="s">"</SPAN><SPAN class="se">\x00</SPAN><SPAN class="s">"</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6517"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6517">6517</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6518"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6518">6518</A></TH><TD></TR><TR><TH id="L6519"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6519">6519</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>corpse<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>CORPSE_FIELD_DYNAMIC_FLAGS<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6520"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6520">6520</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corpse<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>CORPSE_FIELD_DYNAMIC_FLAGS<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN>&nbsp;<SPAN class="c">// sets it so you can loot the plyr</SPAN></TD></TR><TR><TH id="L6521"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6521">6521</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6522"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6522">6522</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// remove skinnable flag</SPAN></TD></TR><TR><TH id="L6523"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6523">6523</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corpse<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>CORPSE_FIELD_FLAGS<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6524"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6524">6524</A></TH><TD></TR><TR><TH id="L6525"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6525">6525</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// remove owner association</SPAN></TD></TR><TR><TH id="L6526"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6526">6526</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corpse<SPAN class="o">-&gt;</SPAN>SetUInt64Value<SPAN class="p">(</SPAN>CORPSE_FIELD_OWNER<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6527"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6527">6527</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corpse<SPAN class="o">-&gt;</SPAN>SetCorpseState<SPAN class="p">(</SPAN>CORPSE_STATE_BONES<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6528"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6528">6528</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corpse<SPAN class="o">-&gt;</SPAN>DeleteFromDB<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6529"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6529">6529</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objmgr<SPAN class="p">.</SPAN>CorpseAddEventDespawn<SPAN class="p">(</SPAN>corpse<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6530"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6530">6530</A></TH><TD></TR><TR><TH id="L6531"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6531">6531</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// send loot</SPAN></TD></TR><TR><TH id="L6532"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6532">6532</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SendLoot<SPAN class="p">(</SPAN>corpse<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;LOOT_SKINNING<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6533"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6533">6533</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6534"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6534">6534</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6535"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6535">6535</A></TH><TD></TR><TR><TH id="L6536"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6536">6536</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSkill<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6537"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6537">6537</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6538"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6538">6538</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Used by professions only</SPAN></TD></TR><TR><TH id="L6539"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6539">6539</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// Effect should be renamed in RequireSkill</SPAN></TD></TR><TR><TH id="L6540"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6540">6540</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6541"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6541">6541</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>p_caster <SPAN class="o">||</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>_GetSkillLineMax<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN>&nbsp;<SPAN class="o">&gt;=</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">75</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6542"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6542">6542</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6543"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6543">6543</A></TH><TD></TR><TR><TH id="L6544"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6544">6544</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>_HasSkillLine<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">])</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6545"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6545">6545</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>_ModifySkillMaximum<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">75</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6546"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6546">6546</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6547"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6547">6547</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>_AddSkillLine<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>&nbsp;damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="mi">75</SPAN>&nbsp;<SPAN class="p">)</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6548"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6548">6548</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6549"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6549">6549</A></TH><TD></TR><TR><TH id="L6550"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6550">6550</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectApplyPetAura<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6551"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6551">6551</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6552"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6552">6552</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SpellEffectApplyAura<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6553"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6553">6553</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6554"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6554">6554</A></TH><TD></TR><TR><TH id="L6555"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6555">6555</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDummyMelee<SPAN class="p">(</SPAN>&nbsp;uint32 i <SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// Normalized Weapon damage +</SPAN></TD></TR><TR><TH id="L6556"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6556">6556</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6557"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6557">6557</A></TH><TD></TR><TR><TH id="L6558"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6558">6558</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6559"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6559">6559</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6560"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6560">6560</A></TH><TD></TR><TR><TH id="L6561"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6561">6561</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_OVERPOWER <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster <SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//warrior : overpower - let us clear the event and the combopoint count</SPAN></TD></TR><TR><TH id="L6562"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6562">6562</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6563"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6563">6563</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>NullComboPoints<SPAN class="p">();</SPAN>&nbsp;<SPAN class="c">//some say that we should only remove 1 point per dodge. Due to cooldown you can't cast it twice anyway..</SPAN></TD></TR><TR><TH id="L6564"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6564">6564</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>&nbsp;p_caster<SPAN class="p">,</SPAN>&nbsp;EVENT_COMBO_POINT_CLEAR_FOR_TARGET <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6565"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6565">6565</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6566"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6566">6566</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_DEVASTATE<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6567"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6567">6567</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6568"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6568">6568</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//count the number of sunder armors on target</SPAN></TD></TR><TR><TH id="L6569"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6569">6569</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 sunder_count<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6570"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6570">6570</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry <SPAN class="o">*</SPAN>spellInfo<SPAN class="o">=</SPAN>dbcSpell<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN><SPAN class="mi">25225</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6571"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6571">6571</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 x <SPAN class="o">=</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_START<SPAN class="p">;</SPAN>&nbsp;x <SPAN class="o">&lt;</SPAN>&nbsp;MAX_NEGATIVE_AURAS_EXTEDED_END<SPAN class="p">;</SPAN>&nbsp;<SPAN class="o">++</SPAN>x<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6572"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6572">6572</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash<SPAN class="o">==</SPAN>SPELL_HASH_SUNDER_ARMOR<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6573"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6573">6573</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6574"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6574">6574</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sunder_count<SPAN class="o">++</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6575"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6575">6575</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spellInfo<SPAN class="o">=</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN><SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6576"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6576">6576</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6577"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6577">6577</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spellInfo<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6578"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6578">6578</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//omg how did this happen ?</SPAN></TD></TR><TR><TH id="L6579"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6579">6579</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//we should also cast sunder armor effect on target with or without dmg</SPAN></TD></TR><TR><TH id="L6580"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6580">6580</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>spell <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6581"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6581">6581</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>spell<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6582"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6582">6582</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6583"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6583">6583</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;spellInfo <SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6584"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6584">6584</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>ProcedOnSpell <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6585"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6585">6585</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>pSpellId<SPAN class="o">=</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6586"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6586">6586</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets targets<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6587"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6587">6587</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spell<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>targets<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6588"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6588">6588</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sunder_count<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6589"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6589">6589</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">//no damage = no joy</SPAN></TD></TR><TR><TH id="L6590"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6590">6590</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; damage <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="o">*</SPAN>sunder_count<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6591"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6591">6591</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6592"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6592">6592</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/*else if( GetProto()-&gt;NameHash == SPELL_HASH_CRUSADER_STRIKE ) // Crusader Strike - refreshes *all* judgements, not just your own</SPAN></TD></TR><TR><TH id="L6593"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6593">6593</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L6594"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6594">6594</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for( int x = MAX_NEGATIVE_AURAS_EXTEDED_START ; x &lt; MAX_NEGATIVE_AURAS_EXTEDED_END ; x ++ ) // there are only debuff judgements anyway :P</SPAN></TD></TR><TR><TH id="L6595"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6595">6595</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L6596"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6596">6596</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( unitTarget-&gt;m_auras[x] &amp;&amp; unitTarget-&gt;m_auras[x]-&gt;GetSpellProto()-&gt;BGR_one_buff_from_caster_on_1target == SPELL_TYPE_INDEX_JUDGEMENT )</SPAN></TD></TR><TR><TH id="L6597"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6597">6597</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</SPAN></TD></TR><TR><TH id="L6598"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6598">6598</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Refresh it!</SPAN></TD></TR><TR><TH id="L6599"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6599">6599</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // oh noes, they don't stack...</SPAN></TD></TR><TR><TH id="L6600"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6600">6600</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Aura * aur = unitTarget-&gt;m_auras[x];</SPAN></TD></TR><TR><TH id="L6601"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6601">6601</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEntry * spinfo = aur-&gt;GetSpellProto();</SPAN></TD></TR><TR><TH id="L6602"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6602">6602</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aur-&gt;Remove();</SPAN></TD></TR><TR><TH id="L6603"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6603">6603</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spell * sp = SpellPool.PooledNew();</SPAN></TD></TR><TR><TH id="L6604"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6604">6604</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!sp)</SPAN></TD></TR><TR><TH id="L6605"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6605">6605</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</SPAN></TD></TR><TR><TH id="L6606"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6606">6606</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp-&gt;Init( this-&gt;u_caster , spinfo , true , NULL );</SPAN></TD></TR><TR><TH id="L6607"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6607">6607</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6608"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6608">6608</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt;</SPAN></TD></TR><TR><TH id="L6609"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6609">6609</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tgt.m_unitTarget = unitTarget-&gt;GetGUID();</SPAN></TD></TR><TR><TH id="L6610"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6610">6610</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp-&gt;prepare( &amp;tgt );</SPAN></TD></TR><TR><TH id="L6611"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6611">6611</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L6612"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6612">6612</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</SPAN></TD></TR><TR><TH id="L6613"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6613">6613</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; }*/</SPAN></TD></TR><TR><TH id="L6614"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6614">6614</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Hemorrhage</SPAN></TD></TR><TR><TH id="L6615"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6615">6615</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;p_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_HEMORRHAGE <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6616"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6616">6616</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>AddComboPoints<SPAN class="p">(</SPAN>p_caster<SPAN class="o">-&gt;</SPAN>GetSelection<SPAN class="p">(),</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6617"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6617">6617</A></TH><TD></TR><TR><TH id="L6618"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6618">6618</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6619"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6619">6619</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6620"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6620">6620</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// AMBUSH</SPAN></TD></TR><TR><TH id="L6621"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6621">6621</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8676</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">77</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r1</SPAN></TD></TR><TR><TH id="L6622"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6622">6622</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8724</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">110</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// r2</SPAN></TD></TR><TR><TH id="L6623"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6623">6623</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8725</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">138</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<SPAN class="c">// r3</SPAN></TD></TR><TR><TH id="L6624"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6624">6624</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11267</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">204</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r4</SPAN></TD></TR><TR><TH id="L6625"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6625">6625</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11268</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">253</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r5</SPAN></TD></TR><TR><TH id="L6626"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6626">6626</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11269</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">319</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r6</SPAN></TD></TR><TR><TH id="L6627"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6627">6627</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">27441</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">369</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r7</SPAN></TD></TR><TR><TH id="L6628"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6628">6628</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48689</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">509</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r8</SPAN></TD></TR><TR><TH id="L6629"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6629">6629</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48690</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">770</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r9</SPAN></TD></TR><TR><TH id="L6630"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6630">6630</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48691</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">908</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r10</SPAN></TD></TR><TR><TH id="L6631"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6631">6631</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6632"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6632">6632</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// BACKSTAB</SPAN></TD></TR><TR><TH id="L6633"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6633">6633</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">53</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">15</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r1</SPAN></TD></TR><TR><TH id="L6634"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6634">6634</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">2589</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">30</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r2</SPAN></TD></TR><TR><TH id="L6635"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6635">6635</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">2590</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">48</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r3</SPAN></TD></TR><TR><TH id="L6636"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6636">6636</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">2591</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">69</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r4</SPAN></TD></TR><TR><TH id="L6637"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6637">6637</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">8721</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">90</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r5</SPAN></TD></TR><TR><TH id="L6638"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6638">6638</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11279</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">135</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r6</SPAN></TD></TR><TR><TH id="L6639"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6639">6639</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11280</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">165</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r7</SPAN></TD></TR><TR><TH id="L6640"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6640">6640</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">11281</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">210</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r8</SPAN></TD></TR><TR><TH id="L6641"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6641">6641</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">25300</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">225</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r9</SPAN></TD></TR><TR><TH id="L6642"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6642">6642</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">26863</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">255</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r10</SPAN></TD></TR><TR><TH id="L6643"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6643">6643</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48656</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">383</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r11</SPAN></TD></TR><TR><TH id="L6644"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6644">6644</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">48657</SPAN><SPAN class="o">:</SPAN>&nbsp;add_damage <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">465</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="k">break</SPAN><SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// r12</SPAN></TD></TR><TR><TH id="L6645"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6645">6645</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6646"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6646">6646</A></TH><TD></TR><TR><TH id="L6647"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6647">6647</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// rogue ambush etc</SPAN></TD></TR><TR><TH id="L6648"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6648">6648</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32 x <SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>x<SPAN class="o">&lt;</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN>x<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6649"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6649">6649</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_EFFECT_WEAPON_PERCENT_DAMAGE<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6650"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6650">6650</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6651"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6651">6651</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add_damage <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">*</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">/</SPAN><SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6652"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6652">6652</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6653"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6653">6653</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6654"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6654">6654</A></TH><TD></TR><TR><TH id="L6655"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6655">6655</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//rogue - mutilate ads dmg if target is poisoned</SPAN></TD></TR><TR><TH id="L6656"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6656">6656</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 pct_dmg_mod <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6657"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6657">6657</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp; &nbsp; &nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="o">==</SPAN>&nbsp;SPELL_HASH_MUTILATE <SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPoisoned<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6658"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6658">6658</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pct_dmg_mod <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">150</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6659"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6659">6659</A></TH><TD></TR><TR><TH id="L6660"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6660">6660</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 _type<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6661"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6661">6661</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetType<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">==</SPAN>&nbsp;SPELL_DMG_TYPE_RANGED <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6662"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6662">6662</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp;RANGED<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6663"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6663">6663</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6664"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6664">6664</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6665"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6665">6665</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttributesExC <SPAN class="o">&amp;</SPAN>&nbsp;<SPAN class="mh">0x1000000</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6666"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6666">6666</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp; OFFHAND<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6667"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6667">6667</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6668"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6668">6668</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _type <SPAN class="o">=</SPAN>&nbsp;MELEE<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6669"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6669">6669</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6670"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6670">6670</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>Strike<SPAN class="p">(</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;_type<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">(),</SPAN>&nbsp;damage<SPAN class="p">,</SPAN>&nbsp;pct_dmg_mod<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6671"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6671">6671</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6672"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6672">6672</A></TH><TD></TR><TR><TH id="L6673"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6673">6673</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectFilming<SPAN class="p">(</SPAN>&nbsp;uint32 i <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6674"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6674">6674</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6675"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6675">6675</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6676"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6676">6676</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6677"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6677">6677</A></TH><TD></TR><TR><TH id="L6678"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6678">6678</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>HasFlag<SPAN class="p">(</SPAN>UNIT_FIELD_FLAGS<SPAN class="p">,</SPAN>&nbsp;UNIT_FLAG_LOCK_PLAYER<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L6679"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6679">6679</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6680"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6680">6680</A></TH><TD></TR><TR><TH id="L6681"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6681">6681</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; TaxiPath<SPAN class="o">*</SPAN>&nbsp;taxipath <SPAN class="o">=</SPAN>&nbsp;sTaxiMgr<SPAN class="p">.</SPAN>GetTaxiPath<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L6682"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6682">6682</A></TH><TD></TR><TR><TH id="L6683"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6683">6683</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>taxipath <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6684"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6684">6684</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6685"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6685">6685</A></TH><TD></TR><TR><TH id="L6686"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6686">6686</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; TaxiNode<SPAN class="o">*</SPAN>&nbsp;taxinode <SPAN class="o">=</SPAN>&nbsp;sTaxiMgr<SPAN class="p">.</SPAN>GetTaxiNode<SPAN class="p">(</SPAN>&nbsp;taxipath<SPAN class="o">-&gt;</SPAN>GetSourceNode<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6687"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6687">6687</A></TH><TD></TR><TR><TH id="L6688"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6688">6688</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>taxinode <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6689"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6689">6689</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6690"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6690">6690</A></TH><TD></TR><TR><TH id="L6691"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6691">6691</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 modelid <SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6692"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6692">6692</A></TH><TD></TR><TR><TH id="L6693"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6693">6693</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>GetTeam<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6694"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6694">6694</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6695"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6695">6695</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo<SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;taxinode<SPAN class="o">-&gt;</SPAN>horde_mount <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6696"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6696">6696</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>ci<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6697"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6697">6697</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modelid <SPAN class="o">=</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6698"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6698">6698</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>modelid<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6699"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6699">6699</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6700"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6700">6700</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6701"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6701">6701</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6702"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6702">6702</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CreatureInfo<SPAN class="o">*</SPAN>&nbsp;ci <SPAN class="o">=</SPAN>&nbsp;CreatureNameStorage<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;taxinode<SPAN class="o">-&gt;</SPAN>alliance_mount <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6703"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6703">6703</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>ci<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6704"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6704">6704</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; modelid <SPAN class="o">=</SPAN>&nbsp;ci<SPAN class="o">-&gt;</SPAN>Male_DisplayID<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6705"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6705">6705</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>modelid<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6706"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6706">6706</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6707"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6707">6707</A></TH><TD></TR><TR><TH id="L6708"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6708">6708</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>DismissActivePet<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6709"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6709">6709</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>TaxiStart<SPAN class="p">(</SPAN>&nbsp;taxipath<SPAN class="p">,</SPAN>&nbsp;modelid<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6710"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6710">6710</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6711"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6711">6711</A></TH><TD></TR><TR><TH id="L6712"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6712">6712</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSpellSteal<SPAN class="p">(</SPAN>&nbsp;uint32 i <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6713"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6713">6713</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6714"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6714">6714</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6715"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6715">6715</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6716"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6716">6716</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster <SPAN class="o">&amp;&amp;</SPAN>&nbsp;p_caster <SPAN class="o">!=</SPAN>&nbsp;<SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L6717"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6717">6717</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6718"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6718">6718</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>&nbsp;Player<SPAN class="o">*</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>IsPvPFlagged<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6719"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6719">6719</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetPvPFlag<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6720"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6720">6720</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6721"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6721">6721</A></TH><TD></TR><TR><TH id="L6722"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6722">6722</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Aura <SPAN class="o">*</SPAN>aur<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6723"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6723">6723</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 start<SPAN class="p">,</SPAN>&nbsp;end<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6724"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6724">6724</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>isAttackable<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>unitTarget<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L6725"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6725">6725</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6726"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6726">6726</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; start<SPAN class="o">=</SPAN>MAX_POSITIVE_AURAS_EXTEDED_START<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6727"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6727">6727</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end<SPAN class="o">=</SPAN>MAX_POSITIVE_AURAS_EXTEDED_END<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6728"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6728">6728</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6729"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6729">6729</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6730"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6730">6730</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6731"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6731">6731</A></TH><TD></TR><TR><TH id="L6732"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6732">6732</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_SPELLDISPELLOG<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">16</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6733"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6733">6733</A></TH><TD></TR><TR><TH id="L6734"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6734">6734</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 x<SPAN class="o">=</SPAN>start<SPAN class="p">;</SPAN>x<SPAN class="o">&lt;</SPAN>end<SPAN class="p">;</SPAN>x<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6735"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6735">6735</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6736"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6736">6736</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L6737"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6737">6737</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6738"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6738">6738</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aur <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>m_auras<SPAN class="p">[</SPAN>x<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6739"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6739">6739</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>aur<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">15007</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;<SPAN class="o">!</SPAN>aur<SPAN class="o">-&gt;</SPAN>IsPassive<SPAN class="p">()</SPAN></TD></TR><TR><TH id="L6740"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6740">6740</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; aur-&gt;IsPositive()&nbsp; &nbsp; // Zack : We are only checking positiv auras. There is no meaning to check again</SPAN></TD></TR><TR><TH id="L6741"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6741">6741</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//Nothing can dispel resurrection sickness</SPAN></TD></TR><TR><TH id="L6742"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6742">6742</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6743"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6743">6743</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>DispelType <SPAN class="o">==</SPAN>&nbsp;DISPEL_MAGIC<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6744"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6744">6744</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6745"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6745">6745</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data<SPAN class="p">.</SPAN>clear<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6746"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6746">6746</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6747"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6747">6747</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetNewGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6748"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6748">6748</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6749"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6749">6749</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6750"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6750">6750</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SendMessageToSet<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">,</SPAN><SPAN class="kc">true</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6751"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6751">6751</A></TH><TD></TR><TR><TH id="L6752"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6752">6752</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 aurdur <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetDuration<SPAN class="p">()</SPAN><SPAN class="o">&gt;</SPAN><SPAN class="mi">120000</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;<SPAN class="mi">120000</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetDuration<SPAN class="p">()</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6753"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6753">6753</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Aura <SPAN class="o">*</SPAN>aura <SPAN class="o">=</SPAN>&nbsp;AuraPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6754"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6754">6754</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>aura<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6755"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6755">6755</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6756"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6756">6756</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aura<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">(),</SPAN>&nbsp;aurdur<SPAN class="p">,</SPAN>&nbsp;u_caster<SPAN class="p">,</SPAN>&nbsp;u_caster <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6757"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6757">6757</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 aur_removed <SPAN class="o">=</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>RemoveAllAuraByNameHash<SPAN class="p">(</SPAN>&nbsp;aur<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6758"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6758">6758</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;uint32 i <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;i <SPAN class="o">&lt;</SPAN>&nbsp;<SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">++</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6759"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6759">6759</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6760"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6760">6760</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;aura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Effect<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6761"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6761">6761</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6762"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6762">6762</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aura<SPAN class="o">-&gt;</SPAN>AddMod<SPAN class="p">(</SPAN>&nbsp;aura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectApplyAuraName<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;aura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN>&nbsp;aura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">],</SPAN>&nbsp;i <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6763"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6763">6763</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6764"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6764">6764</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6765"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6765">6765</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;aura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>procCharges<SPAN class="o">&gt;</SPAN><SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6766"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6766">6766</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6767"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6767">6767</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Aura <SPAN class="o">*</SPAN>aur<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6768"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6768">6768</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 i <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">&lt;</SPAN>aur_removed<SPAN class="o">-</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN>&nbsp;i<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6769"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6769">6769</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6770"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6770">6770</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aur <SPAN class="o">=</SPAN>&nbsp;AuraPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6771"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6771">6771</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>aur<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6772"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6772">6772</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6773"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6773">6773</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; aur<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>aura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">(),</SPAN>&nbsp;aurdur<SPAN class="p">,</SPAN>&nbsp;u_caster<SPAN class="p">,</SPAN>&nbsp;u_caster<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6774"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6774">6774</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>AddAura<SPAN class="p">(</SPAN>aur<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6775"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6775">6775</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6776"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6776">6776</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN><SPAN class="p">(</SPAN>aura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>procFlags <SPAN class="o">&amp;</SPAN>&nbsp;PROC_REMOVEONUSE<SPAN class="p">))</SPAN></TD></TR><TR><TH id="L6777"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6777">6777</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6778"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6778">6778</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellCharge charge<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6779"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6779">6779</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; charge<SPAN class="p">.</SPAN>count<SPAN class="o">=</SPAN>aur_removed<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6780"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6780">6780</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; charge<SPAN class="p">.</SPAN>spellId<SPAN class="o">=</SPAN>aura<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6781"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6781">6781</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; charge<SPAN class="p">.</SPAN>ProcFlag<SPAN class="o">=</SPAN>aura<SPAN class="o">-&gt;</SPAN>GetSpellProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>procFlags<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6782"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6782">6782</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; charge<SPAN class="p">.</SPAN>lastproc <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6783"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6783">6783</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>m_chargeSpells<SPAN class="p">.</SPAN>insert<SPAN class="p">(</SPAN>make_pair<SPAN class="p">(</SPAN>aura<SPAN class="o">-&gt;</SPAN>GetSpellId<SPAN class="p">(),</SPAN>charge<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L6784"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6784">6784</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6785"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6785">6785</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6786"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6786">6786</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>AddAura<SPAN class="p">(</SPAN>aura<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6787"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6787">6787</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">break</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6788"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6788">6788</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6789"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6789">6789</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6790"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6790">6790</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6791"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6791">6791</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6792"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6792">6792</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6793"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6793">6793</A></TH><TD></TR><TR><TH id="L6794"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6794">6794</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectProspecting<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6795"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6795">6795</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6796"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6796">6796</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6797"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6797">6797</A></TH><TD></TR><TR><TH id="L6798"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6798">6798</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>itemTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// this should never happen</SPAN></TD></TR><TR><TH id="L6799"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6799">6799</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6800"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6800">6800</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_CANT_BE_PROSPECTED<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6801"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6801">6801</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6802"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6802">6802</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6803"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6803">6803</A></TH><TD></TR><TR><TH id="L6804"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6804">6804</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Fill Prospecting loot</SPAN></TD></TR><TR><TH id="L6805"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6805">6805</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetLootGUID<SPAN class="p">(</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6806"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6806">6806</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>loot <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6807"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6807">6807</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6808"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6808">6808</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; itemTarget<SPAN class="o">-&gt;</SPAN>loot <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">new</SPAN>&nbsp;Loot<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6809"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6809">6809</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillProspectingLoot<SPAN class="p">(</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>loot <SPAN class="p">,</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6810"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6810">6810</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6811"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6811">6811</A></TH><TD></TR><TR><TH id="L6812"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6812">6812</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="o">-&gt;</SPAN>items<SPAN class="p">.</SPAN>size<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6813"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6813">6813</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6814"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6814">6814</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log<SPAN class="p">.</SPAN>Debug<SPAN class="p">(</SPAN><SPAN class="s">"SpellEffect"</SPAN><SPAN class="p">,</SPAN><SPAN class="s">"Succesfully prospected item %d"</SPAN><SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">()));</SPAN></TD></TR><TR><TH id="L6815"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6815">6815</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SendLoot<SPAN class="p">(</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;LOOT_PROSPECTING <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6816"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6816">6816</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6817"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6817">6817</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="c">// this should never happen either</SPAN></TD></TR><TR><TH id="L6818"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6818">6818</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6819"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6819">6819</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log<SPAN class="p">.</SPAN>Debug<SPAN class="p">(</SPAN><SPAN class="s">"SpellEffect"</SPAN><SPAN class="p">,</SPAN><SPAN class="s">"Prospecting failed, item %d has no loot"</SPAN><SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">()));</SPAN></TD></TR><TR><TH id="L6820"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6820">6820</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_CANT_BE_PROSPECTED<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6821"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6821">6821</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6822"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6822">6822</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6823"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6823">6823</A></TH><TD></TR><TR><TH id="L6824"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6824">6824</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectMilling<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6825"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6825">6825</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6826"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6826">6826</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6827"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6827">6827</A></TH><TD></TR><TR><TH id="L6828"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6828">6828</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>itemTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// this should never happen</SPAN></TD></TR><TR><TH id="L6829"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6829">6829</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6830"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6830">6830</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_CANT_BE_PROSPECTED<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6831"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6831">6831</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6832"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6832">6832</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6833"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6833">6833</A></TH><TD></TR><TR><TH id="L6834"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6834">6834</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Fill Prospecting loot</SPAN></TD></TR><TR><TH id="L6835"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6835">6835</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SetLootGUID<SPAN class="p">(</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6836"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6836">6836</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>loot <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6837"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6837">6837</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6838"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6838">6838</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; itemTarget<SPAN class="o">-&gt;</SPAN>loot <SPAN class="o">=</SPAN>&nbsp;<SPAN class="k">new</SPAN>&nbsp;Loot<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6839"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6839">6839</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lootmgr<SPAN class="p">.</SPAN>FillMillingLoot<SPAN class="p">(</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>loot <SPAN class="p">,</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6840"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6840">6840</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6841"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6841">6841</A></TH><TD></TR><TR><TH id="L6842"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6842">6842</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>loot<SPAN class="o">-&gt;</SPAN>items<SPAN class="p">.</SPAN>size<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;<SPAN class="mi">0</SPAN>&nbsp;<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6843"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6843">6843</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6844"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6844">6844</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log<SPAN class="p">.</SPAN>Debug<SPAN class="p">(</SPAN><SPAN class="s">"SpellEffect"</SPAN><SPAN class="p">,</SPAN><SPAN class="s">"Succesfully milled item %d"</SPAN><SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">()));</SPAN></TD></TR><TR><TH id="L6845"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6845">6845</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p_caster<SPAN class="o">-&gt;</SPAN>SendLoot<SPAN class="p">(</SPAN>&nbsp;itemTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">(),</SPAN>&nbsp;LOOT_MILLING <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6846"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6846">6846</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6847"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6847">6847</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN>&nbsp;<SPAN class="c">// this should never happen either</SPAN></TD></TR><TR><TH id="L6848"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6848">6848</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6849"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6849">6849</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log<SPAN class="p">.</SPAN>Debug<SPAN class="p">(</SPAN><SPAN class="s">"SpellEffect"</SPAN><SPAN class="p">,</SPAN><SPAN class="s">"Milling failed, item %d has no loot"</SPAN><SPAN class="p">,</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>itemTarget<SPAN class="o">-&gt;</SPAN>GetEntry<SPAN class="p">()));</SPAN></TD></TR><TR><TH id="L6850"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6850">6850</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_CANT_BE_PROSPECTED<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6851"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6851">6851</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6852"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6852">6852</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6853"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6853">6853</A></TH><TD></TR><TR><TH id="L6854"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6854">6854</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectResurrectNew<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6855"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6855">6855</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6856"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6856">6856</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//base p =hp,misc mana</SPAN></TD></TR><TR><TH id="L6857"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6857">6857</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6858"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6858">6858</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6859"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6859">6859</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>corpseTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6860"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6860">6860</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6861"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6861">6861</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// unit resurrection handler</SPAN></TD></TR><TR><TH id="L6862"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6862">6862</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6863"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6863">6863</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6864"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6864">6864</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetTypeId<SPAN class="p">()</SPAN><SPAN class="o">==</SPAN>TYPEID_UNIT <SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">&amp;&amp;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>IsDead<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6865"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6865">6865</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6866"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6866">6866</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 hlth <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">((</SPAN>uint32<SPAN class="p">)</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXHEALTH<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6867"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6867">6867</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint32 mana <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">((</SPAN>uint32<SPAN class="p">)</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">&gt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">))</SPAN>&nbsp;<SPAN class="o">?</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">)</SPAN>&nbsp;<SPAN class="o">:</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6868"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6868">6868</A></TH><TD></TR><TR><TH id="L6869"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6869">6869</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>IsPet<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6870"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6870">6870</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6871"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6871">6871</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;EVENT_CREATURE_REMOVE_CORPSE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6872"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6872">6872</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6873"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6873">6873</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L6874"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6874">6874</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6875"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6875">6875</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;EVENT_PET_DELAYED_REMOVE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6876"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6876">6876</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sEventMgr<SPAN class="p">.</SPAN>RemoveEvents<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>&nbsp;EVENT_CREATURE_REMOVE_CORPSE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6877"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6877">6877</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6878"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6878">6878</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_HEALTH<SPAN class="p">,</SPAN>&nbsp;hlth<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6879"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6879">6879</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER1<SPAN class="p">,</SPAN>&nbsp;mana<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6880"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6880">6880</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetUInt32Value<SPAN class="p">(</SPAN>UNIT_DYNAMIC_FLAGS<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6881"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6881">6881</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>setDeathState<SPAN class="p">(</SPAN>ALIVE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6882"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6882">6882</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>Tagged<SPAN class="o">=</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6883"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6883">6883</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>TaggerGuid<SPAN class="o">=</SPAN><SPAN class="kc">false</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6884"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6884">6884</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>gold<SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6885"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6885">6885</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>looters<SPAN class="p">.</SPAN>clear<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6886"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6886">6886</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static_cast</SPAN><SPAN class="o">&lt;</SPAN>Creature<SPAN class="o">*&gt;</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="p">)</SPAN><SPAN class="o">-&gt;</SPAN>loot<SPAN class="p">.</SPAN>items<SPAN class="p">.</SPAN>clear<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6887"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6887">6887</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6888"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6888">6888</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6889"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6889">6889</A></TH><TD></TR><TR><TH id="L6890"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6890">6890</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6891"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6891">6891</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6892"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6892">6892</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTarget <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>GetPlayer<SPAN class="p">(</SPAN>corpseTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>CORPSE_FIELD_OWNER<SPAN class="p">));</SPAN></TD></TR><TR><TH id="L6893"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6893">6893</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6894"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6894">6894</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6895"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6895">6895</A></TH><TD></TR><TR><TH id="L6896"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6896">6896</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">()</SPAN>&nbsp;<SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget<SPAN class="o">-&gt;</SPAN>IsInWorld<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L6897"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6897">6897</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6898"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6898">6898</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//resurr</SPAN></TD></TR><TR><TH id="L6899"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6899">6899</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//playerTarget-&gt;resurrector = p_caster-&gt;GetLowGUID();</SPAN></TD></TR><TR><TH id="L6900"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6900">6900</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>m_resurrectMapId <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetMapId<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6901"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6901">6901</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>m_resurrectInstanceID <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetInstanceID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6902"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6902">6902</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>m_resurrectPosition <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetPosition<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6903"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6903">6903</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>m_resurrectHealth <SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6904"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6904">6904</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>m_resurrectMana <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6905"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6905">6905</A></TH><TD></TR><TR><TH id="L6906"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6906">6906</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SendResurrectRequest<SPAN class="p">(</SPAN>&nbsp;playerTarget <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6907"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6907">6907</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6908"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6908">6908</A></TH><TD></TR><TR><TH id="L6909"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6909">6909</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectTranformItem<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6910"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6910">6910</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6911"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6911">6911</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">bool</SPAN>&nbsp;result<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6912"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6912">6912</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; AddItemResult result2<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6913"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6913">6913</A></TH><TD></TR><TR><TH id="L6914"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6914">6914</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>i_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6915"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6915">6915</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 itemid<SPAN class="o">=</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectItemType<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L6916"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6916">6916</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>itemid<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6917"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6917">6917</A></TH><TD></TR><TR><TH id="L6918"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6918">6918</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//Save durability of the old item</SPAN></TD></TR><TR><TH id="L6919"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6919">6919</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; Player <SPAN class="o">*</SPAN>&nbsp;owner<SPAN class="o">=</SPAN>i_caster<SPAN class="o">-&gt;</SPAN>GetOwner<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6920"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6920">6920</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 dur<SPAN class="o">=</SPAN>&nbsp;i_caster<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>ITEM_FIELD_DURABILITY<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6921"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6921">6921</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; int8 slot=owner-&gt;GetItemInterface()-&gt;GetInventorySlotByGuid(i_caster-&gt;GetGUID());</SPAN></TD></TR><TR><TH id="L6922"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6922">6922</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//&nbsp; &nbsp; &nbsp; uint32 invt=i_caster-&gt;GetProto()-&gt;InventoryType;</SPAN></TD></TR><TR><TH id="L6923"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6923">6923</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6924"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6924">6924</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; result&nbsp; <SPAN class="o">=</SPAN>&nbsp;owner<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SafeFullRemoveItemByGuid<SPAN class="p">(</SPAN>i_caster<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L6925"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6925">6925</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>result<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6926"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6926">6926</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6927"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6927">6927</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//something went wrong if this happen, item doesnt exist, so it wasnt destroyed.</SPAN></TD></TR><TR><TH id="L6928"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6928">6928</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6929"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6929">6929</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6930"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6930">6930</A></TH><TD></TR><TR><TH id="L6931"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6931">6931</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; i_caster <SPAN class="o">=</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6932"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6932">6932</A></TH><TD></TR><TR><TH id="L6933"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6933">6933</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Item <SPAN class="o">*</SPAN>it <SPAN class="o">=</SPAN>&nbsp;objmgr<SPAN class="p">.</SPAN>CreateItem<SPAN class="p">(</SPAN>itemid<SPAN class="p">,</SPAN>owner<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6934"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6934">6934</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>it<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6935"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6935">6935</A></TH><TD></TR><TR><TH id="L6936"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6936">6936</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; it<SPAN class="o">-&gt;</SPAN>SetDurability<SPAN class="p">(</SPAN>dur<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6937"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6937">6937</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//additem</SPAN></TD></TR><TR><TH id="L6938"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6938">6938</A></TH><TD><SPAN class="c"></SPAN></TD></TR><TR><TH id="L6939"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6939">6939</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//additem</SPAN></TD></TR><TR><TH id="L6940"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6940">6940</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; result2 <SPAN class="o">=</SPAN>&nbsp;owner<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AddItemToFreeSlot<SPAN class="p">(</SPAN>it<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6941"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6941">6941</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>result2<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">//should never get here</SPAN></TD></TR><TR><TH id="L6942"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6942">6942</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6943"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6943">6943</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; owner<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>BuildInventoryChangeError<SPAN class="p">(</SPAN><SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">,</SPAN>&nbsp;INV_ERR_BAG_FULL<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6944"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6944">6944</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; it<SPAN class="o">-&gt;</SPAN>DeleteMe<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6945"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6945">6945</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6946"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6946">6946</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6947"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6947">6947</A></TH><TD></TR><TR><TH id="L6948"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6948">6948</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectEnvironmentalDamage<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6949"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6949">6949</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6950"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6950">6950</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6951"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6951">6951</A></TH><TD></TR><TR><TH id="L6952"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6952">6952</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>SchoolImmunityList<SPAN class="p">[</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>School<SPAN class="p">])</SPAN></TD></TR><TR><TH id="L6953"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6953">6953</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6954"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6954">6954</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendCastResult<SPAN class="p">(</SPAN>SPELL_FAILED_IMMUNE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6955"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6955">6955</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6956"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6956">6956</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6957"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6957">6957</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">//this is GO, not unit</SPAN></TD></TR><TR><TH id="L6958"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6958">6958</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; m_caster<SPAN class="o">-&gt;</SPAN>SpellNonMeleeDamageLog<SPAN class="p">(</SPAN>unitTarget<SPAN class="p">,</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>damage<SPAN class="p">,</SPAN>&nbsp;pSpellId<SPAN class="o">==</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6959"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6959">6959</A></TH><TD></TR><TR><TH id="L6960"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6960">6960</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_ENVIRONMENTALDAMAGELOG<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">13</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6961"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6961">6961</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6962"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6962">6962</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint8<SPAN class="p">(</SPAN>DAMAGE_FIRE<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6963"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6963">6963</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN>damage<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6964"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6964">6964</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SendMessageToSet<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">&amp;</SPAN>data<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6965"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6965">6965</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6966"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6966">6966</A></TH><TD></TR><TR><TH id="L6967"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6967">6967</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectDismissPet<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6968"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6968">6968</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6969"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6969">6969</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// remove pet.. but don't delete so it can be called later</SPAN></TD></TR><TR><TH id="L6970"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6970">6970</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>p_caster<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6971"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6971">6971</A></TH><TD></TR><TR><TH id="L6972"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6972">6972</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Pet <SPAN class="o">*</SPAN>pPet <SPAN class="o">=</SPAN>&nbsp;p_caster<SPAN class="o">-&gt;</SPAN>GetSummon<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L6973"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6973">6973</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>pPet<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6974"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6974">6974</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; pPet<SPAN class="o">-&gt;</SPAN>Remove<SPAN class="p">(</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6975"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6975">6975</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6976"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6976">6976</A></TH><TD></TR><TR><TH id="L6977"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6977">6977</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectEnchantHeldItem<SPAN class="p">(</SPAN>&nbsp;uint32 i <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6978"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6978">6978</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6979"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6979">6979</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6980"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6980">6980</A></TH><TD></TR><TR><TH id="L6981"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6981">6981</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Item <SPAN class="o">*</SPAN>&nbsp;item <SPAN class="o">=</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>GetItemInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>GetInventoryItem<SPAN class="p">(</SPAN>&nbsp;EQUIPMENT_SLOT_MAINHAND <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6982"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6982">6982</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>item <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6983"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6983">6983</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6984"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6984">6984</A></TH><TD></TR><TR><TH id="L6985"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6985">6985</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 Duration <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">1800</SPAN><SPAN class="p">;</SPAN>&nbsp;<SPAN class="c">// Needs to be found in dbc.. I guess?</SPAN></TD></TR><TR><TH id="L6986"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6986">6986</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>NameHash <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L6987"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6987">6987</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6988"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6988">6988</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_WINDFURY_WEAPON:</SPAN>&nbsp;<SPAN class="c">// Windfury Weapon Effect</SPAN></TD></TR><TR><TH id="L6989"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6989">6989</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6990"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6990">6990</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Duration <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">10</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6991"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6991">6991</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6992"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6992">6992</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="nl">SPELL_HASH_FLAMETONGUE_WEAPON:</SPAN>&nbsp;<SPAN class="c">// Flametongue Weapon Effect</SPAN></TD></TR><TR><TH id="L6993"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6993">6993</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L6994"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6994">6994</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Duration <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">10</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L6995"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6995">6995</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6996"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6996">6996</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L6997"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6997">6997</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; EnchantEntry <SPAN class="o">*</SPAN>&nbsp;Enchantment <SPAN class="o">=</SPAN>&nbsp;dbcEnchant<SPAN class="p">.</SPAN>LookupEntry<SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectMiscValue<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L6998"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6998">6998</A></TH><TD></TR><TR><TH id="L6999"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L6999">6999</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>Enchantment <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7000"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7000">7000</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7001"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7001">7001</A></TH><TD></TR><TR><TH id="L7002"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7002">7002</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">/* Windfury Totem removed in 3.0.2</SPAN></TD></TR><TR><TH id="L7003"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7003">7003</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; if (m_spellInfo-&gt;NameHash == SPELL_HASH_WINDFURY_TOTEM_EFFECT &amp;&amp; item-&gt;HasEnchantmentOnSlot( 1 ) &amp;&amp; item-&gt;GetEnchantment( 1 )-&gt;Enchantment != Enchantment) //dirty fix for Windfury totem not overwriting existing enchantments</SPAN></TD></TR><TR><TH id="L7004"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7004">7004</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; return;</SPAN></TD></TR><TR><TH id="L7005"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7005">7005</A></TH><TD><SPAN class="c">&nbsp; &nbsp; &nbsp; &nbsp; */</SPAN></TD></TR><TR><TH id="L7006"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7006">7006</A></TH><TD></TR><TR><TH id="L7007"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7007">7007</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; item<SPAN class="o">-&gt;</SPAN>RemoveEnchantment<SPAN class="p">(</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7008"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7008">7008</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; item<SPAN class="o">-&gt;</SPAN>AddEnchantment<SPAN class="p">(</SPAN>&nbsp;Enchantment<SPAN class="p">,</SPAN>&nbsp;Duration<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">1</SPAN>&nbsp;<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7009"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7009">7009</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7010"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7010">7010</A></TH><TD></TR><TR><TH id="L7011"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7011">7011</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectAddHonor<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7012"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7012">7012</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7013"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7013">7013</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>playerTarget <SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7014"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7014">7014</A></TH><TD></TR><TR><TH id="L7015"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7015">7015</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 val <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L7016"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7016">7016</A></TH><TD></TR><TR><TH id="L7017"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7017">7017</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>AttributesExB <SPAN class="o">&amp;</SPAN>&nbsp;FLAGS3_UNK4 <SPAN class="p">)</SPAN>val <SPAN class="o">/=</SPAN>&nbsp;<SPAN class="mi">10</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7018"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7018">7018</A></TH><TD></TR><TR><TH id="L7019"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7019">7019</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; val <SPAN class="o">+=</SPAN>&nbsp;<SPAN class="mi">1</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7020"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7020">7020</A></TH><TD></TR><TR><TH id="L7021"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7021">7021</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; HonorHandler<SPAN class="o">::</SPAN>AddHonorPointsToPlayer<SPAN class="p">(</SPAN>&nbsp;playerTarget<SPAN class="p">,</SPAN>&nbsp;val <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7022"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7022">7022</A></TH><TD></TR><TR><TH id="L7023"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7023">7023</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; WorldPacket data<SPAN class="p">(</SPAN>SMSG_PVP_CREDIT<SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">16</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7024"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7024">7024</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;val<SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7025"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7025">7025</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint64<SPAN class="p">(</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7026"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7026">7026</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; data <SPAN class="o">&lt;&lt;</SPAN>&nbsp;uint32<SPAN class="p">(</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7027"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7027">7027</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>GetSession<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendPacket<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>data<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7028"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7028">7028</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7029"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7029">7029</A></TH><TD></TR><TR><TH id="L7030"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7030">7030</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSpawn<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7031"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7031">7031</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7032"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7032">7032</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="c">// this effect is mostly for custom teleporting</SPAN></TD></TR><TR><TH id="L7033"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7033">7033</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">switch</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7034"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7034">7034</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7035"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7035">7035</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">case</SPAN>&nbsp;<SPAN class="mi">10418</SPAN><SPAN class="o">:</SPAN>&nbsp;<SPAN class="c">// Arugal spawn-in spell , teleports it to 3 locations randomly sneeking players (bastard ;P)</SPAN></TD></TR><TR><TH id="L7036"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7036">7036</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7037"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7037">7037</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>u_caster <SPAN class="o">||</SPAN>&nbsp;u_caster<SPAN class="o">-&gt;</SPAN>IsPlayer<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L7038"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7038">7038</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7039"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7039">7039</A></TH><TD></TR><TR><TH id="L7040"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7040">7040</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">static</SPAN>&nbsp;<SPAN class="kt">float</SPAN>&nbsp;coord<SPAN class="p">[</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">][</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">]</SPAN><SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">{{</SPAN><SPAN class="o">-</SPAN><SPAN class="mf">108.9034f</SPAN><SPAN class="p">,</SPAN><SPAN class="mf">2129.5678f</SPAN><SPAN class="p">,</SPAN><SPAN class="mf">144.9210f</SPAN><SPAN class="p">},{</SPAN><SPAN class="o">-</SPAN><SPAN class="mf">108.9034f</SPAN><SPAN class="p">,</SPAN><SPAN class="mf">2155.5678f</SPAN><SPAN class="p">,</SPAN><SPAN class="mf">155.678f</SPAN><SPAN class="p">},{</SPAN><SPAN class="o">-</SPAN><SPAN class="mf">77.9034f</SPAN><SPAN class="p">,</SPAN><SPAN class="mf">2155.5678f</SPAN><SPAN class="p">,</SPAN><SPAN class="mf">155.678f</SPAN><SPAN class="p">}};</SPAN></TD></TR><TR><TH id="L7041"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7041">7041</A></TH><TD></TR><TR><TH id="L7042"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7042">7042</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="kt">int</SPAN>&nbsp;i <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="kt">int</SPAN><SPAN class="p">)(</SPAN>rand<SPAN class="p">()</SPAN><SPAN class="o">%</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7043"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7043">7043</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; u_caster<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>SendMoveToPacket<SPAN class="p">(</SPAN>coord<SPAN class="p">[</SPAN>i<SPAN class="p">][</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">],</SPAN>coord<SPAN class="p">[</SPAN>i<SPAN class="p">][</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">],</SPAN>coord<SPAN class="p">[</SPAN>i<SPAN class="p">][</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">],</SPAN><SPAN class="mf">0.0f</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>u_caster<SPAN class="o">-&gt;</SPAN>GetAIInterface<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>getMoveFlags<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L7044"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7044">7044</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7045"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7045">7045</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7046"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7046">7046</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7047"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7047">7047</A></TH><TD></TR><TR><TH id="L7048"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7048">7048</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectApplyAura128<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7049"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7049">7049</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7050"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7050">7050</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectApplyAuraName<SPAN class="p">[</SPAN>i<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">!=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7051"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7051">7051</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SpellEffectApplyAura<SPAN class="p">(</SPAN>i<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7052"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7052">7052</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7053"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7053">7053</A></TH><TD></TR><TR><TH id="L7054"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7054">7054</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectRestoreManaPct<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7055"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7055">7055</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7056"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7056">7056</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>unitTarget <SPAN class="o">||</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>isAlive<SPAN class="p">())</SPAN></TD></TR><TR><TH id="L7057"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7057">7057</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7058"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7058">7058</A></TH><TD></TR><TR><TH id="L7059"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7059">7059</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 curMana <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_POWER1<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7060"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7060">7060</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 maxMana <SPAN class="o">=</SPAN>&nbsp;<SPAN class="p">(</SPAN>uint32<SPAN class="p">)</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetUInt32Value<SPAN class="p">(</SPAN>UNIT_FIELD_MAXPOWER1<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7061"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7061">7061</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 modMana <SPAN class="o">=</SPAN>&nbsp;damage <SPAN class="o">*</SPAN>&nbsp;maxMana <SPAN class="o">/</SPAN>&nbsp;<SPAN class="mi">100</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7062"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7062">7062</A></TH><TD></TR><TR><TH id="L7063"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7063">7063</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; unitTarget<SPAN class="o">-&gt;</SPAN>SetPower<SPAN class="p">(</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN>&nbsp;modMana <SPAN class="o">+</SPAN>&nbsp;curMana<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7064"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7064">7064</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SendHealManaSpellOnPlayer<SPAN class="p">(</SPAN>u_caster<SPAN class="p">,</SPAN>&nbsp;unitTarget<SPAN class="p">,</SPAN>&nbsp;modMana<SPAN class="p">,</SPAN>&nbsp;POWER_TYPE_MANA<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7065"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7065">7065</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7066"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7066">7066</A></TH><TD></TR><TR><TH id="L7067"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7067">7067</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectTriggerSpellWithValue<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7068"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7068">7068</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7069"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7069">7069</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7070"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7070">7070</A></TH><TD></TR><TR><TH id="L7071"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7071">7071</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SpellEntry<SPAN class="o">*</SPAN>&nbsp;TriggeredSpell <SPAN class="o">=</SPAN>&nbsp;dbcSpell<SPAN class="p">.</SPAN>LookupEntryForced<SPAN class="p">(</SPAN>GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectTriggerSpell<SPAN class="p">[</SPAN>i<SPAN class="p">]);</SPAN></TD></TR><TR><TH id="L7072"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7072">7072</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>TriggeredSpell <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7073"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7073">7073</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7074"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7074">7074</A></TH><TD></TR><TR><TH id="L7075"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7075">7075</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; Spell <SPAN class="o">*</SPAN>sp <SPAN class="o">=</SPAN>&nbsp;SpellPool<SPAN class="p">.</SPAN>PooledNew<SPAN class="p">();</SPAN></TD></TR><TR><TH id="L7076"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7076">7076</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>sp<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7077"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7077">7077</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7078"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7078">7078</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>Init<SPAN class="p">(</SPAN>m_caster<SPAN class="p">,</SPAN>&nbsp;TriggeredSpell<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">true</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="nb">NULL</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7079"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7079">7079</A></TH><TD></TR><TR><TH id="L7080"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7080">7080</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">for</SPAN><SPAN class="p">(</SPAN>uint32 x <SPAN class="o">=</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">;</SPAN>&nbsp;x<SPAN class="o">&lt;</SPAN><SPAN class="mi">3</SPAN><SPAN class="p">;</SPAN>&nbsp;x<SPAN class="o">++</SPAN><SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7081"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7081">7081</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7082"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7082">7082</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN><SPAN class="p">(</SPAN>&nbsp;i <SPAN class="o">==</SPAN>&nbsp;x <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7083"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7083">7083</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>forced_basepoints<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;damage<SPAN class="p">;</SPAN>&nbsp; &nbsp; &nbsp; <SPAN class="c">//prayer of mending should inherit heal bonus ?</SPAN></TD></TR><TR><TH id="L7084"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7084">7084</A></TH><TD><SPAN class="c"></SPAN>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">else</SPAN></TD></TR><TR><TH id="L7085"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7085">7085</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>forced_basepoints<SPAN class="p">[</SPAN>x<SPAN class="p">]</SPAN>&nbsp;<SPAN class="o">=</SPAN>&nbsp;TriggeredSpell<SPAN class="o">-&gt;</SPAN>EffectBasePoints<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L7086"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7086">7086</A></TH><TD></TR><TR><TH id="L7087"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7087">7087</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7088"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7088">7088</A></TH><TD></TR><TR><TH id="L7089"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7089">7089</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SpellCastTargets tgt<SPAN class="p">(</SPAN>unitTarget<SPAN class="o">-&gt;</SPAN>GetGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L7090"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7090">7090</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sp<SPAN class="o">-&gt;</SPAN>prepare<SPAN class="p">(</SPAN><SPAN class="o">&amp;</SPAN>tgt<SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7091"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7091">7091</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7092"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7092">7092</A></TH><TD></TR><TR><TH id="L7093"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7093">7093</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectSummonTarget<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN>&nbsp;<SPAN class="c">// ritual of summoning</SPAN></TD></TR><TR><TH id="L7094"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7094">7094</A></TH><TD><SPAN class="c"></SPAN><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7095"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7095">7095</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN>&nbsp;<SPAN class="o">!</SPAN>unitTarget <SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7096"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7096">7096</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7097"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7097">7097</A></TH><TD></TR><TR><TH id="L7098"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7098">7098</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; SpellEffectTriggerSpell<SPAN class="p">(</SPAN>&nbsp;i <SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7099"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7099">7099</A></TH><TD><SPAN class="p">}</SPAN></TD></TR><TR><TH id="L7100"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7100">7100</A></TH><TD></TR><TR><TH id="L7101"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7101">7101</A></TH><TD><SPAN class="kt">void</SPAN>&nbsp;Spell<SPAN class="o">::</SPAN>SpellEffectForgetSpecialization<SPAN class="p">(</SPAN>uint32 i<SPAN class="p">)</SPAN></TD></TR><TR><TH id="L7102"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7102">7102</A></TH><TD><SPAN class="p">{</SPAN></TD></TR><TR><TH id="L7103"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7103">7103</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; <SPAN class="k">if</SPAN>&nbsp;<SPAN class="p">(</SPAN><SPAN class="o">!</SPAN>playerTarget<SPAN class="p">)</SPAN>&nbsp;<SPAN class="k">return</SPAN><SPAN class="p">;</SPAN></TD></TR><TR><TH id="L7104"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7104">7104</A></TH><TD></TR><TR><TH id="L7105"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7105">7105</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; uint32 spellid <SPAN class="o">=</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>EffectTriggerSpell<SPAN class="p">[</SPAN>i<SPAN class="p">];</SPAN></TD></TR><TR><TH id="L7106"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7106">7106</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; playerTarget<SPAN class="o">-&gt;</SPAN>removeSpell<SPAN class="p">(</SPAN>&nbsp;spellid<SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="kc">false</SPAN><SPAN class="p">,</SPAN>&nbsp;<SPAN class="mi">0</SPAN><SPAN class="p">);</SPAN></TD></TR><TR><TH id="L7107"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7107">7107</A></TH><TD></TR><TR><TH id="L7108"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7108">7108</A></TH><TD>&nbsp; &nbsp; &nbsp; &nbsp; sLog<SPAN class="p">.</SPAN>outDebug<SPAN class="p">(</SPAN><SPAN class="s">"Player %u have forgot spell %u from spell %u ( caster: %u)"</SPAN><SPAN class="p">,</SPAN>&nbsp;playerTarget<SPAN class="o">-&gt;</SPAN>GetLowGUID<SPAN class="p">(),</SPAN>&nbsp;spellid<SPAN class="p">,</SPAN>&nbsp;GetProto<SPAN class="p">()</SPAN><SPAN class="o">-&gt;</SPAN>Id<SPAN class="p">,</SPAN>&nbsp;m_caster<SPAN class="o">-&gt;</SPAN>GetLowGUID<SPAN class="p">());</SPAN></TD></TR><TR><TH id="L7109"><A href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp#L7109">7109</A></TH><TD><SPAN class="p">}</SPAN></TD></TR></TBODY></TABLE>
      </DIV>
      <DIV id="help">
        <STRONG>Note:</STRONG> See <A href="http://www.arcemu.info/trac/wiki/TracBrowser">TracBrowser</A>
        for help on using the browser.
      </DIV>
      <DIV id="anydiff">
        <FORM action="http://www.arcemu.info/trac/diff" method="get">
          <DIV class="buttons">
            <INPUT type="hidden" name="new_path" value="/trunk/src/arcemu-world/SpellEffects.cpp">
            <INPUT type="hidden" name="old_path" value="/trunk/src/arcemu-world/SpellEffects.cpp">
            <INPUT type="hidden" name="new_rev" value="2558">
            <INPUT type="hidden" name="old_rev" value="2558">
            <INPUT type="submit" value="View changes..." title="Select paths and revs for Diff">
          </DIV>
        </FORM>
      </DIV>
    </DIV>
    <DIV id="altlinks">
      <H3>Download in other formats:</H3>
      <UL>
        <LI class="first">
          <A rel="nofollow" href="http://www.arcemu.info/trac/browser/trunk/src/arcemu-world/SpellEffects.cpp?format=txt">Plain Text</A>
        </LI><LI class="last">
          <A rel="nofollow" href="http://www.arcemu.info/trac/export/2565/trunk/src/arcemu-world/SpellEffects.cpp">Original Format</A>
        </LI>
      </UL>
    </DIV>
    </DIV>
    <DIV id="footer" lang="en" xml:lang="en"><HR>
      <A id="tracpowered" href="http://trac.edgewall.org/"><IMG src="http://www.arcemu.info/trac/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered"></A>
      <P class="left">
        Powered by <A href="http://www.arcemu.info/trac/about"><STRONG>Trac 0.11</STRONG></A><BR>
        By <A href="http://www.edgewall.org/">Edgewall Software</A>.
      </P>
      <P class="right">Visit the Trac open source project at<BR><A href="http://trac.edgewall.org/">http://trac.edgewall.org/</A></P>
    </DIV>
  
</BODY></HTML>